{"version":3,"sources":["../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/@babel/runtime/helpers/createClass.js","../src/types/types.ts","../src/constants.ts","../src/utils/console.ts","../src/config/config.ts","../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableRest.js","../node_modules/@babel/runtime/helpers/slicedToArray.js","../src/rrweb/snapshot/types.ts","../src/rrweb/snapshot/utils.ts","../src/rrweb/snapshot/snapshot.ts","../node_modules/@babel/runtime/helpers/typeof.js","../src/rrweb/snapshot/css.ts","../src/rrweb/snapshot/rebuild.ts","../src/rrweb/snapshot/index.ts","../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/iterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableSpread.js","../node_modules/@babel/runtime/helpers/toConsumableArray.js","../src/rrweb/types.ts","../src/rrweb/utils.ts","../src/rrweb/record/mutation.ts","../src/rrweb/record/stringify.ts","../src/rrweb/record/error-stack-parser.ts","../src/rrweb/record/observer.ts","../src/rrweb/record/iframe-manager.ts","../src/rrweb/record/shadow-dom-manager.ts","../src/rrweb/record/index.ts","../src/rrweb/fflate/node-worker.ts","../src/rrweb/fflate/index.ts","../src/rrweb/packer/base.ts","../src/rrweb/packer/pack.ts","../src/rrweb/packer/unpack.ts","../src/rrweb/packer/index.ts","../src/error-trace/index.ts","../src/utils/ReportData.ts","../node_modules/@babel/runtime/helpers/asyncToGenerator.js","../node_modules/regenerator-runtime/runtime.js","../node_modules/@babel/runtime/regenerator/index.js","../src/utils/helper.ts","../src/performance/record-storage.ts","../package.json","../src/performance/record-client-navigator.ts","../src/performance/record-timing.ts","../src/utils/navigator-information.ts","../src/utils/vitals-score.ts","../src/utils/report-performance.ts","../src/utils/log.ts","../src/utils/metrics.ts","../src/performance/paint.ts","../src/performance/longtask.ts","../src/performance/first-input.ts","../src/performance/resource.ts","../src/performance/layout-shift.ts","../src/performance/performance-observer.ts","../src/index.ts","index.ts","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["module","exports","OVERLAY_ID","OldModule","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","length","concat","Function","deps","cached","cache","some","cb"],"mappings":"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AAM,EAAE,MAAhB;AAAwB,gBAAA,SAAS,EAAE;AAAnC,eAAN,CAAL;AACD,aAFD,MAEO;AACL,kBAAI,GAAG,GAA0B,IAAI,cAAJ,EAAjC;AACA,cAAA,GAAG,CAAC,IAAJ,CAAS,MAAT,EAAiB,GAAjB,EAAsB,IAAtB;AACA,cAAA,GAAG,CAAC,gBAAJ,CAAqB,cAArB,EAAqC,kBAArC;AACA,cAAA,GAAG,CAAC,IAAJ,CAAS,IAAT;;AACA,cAAA,GAAG,CAAC,MAAJ,GAAa;AAAA,uBAAM,GAAG,GAAG,IAAZ;AAAA,eAAb,CALK,CAKyB;;AAC/B;;AACD;AACD;;AACD;AACE,cAAI,CAAC,CAAC,cAAG,UAAT,EAAqB;AACnB,YAAA,SAAS,CAAC,UAAV,CAAqB,GAArB,EAA0B,IAA1B;AACD,WAFD,MAEO;AACL,gBAAI,KAAK,GAA4B,IAAI,KAAJ,EAArC;AACA,YAAA,KAAK,CAAC,GAAN,aAAe,GAAf,mBAA2B,IAA3B;;AACA,YAAA,KAAK,CAAC,MAAN,GAAe;AAAA,qBAAM,KAAK,GAAG,IAAd;AAAA,aAAf,CAHK,CAG6B;;AACnC;;AApBL;AAsBD;;;;;;;AC/CH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5uBA;AACA;;;;;;;;;ACDA;;AAEA;;;;AAIO,IAAM,sBAAsB,GAAG,SAAzB,sBAAyB,GAAc;AAClD,SAAO,iBAAM,CAAC,CAAC,cAAG,gBAAX,IAA+B,CAAC,CAAC,cAAG,GAApC,IAA2C,CAAC,CAAC,cAAG,IAAvD;AACD,CAFM;AAIP;;;;;;;;AAIO,IAAM,QAAQ,GAAG,SAAX,QAA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","file":"examples.77de5100.js","sourceRoot":"../examples","sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import { recordOptions } from \"../rrweb/types\";\n\nexport interface PerformanceMonitoringOptions {\n  isObserverResourceTiming?: boolean,\n  isObserverElementTiming?: boolean,\n  maxTime?: number,\n  captureError?: boolean,\n  reportData?: ReportDataAchieve | null,\n  fetchDomain?: string,\n  errLogRoute?: string,\n  errEventRoute?: string,\n  logRoute?: string,\n  analyticsTracker?: (options: AnalyticsTrackerOptions) => void,\n  recordOptions?: recordOptions<any>\n}\n\nexport interface StorageOpt {\n  quota?: number | undefined,\n  usage?: number | undefined,\n  usageDetails: { [key: string]: any }\n}\n\nexport interface TimingOpt {\n  // The time to initiate the network is from AppCache to ResponseEnd\n  // 发起网络的时间是从AppCache到ResponseEnd\n  fetchTime: number,\n  // Response time\n  // 响应时间\n  workerTime: number,\n  // Network request time\n  // 网络请求时间\n  networkTime: number,\n  // Server response time\n  // 服务器响应时间\n  downloadTime: number,\n  // The time when the browser received the first byte of the server\n  // 浏览器接收服务端的第一个字节的时间\n  timeToFirstByte: number,\n  // Request header size\n  // 请求头大小\n  headerSize: number,\n  // dns resolution time\n  // dns解析时间\n  dnsLookupTime: number,\n  // tcp connection time\n  // tcp连接时间\n  tcpTime: number,\n  // Blank screen time\n  // 白屏时间\n  firstPaintTime: number,\n  // dom rendering time\n  // dom渲染时间\n  domRenderTime: number,\n  // onload time\n  // onload时间\n  onloadTime: number,\n  // dom parsing time\n  // dom解析时间\n  domParseTime: number,\n}\n\nexport interface NavigatorOpt {\n  // 浏览器信息\n  // Browser information\n  userAgent: string,\n  // User's internet speed\n  // 用户的网速\n  connection: {\n    downlink?: number,\n    effectiveType?: EffectiveType,\n    rtt?: number,\n    saveData?: boolean,\n    [key: string]: unknown,\n    bandwidth?: string\n  }\n}\n\nexport interface ReportDataAchieve {\n  fetch: (label: AskLevel, body: string, uri: string) => void\n}\n\nexport interface PerformanceObservers {\n  [eventType: string]: PerformanceObserver | null;\n}\n\nexport enum AskLevel {\n  URGENT = 1,\n  IDLE = 2,\n}\n\nexport type PerformanceObserverEventType =\n  | \"paint\"\n  | \"longtask\"\n  | \"first-input\"\n  | \"largest-contentful-paint\"\n  | \"resource\"\n  | \"layout-shift\"\n  | \"element\"\n\nexport type VitalsScore = 'good' | 'needsImprovement' | 'poor' | null;\n\nexport interface AnalyticsTrackerOptions {\n  metricName: string;\n  data: TimingOpt | number | NavigatorOpt;\n  eventProperties: object | undefined;\n  navigatorInformation: unknown;\n  vitalsScore: VitalsScore;\n}\n\nexport interface NavigatorInformation {\n  deviceMemory?: number;\n  hardwareConcurrency?: number;\n  isLowEndDevice?: boolean;\n  isLowEndExperience?: boolean;\n  serviceWorkerStatus?: 'controlled' | 'supported' | 'unsupported';\n}\n\nexport type EffectiveType =\n  | '2g'\n  | '3g'\n  | '4g'\n  | '5g'\n  | 'slow-2g'\n  | 'lte';\n\nexport interface PerformanceEntryEncapsulation extends PerformanceEntry {\n  identifier: any;\n  value?: number | undefined;\n  hadRecentInput?: PerformanceEntryEncapsulation | undefined;\n  initiatorType?: string;\n  decodedBodySize?: number;\n  processingStart: DOMHighResTimeStamp;\n  target?: Node;\n  renderTime?: number\n}\n\nexport interface ResourceTime {\n  beacon: number;\n  css: number;\n  fetch: number;\n  img: number;\n  other: number;\n  script: number;\n  total: number;\n  xmlhttprequest: number;\n  [key: string]: number\n}","interface Navigator {\n  sendBeacon: any\n  connection?: any\n  storage: any\n  userAgent: string\n  deviceMemory: number;\n  hardwareConcurrency: number;\n  serviceWorker?: {\n    controller?: string;\n  };\n}\n\nexport const W = window\nexport const WP = W.performance\nexport const WN = W.navigator as any as Navigator\nexport const C = W.console\nexport const D = document","import { C } from \"../constants\"\n\nconst prefix = \"mini-pm🐢：\"\n\nexport const log = (message: any, ...options: any[]): void => C.log(prefix, message, ...options)\n\nexport const warn = (message: any, ...options: any[]) => C.warn(prefix, message, ...options)\n\nexport const error = (message: any, ...options: any[]) => C.error(prefix, message, ...options)","import type { AnalyticsTrackerOptions, PerformanceMonitoringOptions } from \"../types/types\";\nimport { log } from \"../utils/console\";\n\nexport const config: PerformanceMonitoringOptions = {\n  isObserverResourceTiming: false,\n  isObserverElementTiming: false,\n  maxTime: 15000,\n  captureError: true,\n  reportData: null,\n  analyticsTracker: (options: AnalyticsTrackerOptions) => {\n    log(options)\n  },\n  recordOptions: {}\n}","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","export enum NodeType {\n  Document,\n  DocumentType,\n  Element,\n  Text,\n  CDATA,\n  Comment,\n}\n\nexport type documentNode = {\n  type: NodeType.Document;\n  childNodes: serializedNodeWithId[];\n};\n\nexport type documentTypeNode = {\n  type: NodeType.DocumentType;\n  name: string;\n  publicId: string;\n  systemId: string;\n};\n\nexport type attributes = {\n  [key: string]: string | number | boolean;\n};\nexport type elementNode = {\n  type: NodeType.Element;\n  tagName: string;\n  attributes: attributes;\n  childNodes: serializedNodeWithId[];\n  isSVG?: true;\n  needBlock?: boolean;\n};\n\nexport type textNode = {\n  type: NodeType.Text;\n  textContent: string;\n  isStyle?: true;\n};\n\nexport type cdataNode = {\n  type: NodeType.CDATA;\n  textContent: '';\n};\n\nexport type commentNode = {\n  type: NodeType.Comment;\n  textContent: string;\n};\n\nexport type serializedNode = (\n  | documentNode\n  | documentTypeNode\n  | elementNode\n  | textNode\n  | cdataNode\n  | commentNode\n) & {\n  rootId?: number;\n  isShadowHost?: boolean;\n  isShadow?: boolean;\n};\n\nexport type serializedNodeWithId = serializedNode & { id: number };\n\nexport type tagMap = {\n  [key: string]: string;\n};\n\nexport interface INode extends Node {\n  __sn: serializedNodeWithId;\n}\n\nexport type idNodeMap = {\n  [key: number]: INode;\n};\n\nexport type MaskInputOptions = Partial<{\n  color: boolean;\n  date: boolean;\n  'datetime-local': boolean;\n  email: boolean;\n  month: boolean;\n  number: boolean;\n  range: boolean;\n  search: boolean;\n  tel: boolean;\n  text: boolean;\n  time: boolean;\n  url: boolean;\n  week: boolean;\n  // unify textarea and select element with text input\n  textarea: boolean;\n  select: boolean;\n  password: boolean;\n}>;\n\nexport type SlimDOMOptions = Partial<{\n  script: boolean;\n  comment: boolean;\n  headFavicon: boolean;\n  headWhitespace: boolean;\n  headMetaDescKeywords: boolean;\n  headMetaSocial: boolean;\n  headMetaRobots: boolean;\n  headMetaHttpEquiv: boolean;\n  headMetaAuthorship: boolean;\n  headMetaVerification: boolean;\n}>;\n\nexport type MaskTextFn = (text: string) => string;\n","import { INode } from './types';\n\nexport function isElement(n: Node | INode): n is Element {\n  return n.nodeType === n.ELEMENT_NODE;\n}\n\nexport function isShadowRoot(n: Node): n is ShadowRoot {\n  const host: Element | null = (n as ShadowRoot)?.host;\n  return Boolean(host && host.shadowRoot && host.shadowRoot === n);\n}\n","import {\n  serializedNode,\n  serializedNodeWithId,\n  NodeType,\n  attributes,\n  INode,\n  idNodeMap,\n  MaskInputOptions,\n  SlimDOMOptions,\n  MaskTextFn,\n} from './types';\nimport { isElement, isShadowRoot } from './utils';\n\nlet _id = 1;\nconst tagNameRegex = RegExp('[^a-z0-9-_]');\n\nexport const IGNORED_NODE = -2;\n\nfunction genId(): number {\n  return _id++;\n}\n\nfunction getValidTagName(element: HTMLElement): string {\n  if (element instanceof HTMLFormElement) {\n    return 'form';\n  }\n\n  const processedTagName = element.tagName.toLowerCase().trim();\n\n  if (tagNameRegex.test(processedTagName)) {\n    // if the tag name is odd and we cannot extract\n    // anything from the string, then we return a\n    // generic div\n    return 'div';\n  }\n\n  return processedTagName;\n}\n\nfunction getCssRulesString(s: CSSStyleSheet): string | null {\n  try {\n    const rules = s.rules || s.cssRules;\n    return rules ? Array.from(rules).map(getCssRuleString).join('') : null;\n  } catch (error) {\n    return null;\n  }\n}\n\nfunction getCssRuleString(rule: CSSRule): string {\n  return isCSSImportRule(rule)\n    ? getCssRulesString(rule.styleSheet) || ''\n    : rule.cssText;\n}\n\nfunction isCSSImportRule(rule: CSSRule): rule is CSSImportRule {\n  return 'styleSheet' in rule;\n}\n\nfunction extractOrigin(url: string): string {\n  let origin;\n  if (url.indexOf('//') > -1) {\n    origin = url.split('/').slice(0, 3).join('/');\n  } else {\n    origin = url.split('/')[0];\n  }\n  origin = origin.split('?')[0];\n  return origin;\n}\n\nconst URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")([^\"]*)\"|([^)]*))\\)/gm;\nconst RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/|#).*/;\nconst DATA_URI = /^(data:)([^,]*),(.*)/i;\nexport function absoluteToStylesheet(\n  cssText: string | null,\n  href: string,\n): string {\n  return (cssText || '').replace(\n    URL_IN_CSS_REF,\n    (origin, quote1, path1, quote2, path2, path3) => {\n      const filePath = path1 || path2 || path3;\n      const maybeQuote = quote1 || quote2 || '';\n      if (!filePath) {\n        return origin;\n      }\n      if (!RELATIVE_PATH.test(filePath)) {\n        return `url(${maybeQuote}${filePath}${maybeQuote})`;\n      }\n      if (DATA_URI.test(filePath)) {\n        return `url(${maybeQuote}${filePath}${maybeQuote})`;\n      }\n      if (filePath[0] === '/') {\n        return `url(${maybeQuote}${\n          extractOrigin(href) + filePath\n        }${maybeQuote})`;\n      }\n      const stack = href.split('/');\n      const parts = filePath.split('/');\n      stack.pop();\n      for (const part of parts) {\n        if (part === '.') {\n          continue;\n        } else if (part === '..') {\n          stack.pop();\n        } else {\n          stack.push(part);\n        }\n      }\n      return `url(${maybeQuote}${stack.join('/')}${maybeQuote})`;\n    },\n  );\n}\n\nconst SRCSET_NOT_SPACES = /^[^ \\t\\n\\r\\u000c]+/; // Don't use \\s, to avoid matching non-breaking space\nconst SRCSET_COMMAS_OR_SPACES = /^[, \\t\\n\\r\\u000c]+/;\nfunction getAbsoluteSrcsetString(doc: Document, attributeValue: string) {\n  /*\n    run absoluteToDoc over every url in the srcset\n\n    this is adapted from https://github.com/albell/parse-srcset/\n    without the parsing of the descriptors (we return these as-is)\n    parce-srcset is in turn based on\n    https://html.spec.whatwg.org/multipage/embedded-content.html#parse-a-srcset-attribute\n  */\n  if (attributeValue.trim() === '') {\n    return attributeValue;\n  }\n\n  let pos = 0;\n\n  function collectCharacters(regEx: RegExp) {\n    var chars,\n      match = regEx.exec(attributeValue.substring(pos));\n    if (match) {\n      chars = match[0];\n      pos += chars.length;\n      return chars;\n    }\n    return '';\n  }\n\n  let output = [];\n  while (true) {\n    collectCharacters(SRCSET_COMMAS_OR_SPACES);\n    if (pos >= attributeValue.length) {\n      break;\n    }\n    // don't split on commas within urls\n    let url = collectCharacters(SRCSET_NOT_SPACES);\n    if (url.slice(-1) === ',') {\n      // aside: according to spec more than one comma at the end is a parse error, but we ignore that\n      url = absoluteToDoc(doc, url.substring(0, url.length - 1));\n      // the trailing comma splits the srcset, so the interpretion is that\n      // another url will follow, and the descriptor is empty\n      output.push(url);\n    } else {\n      let descriptorsStr = '';\n      url = absoluteToDoc(doc, url);\n      let inParens = false;\n      while (true) {\n        let c = attributeValue.charAt(pos);\n        if (c === '') {\n          output.push((url + descriptorsStr).trim());\n          break;\n        } else if (!inParens) {\n          if (c === ',') {\n            pos += 1;\n            output.push((url + descriptorsStr).trim());\n            break; // parse the next url\n          } else if (c === '(') {\n            inParens = true;\n          }\n        } else {\n          // in parenthesis; ignore commas\n          // (parenthesis may be supported by future additions to spec)\n          if (c === ')') {\n            inParens = false;\n          }\n        }\n        descriptorsStr += c;\n        pos += 1;\n      }\n    }\n  }\n  return output.join(', ');\n}\n\nexport function absoluteToDoc(doc: Document, attributeValue: string): string {\n  if (!attributeValue || attributeValue.trim() === '') {\n    return attributeValue;\n  }\n  const a: HTMLAnchorElement = doc.createElement('a');\n  a.href = attributeValue;\n  return a.href;\n}\n\nfunction isSVGElement(el: Element): boolean {\n  return el.tagName === 'svg' || el instanceof SVGElement;\n}\n\nfunction getHref() {\n  // return a href without hash\n  const a = document.createElement('a');\n  a.href = '';\n  return a.href;\n}\n\nexport function transformAttribute(\n  doc: Document,\n  tagName: string,\n  name: string,\n  value: string,\n): string {\n  // relative path in attribute\n  if (name === 'src' || ((name === 'href' || name === 'xlink:href') && value)) {\n    return absoluteToDoc(doc, value);\n  } else if (\n    name === 'background' &&\n    value &&\n    (tagName === 'table' || tagName === 'td' || tagName === 'th')\n  ) {\n    return absoluteToDoc(doc, value);\n  } else if (name === 'srcset' && value) {\n    return getAbsoluteSrcsetString(doc, value);\n  } else if (name === 'style' && value) {\n    return absoluteToStylesheet(value, getHref());\n  } else {\n    return value;\n  }\n}\n\nexport function _isBlockedElement(\n  element: HTMLElement,\n  blockClass: string | RegExp,\n  blockSelector: string | null,\n): boolean {\n  if (typeof blockClass === 'string') {\n    if (element.classList.contains(blockClass)) {\n      return true;\n    }\n  } else {\n    // tslint:disable-next-line: prefer-for-of\n    for (let eIndex = 0; eIndex < element.classList.length; eIndex++) {\n      const className = element.classList[eIndex];\n      if (blockClass.test(className)) {\n        return true;\n      }\n    }\n  }\n  if (blockSelector) {\n    return element.matches(blockSelector);\n  }\n\n  return false;\n}\n\nexport function needMaskingText(\n  node: Node | null,\n  maskTextClass: string | RegExp,\n  maskTextSelector: string | null,\n): boolean {\n  if (!node) {\n    return false;\n  }\n  if (node.nodeType === node.ELEMENT_NODE) {\n    if (typeof maskTextClass === 'string') {\n      if ((node as HTMLElement).classList.contains(maskTextClass)) {\n        return true;\n      }\n    } else {\n      (node as HTMLElement).classList.forEach((className) => {\n        if (maskTextClass.test(className)) {\n          return true;\n        }\n      });\n    }\n    if (maskTextSelector) {\n      if ((node as HTMLElement).matches(maskTextSelector)) {\n        return true;\n      }\n    }\n    return needMaskingText(node.parentNode, maskTextClass, maskTextSelector);\n  }\n  if (node.nodeType === node.TEXT_NODE) {\n    // check parent node since text node do not have class name\n    return needMaskingText(node.parentNode, maskTextClass, maskTextSelector);\n  }\n  return needMaskingText(node.parentNode, maskTextClass, maskTextSelector);\n}\n\n// https://stackoverflow.com/a/36155560\nfunction onceIframeLoaded(\n  iframeEl: HTMLIFrameElement,\n  listener: () => unknown,\n  iframeLoadTimeout: number,\n) {\n  const win = iframeEl.contentWindow;\n  if (!win) {\n    return;\n  }\n  // document is loading\n  let fired = false;\n\n  let readyState: DocumentReadyState;\n  try {\n    readyState = win.document.readyState;\n  } catch (error) {\n    return;\n  }\n  if (readyState !== 'complete') {\n    const timer = setTimeout(() => {\n      if (!fired) {\n        listener();\n        fired = true;\n      }\n    }, iframeLoadTimeout);\n    iframeEl.addEventListener('load', () => {\n      clearTimeout(timer);\n      fired = true;\n      listener();\n    });\n    return;\n  }\n  // check blank frame for Chrome\n  const blankUrl = 'about:blank';\n  if (\n    win.location.href !== blankUrl ||\n    iframeEl.src === blankUrl ||\n    iframeEl.src === ''\n  ) {\n    listener();\n    return;\n  }\n  // use default listener\n  iframeEl.addEventListener('load', listener);\n}\n\nfunction serializeNode(\n  n: Node,\n  options: {\n    doc: Document;\n    blockClass: string | RegExp;\n    blockSelector: string | null;\n    maskTextClass: string | RegExp;\n    maskTextSelector: string | null;\n    inlineStylesheet: boolean;\n    maskInputOptions: MaskInputOptions;\n    maskTextFn: MaskTextFn | undefined;\n    recordCanvas: boolean;\n  },\n): serializedNode | false {\n  const {\n    doc,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    inlineStylesheet,\n    maskInputOptions = {},\n    maskTextFn,\n    recordCanvas,\n  } = options;\n  // Only record root id when document object is not the base document\n  let rootId: number | undefined;\n  if (((doc as unknown) as INode).__sn) {\n    const docId = ((doc as unknown) as INode).__sn.id;\n    rootId = docId === 1 ? undefined : docId;\n  }\n  switch (n.nodeType) {\n    case n.DOCUMENT_NODE:\n      return {\n        type: NodeType.Document,\n        childNodes: [],\n        rootId,\n      };\n    case n.DOCUMENT_TYPE_NODE:\n      return {\n        type: NodeType.DocumentType,\n        name: (n as DocumentType).name,\n        publicId: (n as DocumentType).publicId,\n        systemId: (n as DocumentType).systemId,\n        rootId,\n      };\n    case n.ELEMENT_NODE:\n      const needBlock = _isBlockedElement(\n        n as HTMLElement,\n        blockClass,\n        blockSelector,\n      );\n      const tagName = getValidTagName(n as HTMLElement);\n      let attributes: attributes = {};\n      for (const { name, value } of Array.from((n as HTMLElement).attributes)) {\n        attributes[name] = transformAttribute(doc, tagName, name, value);\n      }\n      // remote css\n      if (tagName === 'link' && inlineStylesheet) {\n        const stylesheet = Array.from(doc.styleSheets).find((s) => {\n          return s.href === (n as HTMLLinkElement).href;\n        });\n        const cssText = getCssRulesString(stylesheet as CSSStyleSheet);\n        if (cssText) {\n          delete attributes.rel;\n          delete attributes.href;\n          attributes._cssText = absoluteToStylesheet(\n            cssText,\n            stylesheet!.href!,\n          );\n        }\n      }\n      // dynamic stylesheet\n      if (\n        tagName === 'style' &&\n        (n as HTMLStyleElement).sheet &&\n        // TODO: Currently we only try to get dynamic stylesheet when it is an empty style element\n        !(\n          (n as HTMLElement).innerText ||\n          (n as HTMLElement).textContent ||\n          ''\n        ).trim().length\n      ) {\n        const cssText = getCssRulesString(\n          (n as HTMLStyleElement).sheet as CSSStyleSheet,\n        );\n        if (cssText) {\n          attributes._cssText = absoluteToStylesheet(cssText, getHref());\n        }\n      }\n      // form fields\n      if (\n        tagName === 'input' ||\n        tagName === 'textarea' ||\n        tagName === 'select'\n      ) {\n        const value = (n as HTMLInputElement | HTMLTextAreaElement).value;\n        if (\n          attributes.type !== 'radio' &&\n          attributes.type !== 'checkbox' &&\n          attributes.type !== 'submit' &&\n          attributes.type !== 'button' &&\n          value\n        ) {\n          attributes.value =\n            maskInputOptions[attributes.type as keyof MaskInputOptions] ||\n            maskInputOptions[tagName as keyof MaskInputOptions]\n              ? '*'.repeat(value.length)\n              : value;\n        } else if ((n as HTMLInputElement).checked) {\n          attributes.checked = (n as HTMLInputElement).checked;\n        }\n      }\n      if (tagName === 'option') {\n        const selectValue = (n as HTMLOptionElement).parentElement;\n        if (attributes.value === (selectValue as HTMLSelectElement).value) {\n          attributes.selected = (n as HTMLOptionElement).selected;\n        }\n      }\n      // canvas image data\n      if (tagName === 'canvas' && recordCanvas) {\n        attributes.rr_dataURL = (n as HTMLCanvasElement).toDataURL();\n      }\n      // media elements\n      if (tagName === 'audio' || tagName === 'video') {\n        attributes.rr_mediaState = (n as HTMLMediaElement).paused\n          ? 'paused'\n          : 'played';\n      }\n      // scroll\n      if ((n as HTMLElement).scrollLeft) {\n        attributes.rr_scrollLeft = (n as HTMLElement).scrollLeft;\n      }\n      if ((n as HTMLElement).scrollTop) {\n        attributes.rr_scrollTop = (n as HTMLElement).scrollTop;\n      }\n      // block element\n      if (needBlock) {\n        const { width, height } = (n as HTMLElement).getBoundingClientRect();\n        attributes = {\n          class: attributes.class,\n          rr_width: `${width}px`,\n          rr_height: `${height}px`,\n        };\n      }\n      // iframe\n      if (tagName === 'iframe') {\n        delete attributes.src;\n      }\n      return {\n        type: NodeType.Element,\n        tagName,\n        attributes,\n        childNodes: [],\n        isSVG: isSVGElement(n as Element) || undefined,\n        needBlock,\n        rootId,\n      };\n    case n.TEXT_NODE:\n      // The parent node may not be a html element which has a tagName attribute.\n      // So just let it be undefined which is ok in this use case.\n      const parentTagName =\n        n.parentNode && (n.parentNode as HTMLElement).tagName;\n      let textContent = (n as Text).textContent;\n      const isStyle = parentTagName === 'STYLE' ? true : undefined;\n      const isScript = parentTagName === 'SCRIPT' ? true : undefined;\n      if (isStyle && textContent) {\n        textContent = absoluteToStylesheet(textContent, getHref());\n      }\n      if (isScript) {\n        textContent = 'SCRIPT_PLACEHOLDER';\n      }\n      if (\n        !isStyle &&\n        !isScript &&\n        needMaskingText(n, maskTextClass, maskTextSelector) &&\n        textContent\n      ) {\n        textContent = maskTextFn\n          ? maskTextFn(textContent)\n          : textContent.replace(/[\\S]/g, '*');\n      }\n      return {\n        type: NodeType.Text,\n        textContent: textContent || '',\n        isStyle,\n        rootId,\n      };\n    case n.CDATA_SECTION_NODE:\n      return {\n        type: NodeType.CDATA,\n        textContent: '',\n        rootId,\n      };\n    case n.COMMENT_NODE:\n      return {\n        type: NodeType.Comment,\n        textContent: (n as Comment).textContent || '',\n        rootId,\n      };\n    default:\n      return false;\n  }\n}\n\nfunction lowerIfExists(maybeAttr: string | number | boolean): string {\n  if (maybeAttr === undefined) {\n    return '';\n  } else {\n    return (maybeAttr as string).toLowerCase();\n  }\n}\n\nfunction slimDOMExcluded(\n  sn: serializedNode,\n  slimDOMOptions: SlimDOMOptions,\n): boolean {\n  if (slimDOMOptions.comment && sn.type === NodeType.Comment) {\n    // TODO: convert IE conditional comments to real nodes\n    return true;\n  } else if (sn.type === NodeType.Element) {\n    if (\n      slimDOMOptions.script &&\n      (sn.tagName === 'script' ||\n        (sn.tagName === 'link' &&\n          sn.attributes.rel === 'preload' &&\n          sn.attributes.as === 'script'))\n    ) {\n      return true;\n    } else if (\n      slimDOMOptions.headFavicon &&\n      ((sn.tagName === 'link' && sn.attributes.rel === 'shortcut icon') ||\n        (sn.tagName === 'meta' &&\n          (lowerIfExists(sn.attributes.name).match(\n            /^msapplication-tile(image|color)$/,\n          ) ||\n            lowerIfExists(sn.attributes.name) === 'application-name' ||\n            lowerIfExists(sn.attributes.rel) === 'icon' ||\n            lowerIfExists(sn.attributes.rel) === 'apple-touch-icon' ||\n            lowerIfExists(sn.attributes.rel) === 'shortcut icon')))\n    ) {\n      return true;\n    } else if (sn.tagName === 'meta') {\n      if (\n        slimDOMOptions.headMetaDescKeywords &&\n        lowerIfExists(sn.attributes.name).match(/^description|keywords$/)\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaSocial &&\n        (lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/) || // og = opengraph (facebook)\n          lowerIfExists(sn.attributes.name).match(/^(og|twitter):/) ||\n          lowerIfExists(sn.attributes.name) === 'pinterest')\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaRobots &&\n        (lowerIfExists(sn.attributes.name) === 'robots' ||\n          lowerIfExists(sn.attributes.name) === 'googlebot' ||\n          lowerIfExists(sn.attributes.name) === 'bingbot')\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaHttpEquiv &&\n        sn.attributes['http-equiv'] !== undefined\n      ) {\n        // e.g. X-UA-Compatible, Content-Type, Content-Language,\n        // cache-control, X-Translated-By\n        return true;\n      } else if (\n        slimDOMOptions.headMetaAuthorship &&\n        (lowerIfExists(sn.attributes.name) === 'author' ||\n          lowerIfExists(sn.attributes.name) === 'generator' ||\n          lowerIfExists(sn.attributes.name) === 'framework' ||\n          lowerIfExists(sn.attributes.name) === 'publisher' ||\n          lowerIfExists(sn.attributes.name) === 'progid' ||\n          lowerIfExists(sn.attributes.property).match(/^article:/) ||\n          lowerIfExists(sn.attributes.property).match(/^product:/))\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaVerification &&\n        (lowerIfExists(sn.attributes.name) === 'google-site-verification' ||\n          lowerIfExists(sn.attributes.name) === 'yandex-verification' ||\n          lowerIfExists(sn.attributes.name) === 'csrf-token' ||\n          lowerIfExists(sn.attributes.name) === 'p:domain_verify' ||\n          lowerIfExists(sn.attributes.name) === 'verify-v1' ||\n          lowerIfExists(sn.attributes.name) === 'verification' ||\n          lowerIfExists(sn.attributes.name) === 'shopify-checkout-api-token')\n      ) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nexport function serializeNodeWithId(\n  n: Node | INode,\n  options: {\n    doc: Document;\n    map: idNodeMap;\n    blockClass: string | RegExp;\n    blockSelector: string | null;\n    maskTextClass: string | RegExp;\n    maskTextSelector: string | null;\n    skipChild: boolean;\n    inlineStylesheet: boolean;\n    maskInputOptions?: MaskInputOptions;\n    maskTextFn: MaskTextFn | undefined;\n    slimDOMOptions: SlimDOMOptions;\n    recordCanvas?: boolean;\n    preserveWhiteSpace?: boolean;\n    onSerialize?: (n: INode) => unknown;\n    onIframeLoad?: (iframeINode: INode, node: serializedNodeWithId) => unknown;\n    iframeLoadTimeout?: number;\n  },\n): serializedNodeWithId | null {\n  const {\n    doc,\n    map,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    skipChild = false,\n    inlineStylesheet = true,\n    maskInputOptions = {},\n    maskTextFn,\n    slimDOMOptions,\n    recordCanvas = false,\n    onSerialize,\n    onIframeLoad,\n    iframeLoadTimeout = 5000,\n  } = options;\n  let { preserveWhiteSpace = true } = options;\n  const _serializedNode = serializeNode(n, {\n    doc,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    inlineStylesheet,\n    maskInputOptions,\n    maskTextFn,\n    recordCanvas,\n  });\n  if (!_serializedNode) {\n    // TODO: dev only\n    console.warn(n, 'not serialized');\n    return null;\n  }\n\n  let id;\n  // Try to reuse the previous id\n  if ('__sn' in n) {\n    id = n.__sn.id;\n  } else if (\n    slimDOMExcluded(_serializedNode, slimDOMOptions) ||\n    (!preserveWhiteSpace &&\n      _serializedNode.type === NodeType.Text &&\n      !_serializedNode.isStyle &&\n      !_serializedNode.textContent.replace(/^\\s+|\\s+$/gm, '').length)\n  ) {\n    id = IGNORED_NODE;\n  } else {\n    id = genId();\n  }\n  const serializedNode = Object.assign(_serializedNode, { id });\n  (n as INode).__sn = serializedNode;\n  if (id === IGNORED_NODE) {\n    return null; // slimDOM\n  }\n  map[id] = n as INode;\n  if (onSerialize) {\n    onSerialize(n as INode);\n  }\n  let recordChild = !skipChild;\n  if (serializedNode.type === NodeType.Element) {\n    recordChild = recordChild && !serializedNode.needBlock;\n    // this property was not needed in replay side\n    delete serializedNode.needBlock;\n  }\n  if (\n    (serializedNode.type === NodeType.Document ||\n      serializedNode.type === NodeType.Element) &&\n    recordChild\n  ) {\n    if (\n      slimDOMOptions.headWhitespace &&\n      _serializedNode.type === NodeType.Element &&\n      _serializedNode.tagName === 'head'\n      // would impede performance: || getComputedStyle(n)['white-space'] === 'normal'\n    ) {\n      preserveWhiteSpace = false;\n    }\n    const bypassOptions = {\n      doc,\n      map,\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      skipChild,\n      inlineStylesheet,\n      maskInputOptions,\n      maskTextFn,\n      slimDOMOptions,\n      recordCanvas,\n      preserveWhiteSpace,\n      onSerialize,\n      onIframeLoad,\n      iframeLoadTimeout,\n    };\n    for (const childN of Array.from(n.childNodes)) {\n      const serializedChildNode = serializeNodeWithId(childN, bypassOptions);\n      if (serializedChildNode) {\n        serializedNode.childNodes.push(serializedChildNode);\n      }\n    }\n\n    if (isElement(n) && n.shadowRoot) {\n      serializedNode.isShadowHost = true;\n      for (const childN of Array.from(n.shadowRoot.childNodes)) {\n        const serializedChildNode = serializeNodeWithId(childN, bypassOptions);\n        if (serializedChildNode) {\n          serializedChildNode.isShadow = true;\n          serializedNode.childNodes.push(serializedChildNode);\n        }\n      }\n    }\n  }\n\n  if (n.parentNode && isShadowRoot(n.parentNode)) {\n    serializedNode.isShadow = true;\n  }\n\n  if (\n    serializedNode.type === NodeType.Element &&\n    serializedNode.tagName === 'iframe'\n  ) {\n    onceIframeLoaded(\n      n as HTMLIFrameElement,\n      () => {\n        const iframeDoc = (n as HTMLIFrameElement).contentDocument;\n        if (iframeDoc && onIframeLoad) {\n          const serializedIframeNode = serializeNodeWithId(iframeDoc, {\n            doc: iframeDoc,\n            map,\n            blockClass,\n            blockSelector,\n            maskTextClass,\n            maskTextSelector,\n            skipChild: false,\n            inlineStylesheet,\n            maskInputOptions,\n            maskTextFn,\n            slimDOMOptions,\n            recordCanvas,\n            preserveWhiteSpace,\n            onSerialize,\n            onIframeLoad,\n            iframeLoadTimeout,\n          });\n\n          if (serializedIframeNode) {\n            onIframeLoad(n as INode, serializedIframeNode);\n          }\n        }\n      },\n      iframeLoadTimeout,\n    );\n  }\n\n  return serializedNode;\n}\n\nfunction snapshot(\n  n: Document,\n  options?: {\n    blockClass?: string | RegExp;\n    blockSelector?: string | null;\n    maskTextClass?: string | RegExp;\n    maskTextSelector?: string | null;\n    inlineStylesheet?: boolean;\n    maskAllInputs?: boolean | MaskInputOptions;\n    maskTextFn?: MaskTextFn;\n    slimDOM?: boolean | SlimDOMOptions;\n    recordCanvas?: boolean;\n    preserveWhiteSpace?: boolean;\n    onSerialize?: (n: INode) => unknown;\n    onIframeLoad?: (iframeINode: INode, node: serializedNodeWithId) => unknown;\n    iframeLoadTimeout?: number;\n  },\n): [serializedNodeWithId | null, idNodeMap] {\n  const {\n    blockClass = 'rr-block',\n    blockSelector = null,\n    maskTextClass = 'rr-mask',\n    maskTextSelector = null,\n    inlineStylesheet = true,\n    recordCanvas = false,\n    maskAllInputs = false,\n    maskTextFn,\n    slimDOM = false,\n    preserveWhiteSpace,\n    onSerialize,\n    onIframeLoad,\n    iframeLoadTimeout,\n  } = options || {};\n  const idNodeMap: idNodeMap = {};\n  const maskInputOptions: MaskInputOptions =\n    maskAllInputs === true\n      ? {\n          color: true,\n          date: true,\n          'datetime-local': true,\n          email: true,\n          month: true,\n          number: true,\n          range: true,\n          search: true,\n          tel: true,\n          text: true,\n          time: true,\n          url: true,\n          week: true,\n          textarea: true,\n          select: true,\n          password: true,\n        }\n      : maskAllInputs === false\n      ? {\n          password: true,\n        }\n      : maskAllInputs;\n  const slimDOMOptions: SlimDOMOptions =\n    slimDOM === true || slimDOM === 'all'\n      ? // if true: set of sensible options that should not throw away any information\n        {\n          script: true,\n          comment: true,\n          headFavicon: true,\n          headWhitespace: true,\n          headMetaDescKeywords: slimDOM === 'all', // destructive\n          headMetaSocial: true,\n          headMetaRobots: true,\n          headMetaHttpEquiv: true,\n          headMetaAuthorship: true,\n          headMetaVerification: true,\n        }\n      : slimDOM === false\n      ? {}\n      : slimDOM;\n  return [\n    serializeNodeWithId(n, {\n      doc: n,\n      map: idNodeMap,\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      skipChild: false,\n      inlineStylesheet,\n      maskInputOptions,\n      maskTextFn,\n      slimDOMOptions,\n      recordCanvas,\n      preserveWhiteSpace,\n      onSerialize,\n      onIframeLoad,\n      iframeLoadTimeout,\n    }),\n    idNodeMap,\n  ];\n}\n\nexport function visitSnapshot(\n  node: serializedNodeWithId,\n  onVisit: (node: serializedNodeWithId) => unknown,\n) {\n  function walk(current: serializedNodeWithId) {\n    onVisit(current);\n    if (\n      current.type === NodeType.Document ||\n      current.type === NodeType.Element\n    ) {\n      current.childNodes.forEach(walk);\n    }\n  }\n\n  walk(node);\n}\n\nexport function cleanupSnapshot() {\n  // allow a new recording to start numbering nodes from scratch\n  _id = 1;\n}\n\nexport default snapshot;\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * This file is a fork of https://github.com/reworkcss/css/blob/master/lib/parse/index.js\n * I fork it because:\n * 1. The css library was built for node.js which does not have tree-shaking supports.\n * 2. Rewrites into typescript give us a better type interface.\n */\n\n/* tslint:disable no-conditional-assignment interface-name no-shadowed-variable */\n\nexport interface ParserOptions {\n  /** Silently fail on parse errors */\n  silent?: boolean;\n  /**\n   * The path to the file containing css.\n   * Makes errors and source maps more helpful, by letting them know where code comes from.\n   */\n  source?: string;\n}\n\n/**\n * Error thrown during parsing.\n */\nexport interface ParserError {\n  /** The full error message with the source position. */\n  message?: string;\n  /** The error message without position. */\n  reason?: string;\n  /** The value of options.source if passed to css.parse. Otherwise undefined. */\n  filename?: string;\n  line?: number;\n  column?: number;\n  /** The portion of code that couldn't be parsed. */\n  source?: string;\n}\n\nexport interface Loc {\n  line?: number;\n  column?: number;\n}\n\n/**\n * Base AST Tree Node.\n */\nexport interface Node {\n  /** The possible values are the ones listed in the Types section on https://github.com/reworkcss/css page. */\n  type?: string;\n  /** A reference to the parent node, or null if the node has no parent. */\n  parent?: Node;\n  /** Information about the position in the source string that corresponds to the node. */\n  position?: {\n    start?: Loc;\n    end?: Loc;\n    /** The value of options.source if passed to css.parse. Otherwise undefined. */\n    source?: string;\n    /** The full source string passed to css.parse. */\n    content?: string;\n  };\n}\n\nexport interface Rule extends Node {\n  /** The list of selectors of the rule, split on commas. Each selector is trimmed from whitespace and comments. */\n  selectors?: string[];\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\nexport interface Declaration extends Node {\n  /** The property name, trimmed from whitespace and comments. May not be empty. */\n  property?: string;\n  /** The value of the property, trimmed from whitespace and comments. Empty values are allowed. */\n  value?: string;\n}\n\n/**\n * A rule-level or declaration-level comment. Comments inside selectors, properties and values etc. are lost.\n */\nexport interface Comment extends Node {\n  comment?: string;\n}\n\n/**\n * The @charset at-rule.\n */\nexport interface Charset extends Node {\n  /** The part following @charset. */\n  charset?: string;\n}\n\n/**\n * The @custom-media at-rule\n */\nexport interface CustomMedia extends Node {\n  /** The ---prefixed name. */\n  name?: string;\n  /** The part following the name. */\n  media?: string;\n}\n\n/**\n * The @document at-rule.\n */\nexport interface Document extends Node {\n  /** The part following @document. */\n  document?: string;\n  /** The vendor prefix in @document, or undefined if there is none. */\n  vendor?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/**\n * The @font-face at-rule.\n */\nexport interface FontFace extends Node {\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\n/**\n * The @host at-rule.\n */\nexport interface Host extends Node {\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/**\n * The @import at-rule.\n */\nexport interface Import extends Node {\n  /** The part following @import. */\n  import?: string;\n}\n\n/**\n * The @keyframes at-rule.\n */\nexport interface KeyFrames extends Node {\n  /** The name of the keyframes rule. */\n  name?: string;\n  /** The vendor prefix in @keyframes, or undefined if there is none. */\n  vendor?: string;\n  /** Array of nodes with the types keyframe and comment. */\n  keyframes?: Array<KeyFrame | Comment>;\n}\n\nexport interface KeyFrame extends Node {\n  /** The list of \"selectors\" of the keyframe rule, split on commas. Each “selector” is trimmed from whitespace. */\n  values?: string[];\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\n/**\n * The @media at-rule.\n */\nexport interface Media extends Node {\n  /** The part following @media. */\n  media?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/**\n * The @namespace at-rule.\n */\nexport interface Namespace extends Node {\n  /** The part following @namespace. */\n  namespace?: string;\n}\n\n/**\n * The @page at-rule.\n */\nexport interface Page extends Node {\n  /** The list of selectors of the rule, split on commas. Each selector is trimmed from whitespace and comments. */\n  selectors?: string[];\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\n/**\n * The @supports at-rule.\n */\nexport interface Supports extends Node {\n  /** The part following @supports. */\n  supports?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/** All at-rules. */\nexport type AtRule =\n  | Charset\n  | CustomMedia\n  | Document\n  | FontFace\n  | Host\n  | Import\n  | KeyFrames\n  | Media\n  | Namespace\n  | Page\n  | Supports;\n\n/**\n * A collection of rules\n */\nexport interface StyleRules {\n  source?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules: Array<Rule | Comment | AtRule>;\n  /** Array of Errors. Errors collected during parsing when option silent is true. */\n  parsingErrors?: ParserError[];\n}\n\n/**\n * The root node returned by css.parse.\n */\nexport interface Stylesheet extends Node {\n  stylesheet?: StyleRules;\n}\n\n// http://www.w3.org/TR/CSS21/grammar.html\n// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027\nconst commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\n\nexport function parse(css: string, options: ParserOptions = {}) {\n  /**\n   * Positional.\n   */\n\n  let lineno = 1;\n  let column = 1;\n\n  /**\n   * Update lineno and column based on `str`.\n   */\n\n  function updatePosition(str: string) {\n    const lines = str.match(/\\n/g);\n    if (lines) {\n      lineno += lines.length;\n    }\n    let i = str.lastIndexOf('\\n');\n    column = i === -1 ? column + str.length : str.length - i;\n  }\n\n  /**\n   * Mark position and patch `node.position`.\n   */\n\n  function position() {\n    const start = { line: lineno, column };\n    return (\n      node: Rule | Declaration | Comment | AtRule | Stylesheet | KeyFrame,\n    ) => {\n      node.position = new Position(start);\n      whitespace();\n      return node;\n    };\n  }\n\n  /**\n   * Store position information for a node\n   */\n\n  class Position {\n    public content!: string;\n    public start!: Loc;\n    public end!: Loc;\n    public source?: string;\n\n    constructor(start: Loc) {\n      this.start = start;\n      this.end = { line: lineno, column };\n      this.source = options.source;\n    }\n  }\n\n  /**\n   * Non-enumerable source string\n   */\n\n  Position.prototype.content = css;\n\n  const errorsList: ParserError[] = [];\n\n  function error(msg: string) {\n    const err = new Error(\n      options.source + ':' + lineno + ':' + column + ': ' + msg,\n    ) as ParserError;\n    err.reason = msg;\n    err.filename = options.source;\n    err.line = lineno;\n    err.column = column;\n    err.source = css;\n\n    if (options.silent) {\n      errorsList.push(err);\n    } else {\n      throw err;\n    }\n  }\n\n  /**\n   * Parse stylesheet.\n   */\n\n  function stylesheet(): Stylesheet {\n    const rulesList = rules();\n\n    return {\n      type: 'stylesheet',\n      stylesheet: {\n        source: options.source,\n        rules: rulesList,\n        parsingErrors: errorsList,\n      },\n    };\n  }\n\n  /**\n   * Opening brace.\n   */\n\n  function open() {\n    return match(/^{\\s*/);\n  }\n\n  /**\n   * Closing brace.\n   */\n\n  function close() {\n    return match(/^}/);\n  }\n\n  /**\n   * Parse ruleset.\n   */\n\n  function rules() {\n    let node: Rule | void;\n    const rules: Rule[] = [];\n    whitespace();\n    comments(rules);\n    while (css.length && css.charAt(0) !== '}' && (node = atrule() || rule())) {\n      if (node !== false) {\n        rules.push(node);\n        comments(rules);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Match `re` and return captures.\n   */\n\n  function match(re: RegExp) {\n    const m = re.exec(css);\n    if (!m) {\n      return;\n    }\n    const str = m[0];\n    updatePosition(str);\n    css = css.slice(str.length);\n    return m;\n  }\n\n  /**\n   * Parse whitespace.\n   */\n\n  function whitespace() {\n    match(/^\\s*/);\n  }\n\n  /**\n   * Parse comments;\n   */\n\n  function comments(rules: Rule[] = []) {\n    let c: Comment | void;\n    while ((c = comment())) {\n      if (c !== false) {\n        rules.push(c);\n      }\n      c = comment();\n    }\n    return rules;\n  }\n\n  /**\n   * Parse comment.\n   */\n\n  function comment() {\n    const pos = position();\n    if ('/' !== css.charAt(0) || '*' !== css.charAt(1)) {\n      return;\n    }\n\n    let i = 2;\n    while (\n      '' !== css.charAt(i) &&\n      ('*' !== css.charAt(i) || '/' !== css.charAt(i + 1))\n    ) {\n      ++i;\n    }\n    i += 2;\n\n    if ('' === css.charAt(i - 1)) {\n      return error('End of comment missing');\n    }\n\n    const str = css.slice(2, i - 2);\n    column += 2;\n    updatePosition(str);\n    css = css.slice(i);\n    column += 2;\n\n    return pos({\n      type: 'comment',\n      comment: str,\n    });\n  }\n\n  /**\n   * Parse selector.\n   */\n\n  function selector() {\n    const m = match(/^([^{]+)/);\n    if (!m) {\n      return;\n    }\n    /* @fix Remove all comments from selectors\n     * http://ostermiller.org/findcomment.html */\n    return trim(m[0])\n      .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '')\n      .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, (m) => {\n        return m.replace(/,/g, '\\u200C');\n      })\n      .split(/\\s*(?![^(]*\\)),\\s*/)\n      .map((s) => {\n        return s.replace(/\\u200C/g, ',');\n      });\n  }\n\n  /**\n   * Parse declaration.\n   */\n\n  function declaration(): Declaration | void | never {\n    const pos = position();\n\n    // prop\n    let propMatch = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\n    if (!propMatch) {\n      return;\n    }\n    const prop = trim(propMatch[0]);\n\n    // :\n    if (!match(/^:\\s*/)) {\n      return error(`property missing ':'`);\n    }\n\n    // val\n    const val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\n\n    const ret = pos({\n      type: 'declaration',\n      property: prop.replace(commentre, ''),\n      value: val ? trim(val[0]).replace(commentre, '') : '',\n    });\n\n    // ;\n    match(/^[;\\s]*/);\n\n    return ret;\n  }\n\n  /**\n   * Parse declarations.\n   */\n\n  function declarations() {\n    const decls: Array<object> = [];\n\n    if (!open()) {\n      return error(`missing '{'`);\n    }\n    comments(decls);\n\n    // declarations\n    let decl;\n    while ((decl = declaration())) {\n      if ((decl as unknown) !== false) {\n        decls.push(decl);\n        comments(decls);\n      }\n      decl = declaration();\n    }\n\n    if (!close()) {\n      return error(`missing '}'`);\n    }\n    return decls;\n  }\n\n  /**\n   * Parse keyframe.\n   */\n\n  function keyframe() {\n    let m;\n    const vals = [];\n    const pos = position();\n\n    while ((m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/))) {\n      vals.push(m[1]);\n      match(/^,\\s*/);\n    }\n\n    if (!vals.length) {\n      return;\n    }\n\n    return pos({\n      type: 'keyframe',\n      values: vals,\n      declarations: declarations() as Declaration[],\n    });\n  }\n\n  /**\n   * Parse keyframes.\n   */\n\n  function atkeyframes() {\n    const pos = position();\n    let m = match(/^@([-\\w]+)?keyframes\\s*/);\n\n    if (!m) {\n      return;\n    }\n    const vendor = m[1];\n\n    // identifier\n    m = match(/^([-\\w]+)\\s*/);\n    if (!m) {\n      return error('@keyframes missing name');\n    }\n    const name = m[1];\n\n    if (!open()) {\n      return error(`@keyframes missing '{'`);\n    }\n\n    let frame;\n    let frames = comments();\n    while ((frame = keyframe())) {\n      frames.push(frame);\n      frames = frames.concat(comments());\n    }\n\n    if (!close()) {\n      return error(`@keyframes missing '}'`);\n    }\n\n    return pos({\n      type: 'keyframes',\n      name,\n      vendor,\n      keyframes: frames,\n    });\n  }\n\n  /**\n   * Parse supports.\n   */\n\n  function atsupports() {\n    const pos = position();\n    const m = match(/^@supports *([^{]+)/);\n\n    if (!m) {\n      return;\n    }\n    const supports = trim(m[1]);\n\n    if (!open()) {\n      return error(`@supports missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@supports missing '}'`);\n    }\n\n    return pos({\n      type: 'supports',\n      supports,\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse host.\n   */\n\n  function athost() {\n    const pos = position();\n    const m = match(/^@host\\s*/);\n\n    if (!m) {\n      return;\n    }\n\n    if (!open()) {\n      return error(`@host missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@host missing '}'`);\n    }\n\n    return pos({\n      type: 'host',\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse media.\n   */\n\n  function atmedia() {\n    const pos = position();\n    const m = match(/^@media *([^{]+)/);\n\n    if (!m) {\n      return;\n    }\n    const media = trim(m[1]);\n\n    if (!open()) {\n      return error(`@media missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@media missing '}'`);\n    }\n\n    return pos({\n      type: 'media',\n      media,\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse custom-media.\n   */\n\n  function atcustommedia() {\n    const pos = position();\n    const m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\n    if (!m) {\n      return;\n    }\n\n    return pos({\n      type: 'custom-media',\n      name: trim(m[1]),\n      media: trim(m[2]),\n    });\n  }\n\n  /**\n   * Parse paged media.\n   */\n\n  function atpage() {\n    const pos = position();\n    const m = match(/^@page */);\n    if (!m) {\n      return;\n    }\n\n    const sel = selector() || [];\n\n    if (!open()) {\n      return error(`@page missing '{'`);\n    }\n    let decls = comments();\n\n    // declarations\n    let decl;\n    while ((decl = declaration())) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) {\n      return error(`@page missing '}'`);\n    }\n\n    return pos({\n      type: 'page',\n      selectors: sel,\n      declarations: decls,\n    });\n  }\n\n  /**\n   * Parse document.\n   */\n\n  function atdocument() {\n    const pos = position();\n    const m = match(/^@([-\\w]+)?document *([^{]+)/);\n    if (!m) {\n      return;\n    }\n\n    const vendor = trim(m[1]);\n    const doc = trim(m[2]);\n\n    if (!open()) {\n      return error(`@document missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@document missing '}'`);\n    }\n\n    return pos({\n      type: 'document',\n      document: doc,\n      vendor,\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse font-face.\n   */\n\n  function atfontface() {\n    const pos = position();\n    const m = match(/^@font-face\\s*/);\n    if (!m) {\n      return;\n    }\n\n    if (!open()) {\n      return error(`@font-face missing '{'`);\n    }\n    let decls = comments();\n\n    // declarations\n    let decl;\n    while ((decl = declaration())) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) {\n      return error(`@font-face missing '}'`);\n    }\n\n    return pos({\n      type: 'font-face',\n      declarations: decls,\n    });\n  }\n\n  /**\n   * Parse import\n   */\n\n  const atimport = _compileAtrule('import');\n\n  /**\n   * Parse charset\n   */\n\n  const atcharset = _compileAtrule('charset');\n\n  /**\n   * Parse namespace\n   */\n\n  const atnamespace = _compileAtrule('namespace');\n\n  /**\n   * Parse non-block at-rules\n   */\n\n  function _compileAtrule(name: string) {\n    const re = new RegExp('^@' + name + '\\\\s*([^;]+);');\n    return () => {\n      const pos = position();\n      const m = match(re);\n      if (!m) {\n        return;\n      }\n      const ret: Record<string, string> = { type: name };\n      ret[name] = m[1].trim();\n      return pos(ret);\n    };\n  }\n\n  /**\n   * Parse at rule.\n   */\n\n  function atrule() {\n    if (css[0] !== '@') {\n      return;\n    }\n\n    return (\n      atkeyframes() ||\n      atmedia() ||\n      atcustommedia() ||\n      atsupports() ||\n      atimport() ||\n      atcharset() ||\n      atnamespace() ||\n      atdocument() ||\n      atpage() ||\n      athost() ||\n      atfontface()\n    );\n  }\n\n  /**\n   * Parse rule.\n   */\n\n  function rule() {\n    const pos = position();\n    const sel = selector();\n\n    if (!sel) {\n      return error('selector missing');\n    }\n    comments();\n\n    return pos({\n      type: 'rule',\n      selectors: sel,\n      declarations: declarations() as Declaration[],\n    });\n  }\n\n  return addParent(stylesheet());\n}\n\n/**\n * Trim `str`.\n */\n\nfunction trim(str: string) {\n  return str ? str.replace(/^\\s+|\\s+$/g, '') : '';\n}\n\n/**\n * Adds non-enumerable parent node reference to each node.\n */\n\nfunction addParent(obj: Stylesheet, parent?: Stylesheet) {\n  const isNode = obj && typeof obj.type === 'string';\n  const childParent = isNode ? obj : parent;\n\n  for (const k of Object.keys(obj)) {\n    const value = obj[k as keyof Stylesheet];\n    if (Array.isArray(value)) {\n      value.forEach((v) => {\n        addParent(v, childParent);\n      });\n    } else if (value && typeof value === 'object') {\n      addParent((value as unknown) as Stylesheet, childParent);\n    }\n  }\n\n  if (isNode) {\n    Object.defineProperty(obj, 'parent', {\n      configurable: true,\n      writable: true,\n      enumerable: false,\n      value: parent || null,\n    });\n  }\n\n  return obj;\n}\n","import { parse } from './css';\nimport {\n  serializedNodeWithId,\n  NodeType,\n  tagMap,\n  elementNode,\n  idNodeMap,\n  INode,\n} from './types';\nimport { isElement } from './utils';\n\nconst tagMap: tagMap = {\n  script: 'noscript',\n  // camel case svg element tag names\n  altglyph: 'altGlyph',\n  altglyphdef: 'altGlyphDef',\n  altglyphitem: 'altGlyphItem',\n  animatecolor: 'animateColor',\n  animatemotion: 'animateMotion',\n  animatetransform: 'animateTransform',\n  clippath: 'clipPath',\n  feblend: 'feBlend',\n  fecolormatrix: 'feColorMatrix',\n  fecomponenttransfer: 'feComponentTransfer',\n  fecomposite: 'feComposite',\n  feconvolvematrix: 'feConvolveMatrix',\n  fediffuselighting: 'feDiffuseLighting',\n  fedisplacementmap: 'feDisplacementMap',\n  fedistantlight: 'feDistantLight',\n  fedropshadow: 'feDropShadow',\n  feflood: 'feFlood',\n  fefunca: 'feFuncA',\n  fefuncb: 'feFuncB',\n  fefuncg: 'feFuncG',\n  fefuncr: 'feFuncR',\n  fegaussianblur: 'feGaussianBlur',\n  feimage: 'feImage',\n  femerge: 'feMerge',\n  femergenode: 'feMergeNode',\n  femorphology: 'feMorphology',\n  feoffset: 'feOffset',\n  fepointlight: 'fePointLight',\n  fespecularlighting: 'feSpecularLighting',\n  fespotlight: 'feSpotLight',\n  fetile: 'feTile',\n  feturbulence: 'feTurbulence',\n  foreignobject: 'foreignObject',\n  glyphref: 'glyphRef',\n  lineargradient: 'linearGradient',\n  radialgradient: 'radialGradient',\n};\nfunction getTagName(n: elementNode): string {\n  let tagName = tagMap[n.tagName] ? tagMap[n.tagName] : n.tagName;\n  if (tagName === 'link' && n.attributes._cssText) {\n    tagName = 'style';\n  }\n  return tagName;\n}\n\n// based on https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#escaping\nfunction escapeRegExp(string: string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nconst HOVER_SELECTOR = /([^\\\\]):hover/;\nconst HOVER_SELECTOR_GLOBAL = new RegExp(HOVER_SELECTOR, 'g');\nexport function addHoverClass(cssText: string): string {\n  const ast = parse(cssText, {\n    silent: true,\n  });\n\n  if (!ast.stylesheet) {\n    return cssText;\n  }\n\n  const selectors: string[] = [];\n  ast.stylesheet.rules.forEach((rule) => {\n    if ('selectors' in rule) {\n      (rule.selectors || []).forEach((selector: string) => {\n        if (HOVER_SELECTOR.test(selector)) {\n          selectors.push(selector);\n        }\n      });\n    }\n  });\n\n  if (selectors.length === 0) return cssText;\n\n  const selectorMatcher = new RegExp(\n    selectors\n      .filter((selector, index) => selectors.indexOf(selector) === index)\n      .sort((a, b) => b.length - a.length)\n      .map((selector) => {\n        return escapeRegExp(selector);\n      })\n      .join('|'),\n    'g',\n  );\n\n  return cssText.replace(selectorMatcher, (selector) => {\n    const newSelector = selector.replace(HOVER_SELECTOR_GLOBAL, '$1.\\\\:hover');\n    return `${selector}, ${newSelector}`;\n  });\n}\n\nfunction buildNode(\n  n: serializedNodeWithId,\n  options: {\n    doc: Document;\n    hackCss: boolean;\n  },\n): Node | null {\n  const { doc, hackCss } = options;\n  switch (n.type) {\n    case NodeType.Document:\n      return doc.implementation.createDocument(null, '', null);\n    case NodeType.DocumentType:\n      return doc.implementation.createDocumentType(\n        n.name || 'html',\n        n.publicId,\n        n.systemId,\n      );\n    case NodeType.Element:\n      const tagName = getTagName(n);\n      let node: Element;\n      if (n.isSVG) {\n        node = doc.createElementNS('http://www.w3.org/2000/svg', tagName);\n      } else {\n        node = doc.createElement(tagName);\n      }\n      for (const name in n.attributes) {\n        if (!n.attributes.hasOwnProperty(name)) {\n          continue;\n        }\n        let value = n.attributes[name];\n        value =\n          typeof value === 'boolean' || typeof value === 'number' ? '' : value;\n        // attribute names start with rr_ are internal attributes added by rrweb\n        if (!name.startsWith('rr_')) {\n          const isTextarea = tagName === 'textarea' && name === 'value';\n          const isRemoteOrDynamicCss =\n            tagName === 'style' && name === '_cssText';\n          if (isRemoteOrDynamicCss && hackCss) {\n            value = addHoverClass(value);\n          }\n          if (isTextarea || isRemoteOrDynamicCss) {\n            const child = doc.createTextNode(value);\n            // https://github.com/rrweb-io/rrweb/issues/112\n            for (const c of Array.from(node.childNodes)) {\n              if (c.nodeType === node.TEXT_NODE) {\n                node.removeChild(c);\n              }\n            }\n            node.appendChild(child);\n            continue;\n          }\n          if (tagName === 'iframe' && name === 'src') {\n            continue;\n          }\n          try {\n            if (n.isSVG && name === 'xlink:href') {\n              node.setAttributeNS('http://www.w3.org/1999/xlink', name, value);\n            } else if (\n              name === 'onload' ||\n              name === 'onclick' ||\n              name.substring(0, 7) === 'onmouse'\n            ) {\n              // Rename some of the more common atttributes from https://www.w3schools.com/tags/ref_eventattributes.asp\n              // as setting them triggers a console.error (which shows up despite the try/catch)\n              // Assumption: these attributes are not used to css\n              node.setAttribute('_' + name, value);\n            } else {\n              node.setAttribute(name, value);\n            }\n          } catch (error) {\n            // skip invalid attribute\n          }\n        } else {\n          // handle internal attributes\n          if (tagName === 'canvas' && name === 'rr_dataURL') {\n            const image = document.createElement('img');\n            image.src = value;\n            image.onload = () => {\n              const ctx = (node as HTMLCanvasElement).getContext('2d');\n              if (ctx) {\n                ctx.drawImage(image, 0, 0, image.width, image.height);\n              }\n            };\n          }\n          if (name === 'rr_width') {\n            (node as HTMLElement).style.width = value;\n          }\n          if (name === 'rr_height') {\n            (node as HTMLElement).style.height = value;\n          }\n          if (name === 'rr_mediaState') {\n            switch (value) {\n              case 'played':\n                (node as HTMLMediaElement).play();\n              case 'paused':\n                (node as HTMLMediaElement).pause();\n                break;\n              default:\n            }\n          }\n        }\n      }\n      if (n.isShadowHost) {\n        /**\n         * Since node is newly rebuilt, it should be a normal element\n         * without shadowRoot.\n         * But if there are some weird situations that has defined\n         * custom element in the scope before we rebuild node, it may\n         * register the shadowRoot earlier.\n         * The logic in the 'else' block is just a try-my-best solution\n         * for the corner case, please let we know if it is wrong and\n         * we can remove it.\n         */\n        if (!node.shadowRoot) {\n          node.attachShadow({ mode: 'open' });\n        } else {\n          while (node.shadowRoot.firstChild) {\n            node.shadowRoot.removeChild(node.shadowRoot.firstChild);\n          }\n        }\n      }\n      return node;\n    case NodeType.Text:\n      return doc.createTextNode(\n        n.isStyle && hackCss ? addHoverClass(n.textContent) : n.textContent,\n      );\n    case NodeType.CDATA:\n      return doc.createCDATASection(n.textContent);\n    case NodeType.Comment:\n      return doc.createComment(n.textContent);\n    default:\n      return null;\n  }\n}\n\nexport function buildNodeWithSN(\n  n: serializedNodeWithId,\n  options: {\n    doc: Document;\n    map: idNodeMap;\n    skipChild?: boolean;\n    hackCss: boolean;\n    afterAppend?: (n: INode) => unknown;\n  },\n): INode | null {\n  const { doc, map, skipChild = false, hackCss = true, afterAppend } = options;\n  let node = buildNode(n, { doc, hackCss });\n  if (!node) {\n    return null;\n  }\n  if (n.rootId) {\n    console.assert(\n      ((map[n.rootId] as unknown) as Document) === doc,\n      'Target document should has the same root id.',\n    );\n  }\n  // use target document as root document\n  if (n.type === NodeType.Document) {\n    // close before open to make sure document was closed\n    doc.close();\n    doc.open();\n    node = doc;\n  }\n\n  (node as INode).__sn = n;\n  map[n.id] = node as INode;\n\n  if (\n    (n.type === NodeType.Document || n.type === NodeType.Element) &&\n    !skipChild\n  ) {\n    for (const childN of n.childNodes) {\n      const childNode = buildNodeWithSN(childN, {\n        doc,\n        map,\n        skipChild: false,\n        hackCss,\n        afterAppend,\n      });\n      if (!childNode) {\n        console.warn('Failed to rebuild', childN);\n        continue;\n      }\n\n      if (childN.isShadow && isElement(node) && node.shadowRoot) {\n        node.shadowRoot.appendChild(childNode);\n      } else {\n        node.appendChild(childNode);\n      }\n      if (afterAppend) {\n        afterAppend(childNode);\n      }\n    }\n  }\n\n  return node as INode;\n}\n\nfunction visit(idNodeMap: idNodeMap, onVisit: (node: INode) => void) {\n  function walk(node: INode) {\n    onVisit(node);\n  }\n\n  for (const key in idNodeMap) {\n    if (idNodeMap[key]) {\n      walk(idNodeMap[key]);\n    }\n  }\n}\n\nfunction handleScroll(node: INode) {\n  const n = node.__sn;\n  if (n.type !== NodeType.Element) {\n    return;\n  }\n  const el = (node as Node) as HTMLElement;\n  for (const name in n.attributes) {\n    if (!(n.attributes.hasOwnProperty(name) && name.startsWith('rr_'))) {\n      continue;\n    }\n    const value = n.attributes[name];\n    if (name === 'rr_scrollLeft') {\n      el.scrollLeft = value as number;\n    }\n    if (name === 'rr_scrollTop') {\n      el.scrollTop = value as number;\n    }\n  }\n}\n\nfunction rebuild(\n  n: serializedNodeWithId,\n  options: {\n    doc: Document;\n    onVisit?: (node: INode) => unknown;\n    hackCss?: boolean;\n    afterAppend?: (n: INode) => unknown;\n  },\n): [Node | null, idNodeMap] {\n  const { doc, onVisit, hackCss = true, afterAppend } = options;\n  const idNodeMap: idNodeMap = {};\n  const node = buildNodeWithSN(n, {\n    doc,\n    map: idNodeMap,\n    skipChild: false,\n    hackCss,\n    afterAppend,\n  });\n  visit(idNodeMap, (visitedNode) => {\n    if (onVisit) {\n      onVisit(visitedNode);\n    }\n    handleScroll(visitedNode);\n  });\n  return [node, idNodeMap];\n}\n\nexport default rebuild;\n","import snapshot, {\n  serializeNodeWithId,\n  transformAttribute,\n  visitSnapshot,\n  cleanupSnapshot,\n  needMaskingText,\n  IGNORED_NODE,\n} from './snapshot';\nimport rebuild, { buildNodeWithSN, addHoverClass } from './rebuild';\nexport * from './types';\nexport * from './utils';\n\nexport {\n  snapshot,\n  serializeNodeWithId,\n  rebuild,\n  buildNodeWithSN,\n  addHoverClass,\n  transformAttribute,\n  visitSnapshot,\n  cleanupSnapshot,\n  needMaskingText,\n  IGNORED_NODE,\n};\n","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\n\nvar iterableToArray = require(\"./iterableToArray.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import {\n  serializedNodeWithId,\n  idNodeMap,\n  INode,\n  MaskInputOptions,\n  SlimDOMOptions,\n} from './snapshot';\nimport { PackFn, UnpackFn } from './packer/base';\nimport { FontFaceDescriptors } from 'css-font-loading-module';\nimport { IframeManager } from './record/iframe-manager';\nimport { ShadowDomManager } from './record/shadow-dom-manager';\n\nexport enum EventType {\n  DomContentLoaded,\n  Load,\n  FullSnapshot,\n  IncrementalSnapshot,\n  Meta,\n  Custom,\n}\n\nexport type domContentLoadedEvent = {\n  type: EventType.DomContentLoaded;\n  data: {};\n};\n\nexport type loadedEvent = {\n  type: EventType.Load;\n  data: {};\n};\n\nexport type fullSnapshotEvent = {\n  type: EventType.FullSnapshot;\n  data: {\n    node: serializedNodeWithId;\n    initialOffset: {\n      top: number;\n      left: number;\n    };\n  };\n};\n\nexport type incrementalSnapshotEvent = {\n  type: EventType.IncrementalSnapshot;\n  data: incrementalData;\n};\n\nexport type metaEvent = {\n  type: EventType.Meta;\n  data: {\n    href: string;\n    width: number;\n    height: number;\n  };\n};\n\nexport type logEvent = {\n  type: EventType.IncrementalSnapshot;\n  data: incrementalData;\n};\n\nexport type customEvent<T = unknown> = {\n  type: EventType.Custom;\n  data: {\n    tag: string;\n    payload: T;\n  };\n};\n\nexport type styleSheetEvent = {};\n\nexport enum IncrementalSource {\n  Mutation,\n  MouseMove,\n  MouseInteraction,\n  Scroll,\n  ViewportResize,\n  Input,\n  TouchMove,\n  MediaInteraction,\n  StyleSheetRule,\n  CanvasMutation,\n  Font,\n  Log,\n  Drag,\n}\n\nexport type mutationData = {\n  source: IncrementalSource.Mutation;\n} & mutationCallbackParam;\n\nexport type mousemoveData = {\n  source:\n  | IncrementalSource.MouseMove\n  | IncrementalSource.TouchMove\n  | IncrementalSource.Drag;\n  positions: mousePosition[];\n};\n\nexport type mouseInteractionData = {\n  source: IncrementalSource.MouseInteraction;\n} & mouseInteractionParam;\n\nexport type scrollData = {\n  source: IncrementalSource.Scroll;\n} & scrollPosition;\n\nexport type viewportResizeData = {\n  source: IncrementalSource.ViewportResize;\n} & viewportResizeDimension;\n\nexport type inputData = {\n  source: IncrementalSource.Input;\n  id: number;\n} & inputValue;\n\nexport type mediaInteractionData = {\n  source: IncrementalSource.MediaInteraction;\n} & mediaInteractionParam;\n\nexport type styleSheetRuleData = {\n  source: IncrementalSource.StyleSheetRule;\n} & styleSheetRuleParam;\n\nexport type canvasMutationData = {\n  source: IncrementalSource.CanvasMutation;\n} & canvasMutationParam;\n\nexport type fontData = {\n  source: IncrementalSource.Font;\n} & fontParam;\n\nexport type logData = {\n  source: IncrementalSource.Log;\n} & LogParam;\n\nexport type incrementalData =\n  | mutationData\n  | mousemoveData\n  | mouseInteractionData\n  | scrollData\n  | viewportResizeData\n  | inputData\n  | mediaInteractionData\n  | styleSheetRuleData\n  | canvasMutationData\n  | fontData\n  | logData;\n\nexport type event =\n  | domContentLoadedEvent\n  | loadedEvent\n  | fullSnapshotEvent\n  | incrementalSnapshotEvent\n  | metaEvent\n  | logEvent\n  | customEvent;\n\nexport type eventWithTime = event & {\n  timestamp: number;\n  delay?: number;\n};\n\nexport type blockClass = string | RegExp;\n\nexport type maskTextClass = string | RegExp;\n\nexport type SamplingStrategy = Partial<{\n  /**\n   * false means not to record mouse/touch move events\n   * number is the throttle threshold of recording mouse/touch move\n   */\n  mousemove: boolean | number;\n  /**\n   * number is the throttle threshold of mouse/touch move callback\n   */\n  mousemoveCallback: number;\n  /**\n   * false means not to record mouse interaction events\n   * can also specify record some kinds of mouse interactions\n   */\n  mouseInteraction: boolean | Record<string, boolean | undefined>;\n  /**\n   * number is the throttle threshold of recording scroll\n   */\n  scroll: number;\n  /**\n   * 'all' will record all the input events\n   * 'last' will only record the last input value while input a sequence of chars\n   */\n  input: 'all' | 'last';\n}>;\n\nexport type recordOptions<T> = {\n  emit?: (e: T, isCheckout?: boolean) => void;\n  checkoutEveryNth?: number;\n  checkoutEveryNms?: number;\n  blockClass?: blockClass;\n  blockSelector?: string;\n  ignoreClass?: string;\n  maskTextClass?: maskTextClass;\n  maskTextSelector?: string;\n  maskAllInputs?: boolean;\n  maskInputOptions?: MaskInputOptions;\n  maskInputFn?: MaskInputFn;\n  maskTextFn?: MaskTextFn;\n  slimDOMOptions?: SlimDOMOptions | 'all' | true;\n  inlineStylesheet?: boolean;\n  hooks?: hooksParam;\n  packFn?: PackFn;\n  sampling?: SamplingStrategy;\n  recordCanvas?: boolean;\n  collectFonts?: boolean;\n  // departed, please use sampling options\n  mousemoveWait?: number;\n  recordLog?: boolean | LogRecordOptions;\n};\n\nexport type observerParam = {\n  mutationCb: mutationCallBack;\n  mousemoveCb: mousemoveCallBack;\n  mouseInteractionCb: mouseInteractionCallBack;\n  scrollCb: scrollCallback;\n  viewportResizeCb: viewportResizeCallback;\n  inputCb: inputCallback;\n  mediaInteractionCb: mediaInteractionCallback;\n  blockClass: blockClass;\n  blockSelector: string | null;\n  ignoreClass: string;\n  maskTextClass: maskTextClass;\n  maskTextSelector: string | null;\n  maskInputOptions: MaskInputOptions;\n  maskInputFn?: MaskInputFn;\n  maskTextFn?: MaskTextFn;\n  inlineStylesheet: boolean;\n  styleSheetRuleCb: styleSheetRuleCallback;\n  canvasMutationCb: canvasMutationCallback;\n  fontCb: fontCallback;\n  logCb: logCallback;\n  logOptions: LogRecordOptions;\n  sampling: SamplingStrategy;\n  recordCanvas: boolean;\n  collectFonts: boolean;\n  slimDOMOptions: SlimDOMOptions;\n  doc: Document;\n  mirror: Mirror;\n  iframeManager: IframeManager;\n  shadowDomManager: ShadowDomManager;\n};\n\nexport type hooksParam = {\n  mutation?: mutationCallBack;\n  mousemove?: mousemoveCallBack;\n  mouseInteraction?: mouseInteractionCallBack;\n  scroll?: scrollCallback;\n  viewportResize?: viewportResizeCallback;\n  input?: inputCallback;\n  mediaInteaction?: mediaInteractionCallback;\n  styleSheetRule?: styleSheetRuleCallback;\n  canvasMutation?: canvasMutationCallback;\n  font?: fontCallback;\n  log?: logCallback;\n};\n\n// https://dom.spec.whatwg.org/#interface-mutationrecord\nexport type mutationRecord = {\n  type: string;\n  target: Node;\n  oldValue: string | null;\n  addedNodes: NodeList;\n  removedNodes: NodeList;\n  attributeName: string | null;\n};\n\nexport type textCursor = {\n  node: Node;\n  value: string | null;\n};\nexport type textMutation = {\n  id: number;\n  value: string | null;\n};\n\nexport type attributeCursor = {\n  node: Node;\n  attributes: {\n    [key: string]: string | null;\n  };\n};\nexport type attributeMutation = {\n  id: number;\n  attributes: {\n    [key: string]: string | null;\n  };\n};\n\nexport type removedNodeMutation = {\n  parentId: number;\n  id: number;\n  isShadow?: boolean;\n};\n\nexport type addedNodeMutation = {\n  parentId: number;\n  // Newly recorded mutations will not have previousId any more, just for compatibility\n  previousId?: number | null;\n  nextId: number | null;\n  node: serializedNodeWithId;\n};\n\nexport type mutationCallbackParam = {\n  texts: textMutation[];\n  attributes: attributeMutation[];\n  removes: removedNodeMutation[];\n  adds: addedNodeMutation[];\n  isAttachIframe?: true;\n};\n\nexport type mutationCallBack = (m: mutationCallbackParam) => void;\n\nexport type mousemoveCallBack = (\n  p: mousePosition[],\n  source:\n    | IncrementalSource.MouseMove\n    | IncrementalSource.TouchMove\n    | IncrementalSource.Drag,\n) => void;\n\nexport type mousePosition = {\n  x: number;\n  y: number;\n  id: number;\n  timeOffset: number;\n};\n\nexport enum MouseInteractions {\n  MouseUp,\n  MouseDown,\n  Click,\n  ContextMenu,\n  DblClick,\n  Focus,\n  Blur,\n  TouchStart,\n  TouchMove_Departed, // we will start a separate observer for touch move event\n  TouchEnd,\n}\n\ntype mouseInteractionParam = {\n  type: MouseInteractions;\n  id: number;\n  x: number;\n  y: number;\n};\n\nexport type mouseInteractionCallBack = (d: mouseInteractionParam) => void;\n\nexport type scrollPosition = {\n  id: number;\n  x: number;\n  y: number;\n};\n\nexport type scrollCallback = (p: scrollPosition) => void;\n\nexport type styleSheetAddRule = {\n  rule: string;\n  index?: number;\n};\n\nexport type styleSheetDeleteRule = {\n  index: number;\n};\n\nexport type styleSheetRuleParam = {\n  id: number;\n  removes?: styleSheetDeleteRule[];\n  adds?: styleSheetAddRule[];\n};\n\nexport type styleSheetRuleCallback = (s: styleSheetRuleParam) => void;\n\nexport type canvasMutationCallback = (p: canvasMutationParam) => void;\n\nexport type canvasMutationParam = {\n  id: number;\n  property: string;\n  args: Array<unknown>;\n  setter?: true;\n};\n\nexport type fontParam = {\n  family: string;\n  fontSource: string;\n  buffer: boolean;\n  descriptors?: FontFaceDescriptors;\n};\n\nexport type LogLevel =\n  | 'assert'\n  | 'clear'\n  | 'count'\n  | 'countReset'\n  | 'debug'\n  | 'dir'\n  | 'dirxml'\n  | 'error'\n  | 'group'\n  | 'groupCollapsed'\n  | 'groupEnd'\n  | 'info'\n  | 'log'\n  | 'table'\n  | 'time'\n  | 'timeEnd'\n  | 'timeLog'\n  | 'trace'\n  | 'warn';\n\n/* fork from interface Console */\n// all kinds of console functions\nexport type Logger = {\n  assert?: typeof console.assert;\n  clear?: typeof console.clear;\n  count?: typeof console.count;\n  countReset?: typeof console.countReset;\n  debug?: typeof console.debug;\n  dir?: typeof console.dir;\n  dirxml?: typeof console.dirxml;\n  error?: typeof console.error;\n  group?: typeof console.group;\n  groupCollapsed?: typeof console.groupCollapsed;\n  groupEnd?: () => void;\n  info?: typeof console.info;\n  log?: typeof console.log;\n  table?: typeof console.table;\n  time?: typeof console.time;\n  timeEnd?: typeof console.timeEnd;\n  timeLog?: typeof console.timeLog;\n  trace?: typeof console.trace;\n  warn?: typeof console.warn;\n};\n\n/**\n * define an interface to replay log records\n * (data: logData) => void> function to display the log data\n */\nexport type ReplayLogger = Partial<Record<LogLevel, (data: logData) => void>>;\n\nexport type LogParam = {\n  level: LogLevel;\n  trace: string[];\n  payload: string[];\n};\n\nexport type fontCallback = (p: fontParam) => void;\n\nexport type logCallback = (p: LogParam) => void;\n\nexport type viewportResizeDimension = {\n  width: number;\n  height: number;\n};\n\nexport type viewportResizeCallback = (d: viewportResizeDimension) => void;\n\nexport type inputValue = {\n  text: string;\n  isChecked: boolean;\n};\n\nexport type inputCallback = (v: inputValue & { id: number }) => void;\n\nexport const enum MediaInteractions {\n  Play,\n  Pause,\n}\n\nexport type mediaInteractionParam = {\n  type: MediaInteractions;\n  id: number;\n};\n\nexport type mediaInteractionCallback = (p: mediaInteractionParam) => void;\n\nexport type DocumentDimension = {\n  x: number;\n  y: number;\n  // scale value relative to its parent iframe\n  relativeScale: number;\n  // scale value relative to the root iframe\n  absoluteScale: number;\n};\n\nexport type Mirror = {\n  map: idNodeMap;\n  getId: (n: INode) => number;\n  getNode: (id: number) => INode | null;\n  removeNodeFromMap: (n: INode) => void;\n  has: (id: number) => boolean;\n  reset: () => void;\n};\n\nexport type throttleOptions = {\n  leading?: boolean;\n  trailing?: boolean;\n};\n\nexport type listenerHandler = () => void;\nexport type hookResetter = () => void;\n\nexport type playerConfig = {\n  speed: number;\n  maxSpeed: number;\n  root: Element;\n  loadTimeout: number;\n  skipInactive: boolean;\n  showWarning: boolean;\n  showDebug: boolean;\n  blockClass: string;\n  liveMode: boolean;\n  insertStyleRules: string[];\n  triggerFocus: boolean;\n  UNSAFE_replayCanvas: boolean;\n  pauseAnimation?: boolean;\n  mouseTail:\n  | boolean\n  | {\n    duration?: number;\n    lineCap?: string;\n    lineWidth?: number;\n    strokeStyle?: string;\n  };\n  unpackFn?: UnpackFn;\n  logConfig: LogReplayConfig;\n};\n\nexport type LogReplayConfig = {\n  level?: LogLevel[] | undefined;\n  replayLogger: ReplayLogger | undefined;\n};\n\nexport type playerMetaData = {\n  startTime: number;\n  endTime: number;\n  totalTime: number;\n};\n\nexport type missingNode = {\n  node: Node;\n  mutation: addedNodeMutation;\n};\nexport type missingNodeMap = {\n  [id: number]: missingNode;\n};\n\nexport type actionWithDelay = {\n  doAction: () => void;\n  delay: number;\n};\n\nexport type Handler = (event?: unknown) => void;\n\nexport type Emitter = {\n  on(type: string, handler: Handler): void;\n  emit(type: string, event?: unknown): void;\n  off(type: string, handler: Handler): void;\n};\n\nexport type Arguments<T> = T extends (...payload: infer U) => unknown\n  ? U\n  : unknown;\n\nexport enum ReplayerEvents {\n  Start = 'start',\n  Pause = 'pause',\n  Resume = 'resume',\n  Resize = 'resize',\n  Finish = 'finish',\n  FullsnapshotRebuilded = 'fullsnapshot-rebuilded',\n  LoadStylesheetStart = 'load-stylesheet-start',\n  LoadStylesheetEnd = 'load-stylesheet-end',\n  SkipStart = 'skip-start',\n  SkipEnd = 'skip-end',\n  MouseInteraction = 'mouse-interaction',\n  EventCast = 'event-cast',\n  CustomEvent = 'custom-event',\n  Flush = 'flush',\n  StateChange = 'state-change',\n  PlayBack = 'play-back',\n}\n\nexport type MaskInputFn = (text: string) => string;\n\nexport type MaskTextFn = (text: string) => string;\n\n// store the state that would be changed during the process(unmount from dom and mount again)\nexport type ElementState = {\n  // [scrollLeft,scrollTop]\n  scroll?: [number, number];\n};\n\nexport type StringifyOptions = {\n  // limit of string length\n  stringLengthLimit?: number;\n  /**\n   * limit of number of keys in an object\n   * if an object contains more keys than this limit, we would call its toString function directly\n   */\n  numOfKeysLimit: number;\n};\n\nexport type LogRecordOptions = {\n  level?: LogLevel[] | undefined;\n  lengthThreshold?: number;\n  stringifyOptions?: StringifyOptions;\n  logger?: Logger;\n};\n","import {\n  Mirror,\n  throttleOptions,\n  listenerHandler,\n  hookResetter,\n  blockClass,\n  eventWithTime,\n  EventType,\n  IncrementalSource,\n  addedNodeMutation,\n  removedNodeMutation,\n  textMutation,\n  attributeMutation,\n  mutationData,\n  scrollData,\n  inputData,\n  DocumentDimension,\n} from './types';\nimport {\n  INode,\n  IGNORED_NODE,\n  serializedNodeWithId,\n  NodeType,\n  isShadowRoot,\n} from './snapshot';\n\nexport function on(\n  type: string,\n  fn: EventListenerOrEventListenerObject,\n  target: Document | Window = document,\n): listenerHandler {\n  const options = { capture: true, passive: true };\n  target.addEventListener(type, fn, options);\n  return () => target.removeEventListener(type, fn, options);\n}\n\nexport function createMirror(): Mirror {\n  return {\n    map: {},\n    getId(n) {\n      // if n is not a serialized INode, use -1 as its id.\n      if (!n.__sn) {\n        return -1;\n      }\n      return n.__sn.id;\n    },\n    getNode(id) {\n      return this.map[id] || null;\n    },\n    // TODO: use a weakmap to get rid of manually memory management\n    removeNodeFromMap(n) {\n      const id = n.__sn && n.__sn.id;\n      delete this.map[id];\n      if (n.childNodes) {\n        n.childNodes.forEach((child) =>\n          this.removeNodeFromMap((child as Node) as INode),\n        );\n      }\n    },\n    has(id) {\n      return this.map.hasOwnProperty(id);\n    },\n    reset() {\n      this.map = {};\n    },\n  };\n}\n\n// https://github.com/rrweb-io/rrweb/pull/407\nconst DEPARTED_MIRROR_ACCESS_WARNING =\n  'Please stop import mirror directly. Instead of that,' +\n  '\\r\\n' +\n  'now you can use replayer.getMirror() to access the mirror instance of a replayer,' +\n  '\\r\\n' +\n  'or you can use record.mirror to access the mirror instance during recording.';\nexport let _mirror: Mirror = {\n  map: {},\n  getId() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n    return -1;\n  },\n  getNode() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n    return null;\n  },\n  removeNodeFromMap() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n  },\n  has() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n    return false;\n  },\n  reset() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n  },\n};\nif (typeof window !== 'undefined' && window.Proxy && window.Reflect) {\n  _mirror = new Proxy(_mirror, {\n    get(target, prop, receiver) {\n      if (prop === 'map') {\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n      }\n      return Reflect.get(target, prop, receiver);\n    },\n  });\n}\n\n// copy from underscore and modified\nexport function throttle<T>(\n  func: (arg: T) => void,\n  wait: number,\n  options: throttleOptions = {},\n) {\n  let timeout: number | null = null;\n  let previous = 0;\n  // tslint:disable-next-line: only-arrow-functions\n  return function (arg: T) {\n    let now = Date.now();\n    if (!previous && options.leading === false) {\n      previous = now;\n    }\n    let remaining = wait - (now - previous);\n    let context = this;\n    let args = arguments as any;\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        window.clearTimeout(timeout);\n        timeout = null;\n      }\n      previous = now;\n      func.apply(context, args);\n    } else if (!timeout && options.trailing !== false) {\n      timeout = window.setTimeout(() => {\n        previous = options.leading === false ? 0 : Date.now();\n        timeout = null;\n        func.apply(context, args);\n      }, remaining);\n    }\n  };\n}\n\nexport function hookSetter<T>(\n  target: T,\n  key: string | number | symbol,\n  d: PropertyDescriptor,\n  isRevoked?: boolean,\n  win = window,\n): hookResetter {\n  const original = win.Object.getOwnPropertyDescriptor(target, key);\n  win.Object.defineProperty(\n    target,\n    key,\n    isRevoked\n      ? d\n      : {\n        set(value) {\n          // put hooked setter into event loop to avoid of set latency\n          setTimeout(() => {\n            d.set!.call(this, value);\n          }, 0);\n          if (original && original.set) {\n            original.set.call(this, value);\n          }\n        },\n      },\n  );\n  return () => hookSetter(target, key, original || {}, true);\n}\n\n// copy from https://github.com/getsentry/sentry-javascript/blob/b2109071975af8bf0316d3b5b38f519bdaf5dc15/packages/utils/src/object.ts\nexport function patch(\n  // tslint:disable-next-line:no-any\n  source: { [key: string]: any },\n  name: string,\n  // tslint:disable-next-line:no-any\n  replacement: (...args: any[]) => any,\n): () => void {\n  try {\n    if (!(name in source)) {\n      return () => { };\n    }\n\n    const original = source[name] as () => unknown;\n    const wrapped = replacement(original);\n\n    // Make sure it's a function first, as we need to attach an empty prototype for `defineProperties` to work\n    // otherwise it'll throw \"TypeError: Object.defineProperties called on non-object\"\n    // tslint:disable-next-line:strict-type-predicates\n    if (typeof wrapped === 'function') {\n      wrapped.prototype = wrapped.prototype || {};\n      Object.defineProperties(wrapped, {\n        __rrweb_original__: {\n          enumerable: false,\n          value: original,\n        },\n      });\n    }\n\n    source[name] = wrapped;\n\n    return () => {\n      source[name] = original;\n    };\n  } catch {\n    return () => { };\n    // This can throw if multiple fill happens on a global object like XMLHttpRequest\n    // Fixes https://github.com/getsentry/sentry-javascript/issues/2043\n  }\n}\n\nexport function getWindowHeight(): number {\n  return (\n    window.innerHeight ||\n    (document.documentElement && document.documentElement.clientHeight) ||\n    (document.body && document.body.clientHeight)\n  );\n}\n\nexport function getWindowWidth(): number {\n  return (\n    window.innerWidth ||\n    (document.documentElement && document.documentElement.clientWidth) ||\n    (document.body && document.body.clientWidth)\n  );\n}\n\nexport function isBlocked(node: Node | null, blockClass: blockClass): boolean {\n  if (!node) {\n    return false;\n  }\n  if (node.nodeType === node.ELEMENT_NODE) {\n    let needBlock = false;\n    if (typeof blockClass === 'string') {\n      needBlock = (node as HTMLElement).classList.contains(blockClass);\n    } else {\n      (node as HTMLElement).classList.forEach((className) => {\n        if (blockClass.test(className)) {\n          needBlock = true;\n        }\n      });\n    }\n    return needBlock || isBlocked(node.parentNode, blockClass);\n  }\n  if (node.nodeType === node.TEXT_NODE) {\n    // check parent node since text node do not have class name\n    return isBlocked(node.parentNode, blockClass);\n  }\n  return isBlocked(node.parentNode, blockClass);\n}\n\nexport function isIgnored(n: Node | INode): boolean {\n  if ('__sn' in n) {\n    return (n as INode).__sn.id === IGNORED_NODE;\n  }\n  // The main part of the slimDOM check happens in\n  // rrweb-snapshot::serializeNodeWithId\n  return false;\n}\n\nexport function isAncestorRemoved(target: INode, mirror: Mirror): boolean {\n  if (isShadowRoot(target)) {\n    return false;\n  }\n  const id = mirror.getId(target);\n  if (!mirror.has(id)) {\n    return true;\n  }\n  if (\n    target.parentNode &&\n    target.parentNode.nodeType === target.DOCUMENT_NODE\n  ) {\n    return false;\n  }\n  // if the root is not document, it means the node is not in the DOM tree anymore\n  if (!target.parentNode) {\n    return true;\n  }\n  return isAncestorRemoved((target.parentNode as unknown) as INode, mirror);\n}\n\nexport function isTouchEvent(\n  event: MouseEvent | TouchEvent,\n): event is TouchEvent {\n  return Boolean((event as TouchEvent).changedTouches);\n}\n\nexport function polyfill(win = window) {\n  if ('NodeList' in win && !win.NodeList.prototype.forEach) {\n    win.NodeList.prototype.forEach = (Array.prototype\n      .forEach as unknown) as NodeList['forEach'];\n  }\n\n  if ('DOMTokenList' in win && !win.DOMTokenList.prototype.forEach) {\n    win.DOMTokenList.prototype.forEach = (Array.prototype\n      .forEach as unknown) as DOMTokenList['forEach'];\n  }\n\n  // https://github.com/Financial-Times/polyfill-service/pull/183\n  if (!Node.prototype.contains) {\n    Node.prototype.contains = function contains(node) {\n      if (!(0 in arguments)) {\n        throw new TypeError('1 argument is required');\n      }\n\n      do {\n        if (this === node) {\n          return true;\n        }\n        // tslint:disable-next-line: no-conditional-assignment\n      } while ((node = node && node.parentNode));\n\n      return false;\n    };\n  }\n}\n\nexport function needCastInSyncMode(event: eventWithTime): boolean {\n  switch (event.type) {\n    case EventType.DomContentLoaded:\n    case EventType.Load:\n    case EventType.Custom:\n      return false;\n    case EventType.FullSnapshot:\n    case EventType.Meta:\n      return true;\n    default:\n      break;\n  }\n\n  switch (event.data.source) {\n    case IncrementalSource.MouseMove:\n    case IncrementalSource.MouseInteraction:\n    case IncrementalSource.TouchMove:\n    case IncrementalSource.MediaInteraction:\n      return false;\n    case IncrementalSource.ViewportResize:\n    case IncrementalSource.StyleSheetRule:\n    case IncrementalSource.Scroll:\n    case IncrementalSource.Input:\n      return true;\n    default:\n      break;\n  }\n\n  return true;\n}\n\nexport type TreeNode = {\n  id: number;\n  mutation: addedNodeMutation;\n  parent?: TreeNode;\n  children: Record<number, TreeNode>;\n  texts: textMutation[];\n  attributes: attributeMutation[];\n};\nexport class TreeIndex {\n  public tree!: Record<number, TreeNode>;\n\n  private removeNodeMutations!: removedNodeMutation[];\n  private textMutations!: textMutation[];\n  private attributeMutations!: attributeMutation[];\n  private indexes!: Map<number, TreeNode>;\n  private removeIdSet!: Set<number>;\n  private scrollMap!: Map<number, scrollData>;\n  private inputMap!: Map<number, inputData>;\n\n  constructor() {\n    this.reset();\n  }\n\n  public add(mutation: addedNodeMutation) {\n    const parentTreeNode = this.indexes.get(mutation.parentId);\n    const treeNode: TreeNode = {\n      id: mutation.node.id,\n      mutation,\n      children: [],\n      texts: [],\n      attributes: [],\n    };\n    if (!parentTreeNode) {\n      this.tree[treeNode.id] = treeNode;\n    } else {\n      treeNode.parent = parentTreeNode;\n      parentTreeNode.children[treeNode.id] = treeNode;\n    }\n    this.indexes.set(treeNode.id, treeNode);\n  }\n\n  public remove(mutation: removedNodeMutation, mirror: Mirror) {\n    const parentTreeNode = this.indexes.get(mutation.parentId);\n    const treeNode = this.indexes.get(mutation.id);\n\n    const deepRemoveFromMirror = (id: number) => {\n      this.removeIdSet.add(id);\n      const node = mirror.getNode(id);\n      node?.childNodes.forEach((childNode) => {\n        if ('__sn' in childNode) {\n          deepRemoveFromMirror(((childNode as unknown) as INode).__sn.id);\n        }\n      });\n    };\n    const deepRemoveFromTreeIndex = (node: TreeNode) => {\n      this.removeIdSet.add(node.id);\n      Object.values(node.children).forEach((n) => deepRemoveFromTreeIndex(n));\n      const _treeNode = this.indexes.get(node.id);\n      if (_treeNode) {\n        const _parentTreeNode = _treeNode.parent;\n        if (_parentTreeNode) {\n          delete _treeNode.parent;\n          delete _parentTreeNode.children[_treeNode.id];\n          this.indexes.delete(mutation.id);\n        }\n      }\n    };\n\n    if (!treeNode) {\n      this.removeNodeMutations.push(mutation);\n      deepRemoveFromMirror(mutation.id);\n    } else if (!parentTreeNode) {\n      delete this.tree[treeNode.id];\n      this.indexes.delete(treeNode.id);\n      deepRemoveFromTreeIndex(treeNode);\n    } else {\n      delete treeNode.parent;\n      delete parentTreeNode.children[treeNode.id];\n      this.indexes.delete(mutation.id);\n      deepRemoveFromTreeIndex(treeNode);\n    }\n  }\n\n  public text(mutation: textMutation) {\n    const treeNode = this.indexes.get(mutation.id);\n    if (treeNode) {\n      treeNode.texts.push(mutation);\n    } else {\n      this.textMutations.push(mutation);\n    }\n  }\n\n  public attribute(mutation: attributeMutation) {\n    const treeNode = this.indexes.get(mutation.id);\n    if (treeNode) {\n      treeNode.attributes.push(mutation);\n    } else {\n      this.attributeMutations.push(mutation);\n    }\n  }\n\n  public scroll(d: scrollData) {\n    this.scrollMap.set(d.id, d);\n  }\n\n  public input(d: inputData) {\n    this.inputMap.set(d.id, d);\n  }\n\n  public flush(): {\n    mutationData: mutationData;\n    scrollMap: TreeIndex['scrollMap'];\n    inputMap: TreeIndex['inputMap'];\n  } {\n    const {\n      tree,\n      removeNodeMutations,\n      textMutations,\n      attributeMutations,\n    } = this;\n\n    const batchMutationData: mutationData = {\n      source: IncrementalSource.Mutation,\n      removes: removeNodeMutations,\n      texts: textMutations,\n      attributes: attributeMutations,\n      adds: [],\n    };\n\n    const walk = (treeNode: TreeNode, removed: boolean) => {\n      if (removed) {\n        this.removeIdSet.add(treeNode.id);\n      }\n      batchMutationData.texts = batchMutationData.texts\n        .concat(removed ? [] : treeNode.texts)\n        .filter((m) => !this.removeIdSet.has(m.id));\n      batchMutationData.attributes = batchMutationData.attributes\n        .concat(removed ? [] : treeNode.attributes)\n        .filter((m) => !this.removeIdSet.has(m.id));\n      if (\n        !this.removeIdSet.has(treeNode.id) &&\n        !this.removeIdSet.has(treeNode.mutation.parentId) &&\n        !removed\n      ) {\n        batchMutationData.adds.push(treeNode.mutation);\n        if (treeNode.children) {\n          Object.values(treeNode.children).forEach((n) => walk(n, false));\n        }\n      } else {\n        Object.values(treeNode.children).forEach((n) => walk(n, true));\n      }\n    };\n\n    Object.values(tree).forEach((n) => walk(n, false));\n\n    for (const id of this.scrollMap.keys()) {\n      if (this.removeIdSet.has(id)) {\n        this.scrollMap.delete(id);\n      }\n    }\n    for (const id of this.inputMap.keys()) {\n      if (this.removeIdSet.has(id)) {\n        this.inputMap.delete(id);\n      }\n    }\n\n    const scrollMap = new Map(this.scrollMap);\n    const inputMap = new Map(this.inputMap);\n\n    this.reset();\n\n    return {\n      mutationData: batchMutationData,\n      scrollMap,\n      inputMap,\n    };\n  }\n\n  private reset() {\n    this.tree = [];\n    this.indexes = new Map();\n    this.removeNodeMutations = [];\n    this.textMutations = [];\n    this.attributeMutations = [];\n    this.removeIdSet = new Set();\n    this.scrollMap = new Map();\n    this.inputMap = new Map();\n  }\n}\n\ntype ResolveTree = {\n  value: addedNodeMutation;\n  children: ResolveTree[];\n  parent: ResolveTree | null;\n};\n\nexport function queueToResolveTrees(queue: addedNodeMutation[]): ResolveTree[] {\n  const queueNodeMap: Record<number, ResolveTree> = {};\n  const putIntoMap = (\n    m: addedNodeMutation,\n    parent: ResolveTree | null,\n  ): ResolveTree => {\n    const nodeInTree: ResolveTree = {\n      value: m,\n      parent,\n      children: [],\n    };\n    queueNodeMap[m.node.id] = nodeInTree;\n    return nodeInTree;\n  };\n\n  const queueNodeTrees: ResolveTree[] = [];\n  for (const mutation of queue) {\n    const { nextId, parentId } = mutation;\n    if (nextId && nextId in queueNodeMap) {\n      const nextInTree = queueNodeMap[nextId];\n      if (nextInTree.parent) {\n        const idx = nextInTree.parent.children.indexOf(nextInTree);\n        nextInTree.parent.children.splice(\n          idx,\n          0,\n          putIntoMap(mutation, nextInTree.parent),\n        );\n      } else {\n        const idx = queueNodeTrees.indexOf(nextInTree);\n        queueNodeTrees.splice(idx, 0, putIntoMap(mutation, null));\n      }\n      continue;\n    }\n    if (parentId in queueNodeMap) {\n      const parentInTree = queueNodeMap[parentId];\n      parentInTree.children.push(putIntoMap(mutation, parentInTree));\n      continue;\n    }\n    queueNodeTrees.push(putIntoMap(mutation, null));\n  }\n\n  return queueNodeTrees;\n}\n\nexport function iterateResolveTree(\n  tree: ResolveTree,\n  cb: (mutation: addedNodeMutation) => unknown,\n) {\n  cb(tree.value);\n  /**\n   * The resolve tree was designed to reflect the DOM layout,\n   * but we need append next sibling first, so we do a reverse\n   * loop here.\n   */\n  for (let i = tree.children.length - 1; i >= 0; i--) {\n    iterateResolveTree(tree.children[i], cb);\n  }\n}\n\ntype HTMLIFrameINode = HTMLIFrameElement & {\n  __sn: serializedNodeWithId;\n};\nexport type AppendedIframe = {\n  mutationInQueue: addedNodeMutation;\n  builtNode: HTMLIFrameINode;\n};\n\nexport function isIframeINode(\n  node: INode | ShadowRoot,\n): node is HTMLIFrameINode {\n  if ('__sn' in node) {\n    return (\n      node.__sn.type === NodeType.Element && node.__sn.tagName === 'iframe'\n    );\n  }\n  // node can be document fragment when using the virtual parent feature\n  return false;\n}\n\nexport function getBaseDimension(\n  node: Node,\n  rootIframe: Node,\n): DocumentDimension {\n  const frameElement = node.ownerDocument?.defaultView?.frameElement;\n  if (!frameElement || frameElement === rootIframe) {\n    return {\n      x: 0,\n      y: 0,\n      relativeScale: 1,\n      absoluteScale: 1,\n    };\n  }\n\n  const frameDimension = frameElement.getBoundingClientRect();\n  const frameBaseDimension = getBaseDimension(frameElement, rootIframe);\n  // the iframe element may have a scale transform\n  const relativeScale = frameDimension.height / frameElement.clientHeight;\n  return {\n    x:\n      frameDimension.x * frameBaseDimension.relativeScale +\n      frameBaseDimension.x,\n    y:\n      frameDimension.y * frameBaseDimension.relativeScale +\n      frameBaseDimension.y,\n    relativeScale,\n    absoluteScale: frameBaseDimension.absoluteScale * relativeScale,\n  };\n}\n\nexport function hasShadowRoot<T extends Node>(\n  n: T,\n): n is T & { shadowRoot: ShadowRoot } {\n  return Boolean(((n as unknown) as Element)?.shadowRoot);\n}\n","// @ts-nocheck\nimport {\n  INode,\n  serializeNodeWithId,\n  transformAttribute,\n  MaskInputOptions,\n  SlimDOMOptions,\n  IGNORED_NODE,\n  isShadowRoot,\n  needMaskingText,\n} from '../snapshot';\nimport {\n  mutationRecord,\n  blockClass,\n  maskTextClass,\n  mutationCallBack,\n  textCursor,\n  attributeCursor,\n  removedNodeMutation,\n  addedNodeMutation,\n  MaskTextFn,\n  Mirror,\n} from '../types';\nimport {\n  isBlocked,\n  isAncestorRemoved,\n  isIgnored,\n  isIframeINode,\n  hasShadowRoot,\n} from '../utils';\nimport { IframeManager } from './iframe-manager';\nimport { ShadowDomManager } from './shadow-dom-manager';\n\ntype DoubleLinkedListNode = {\n  previous: DoubleLinkedListNode | null;\n  next: DoubleLinkedListNode | null;\n  value: NodeInLinkedList;\n};\ntype NodeInLinkedList = Node & {\n  __ln: DoubleLinkedListNode;\n};\n\nfunction isNodeInLinkedList(n: Node | NodeInLinkedList): n is NodeInLinkedList {\n  return '__ln' in n;\n}\nclass DoubleLinkedList {\n  public length = 0;\n  public head: DoubleLinkedListNode | null = null;\n\n  public get(position: number) {\n    if (position >= this.length) {\n      throw new Error('Position outside of list range');\n    }\n\n    let current = this.head;\n    for (let index = 0; index < position; index++) {\n      current = current?.next || null;\n    }\n    return current;\n  }\n\n  public addNode(n: Node) {\n    const node: DoubleLinkedListNode = {\n      value: n as NodeInLinkedList,\n      previous: null,\n      next: null,\n    };\n    (n as NodeInLinkedList).__ln = node;\n    if (n.previousSibling && isNodeInLinkedList(n.previousSibling)) {\n      const current = n.previousSibling.__ln.next;\n      node.next = current;\n      node.previous = n.previousSibling.__ln;\n      n.previousSibling.__ln.next = node;\n      if (current) {\n        current.previous = node;\n      }\n    } else if (\n      n.nextSibling &&\n      isNodeInLinkedList(n.nextSibling) &&\n      n.nextSibling.__ln.previous\n    ) {\n      const current = n.nextSibling.__ln.previous;\n      node.previous = current;\n      node.next = n.nextSibling.__ln;\n      n.nextSibling.__ln.previous = node;\n      if (current) {\n        current.next = node;\n      }\n    } else {\n      if (this.head) {\n        this.head.previous = node;\n      }\n      node.next = this.head;\n      this.head = node;\n    }\n    this.length++;\n  }\n\n  public removeNode(n: NodeInLinkedList) {\n    const current = n.__ln;\n    if (!this.head) {\n      return;\n    }\n\n    if (!current.previous) {\n      this.head = current.next;\n      if (this.head) {\n        this.head.previous = null;\n      }\n    } else {\n      current.previous.next = current.next;\n      if (current.next) {\n        current.next.previous = current.previous;\n      }\n    }\n    if (n.__ln) {\n      delete n.__ln;\n    }\n    this.length--;\n  }\n}\n\nconst moveKey = (id: number, parentId: number) => `${id}@${parentId}`;\nfunction isINode(n: Node | INode): n is INode {\n  return '__sn' in n;\n}\n\n/**\n * controls behaviour of a MutationObserver\n */\nexport default class MutationBuffer {\n  private frozen: boolean = false;\n  private locked: boolean = false;\n\n  private texts: textCursor[] = [];\n  private attributes: attributeCursor[] = [];\n  private removes: removedNodeMutation[] = [];\n  private mapRemoves: Node[] = [];\n\n  private movedMap: Record<string, true> = {};\n\n  /**\n   * the browser MutationObserver emits multiple mutations after\n   * a delay for performance reasons, making tracing added nodes hard\n   * in our `processMutations` callback function.\n   * For example, if we append an element el_1 into body, and then append\n   * another element el_2 into el_1, these two mutations may be passed to the\n   * callback function together when the two operations were done.\n   * Generally we need to trace child nodes of newly added nodes, but in this\n   * case if we count el_2 as el_1's child node in the first mutation record,\n   * then we will count el_2 again in the second mutation record which was\n   * duplicated.\n   * To avoid of duplicate counting added nodes, we use a Set to store\n   * added nodes and its child nodes during iterate mutation records. Then\n   * collect added nodes from the Set which have no duplicate copy. But\n   * this also causes newly added nodes will not be serialized with id ASAP,\n   * which means all the id related calculation should be lazy too.\n   */\n  private addedSet = new Set<Node>();\n  private movedSet = new Set<Node>();\n  private droppedSet = new Set<Node>();\n\n  private emissionCallback: mutationCallBack;\n  private blockClass: blockClass;\n  private blockSelector: string | null;\n  private maskTextClass: maskTextClass;\n  private maskTextSelector: string | null;\n  private inlineStylesheet: boolean;\n  private maskInputOptions: MaskInputOptions;\n  private maskTextFn: MaskTextFn | undefined;\n  private recordCanvas: boolean;\n  private slimDOMOptions: SlimDOMOptions;\n  private doc: Document;\n\n  private mirror: Mirror;\n  private iframeManager: IframeManager;\n  private shadowDomManager: ShadowDomManager;\n\n  public init(\n    cb: mutationCallBack,\n    blockClass: blockClass,\n    blockSelector: string | null,\n    maskTextClass: maskTextClass,\n    maskTextSelector: string | null,\n    inlineStylesheet: boolean,\n    maskInputOptions: MaskInputOptions,\n    maskTextFn: MaskTextFn | undefined,\n    recordCanvas: boolean,\n    slimDOMOptions: SlimDOMOptions,\n    doc: Document,\n    mirror: Mirror,\n    iframeManager: IframeManager,\n    shadowDomManager: ShadowDomManager,\n  ) {\n    this.blockClass = blockClass;\n    this.blockSelector = blockSelector;\n    this.maskTextClass = maskTextClass;\n    this.maskTextSelector = maskTextSelector;\n    this.inlineStylesheet = inlineStylesheet;\n    this.maskInputOptions = maskInputOptions;\n    this.maskTextFn = maskTextFn;\n    this.recordCanvas = recordCanvas;\n    this.slimDOMOptions = slimDOMOptions;\n    this.emissionCallback = cb;\n    this.doc = doc;\n    this.mirror = mirror;\n    this.iframeManager = iframeManager;\n    this.shadowDomManager = shadowDomManager;\n  }\n\n  public freeze() {\n    this.frozen = true;\n  }\n\n  public unfreeze() {\n    this.frozen = false;\n    this.emit();\n  }\n\n  public isFrozen() {\n    return this.frozen;\n  }\n\n  public lock() {\n    this.locked = true;\n  }\n\n  public unlock() {\n    this.locked = false;\n    this.emit();\n  }\n\n  public processMutations = (mutations: mutationRecord[]) => {\n    mutations.forEach(this.processMutation);\n    this.emit();\n  };\n\n  public emit = () => {\n    if (this.frozen || this.locked) {\n      return;\n    }\n\n    // delay any modification of the mirror until this function\n    // so that the mirror for takeFullSnapshot doesn't get mutated while it's event is being processed\n\n    const adds: addedNodeMutation[] = [];\n\n    /**\n     * Sometimes child node may be pushed before its newly added\n     * parent, so we init a queue to store these nodes.\n     */\n    const addList = new DoubleLinkedList();\n    const getNextId = (n: Node): number | null => {\n      let ns: Node | null = n;\n      let nextId: number | null = IGNORED_NODE; // slimDOM: ignored\n      while (nextId === IGNORED_NODE) {\n        ns = ns && ns.nextSibling;\n        nextId = ns && this.mirror.getId((ns as unknown) as INode);\n      }\n      if (nextId === -1 && isBlocked(n.nextSibling, this.blockClass)) {\n        nextId = null;\n      }\n      return nextId;\n    };\n    const pushAdd = (n: Node) => {\n      const shadowHost: Element | null = n.getRootNode\n        ? (n.getRootNode() as ShadowRoot)?.host\n        : null;\n      const notInDoc = !this.doc.contains(n) && !this.doc.contains(shadowHost);\n      if (!n.parentNode || notInDoc) {\n        return;\n      }\n      const parentId = isShadowRoot(n.parentNode)\n        ? this.mirror.getId((shadowHost as unknown) as INode)\n        : this.mirror.getId((n.parentNode as Node) as INode);\n      const nextId = getNextId(n);\n      if (parentId === -1 || nextId === -1) {\n        return addList.addNode(n);\n      }\n      let sn = serializeNodeWithId(n, {\n        doc: this.doc,\n        map: this.mirror.map,\n        blockClass: this.blockClass,\n        blockSelector: this.blockSelector,\n        maskTextClass: this.maskTextClass,\n        maskTextSelector: this.maskTextSelector,\n        skipChild: true,\n        inlineStylesheet: this.inlineStylesheet,\n        maskInputOptions: this.maskInputOptions,\n        maskTextFn: this.maskTextFn,\n        slimDOMOptions: this.slimDOMOptions,\n        recordCanvas: this.recordCanvas,\n        onSerialize: (currentN) => {\n          if (isIframeINode(currentN)) {\n            this.iframeManager.addIframe(currentN);\n          }\n          if (hasShadowRoot(n)) {\n            this.shadowDomManager.addShadowRoot(n.shadowRoot, document);\n          }\n        },\n        onIframeLoad: (iframe, childSn) => {\n          this.iframeManager.attachIframe(iframe, childSn);\n        },\n      });\n      if (sn) {\n        adds.push({\n          parentId,\n          nextId,\n          node: sn,\n        });\n      }\n    };\n\n    while (this.mapRemoves.length) {\n      this.mirror.removeNodeFromMap(this.mapRemoves.shift() as INode);\n    }\n\n    for (const n of this.movedSet) {\n      if (\n        isParentRemoved(this.removes, n, this.mirror) &&\n        !this.movedSet.has(n.parentNode!)\n      ) {\n        continue;\n      }\n      pushAdd(n);\n    }\n\n    for (const n of this.addedSet) {\n      if (\n        !isAncestorInSet(this.droppedSet, n) &&\n        !isParentRemoved(this.removes, n, this.mirror)\n      ) {\n        pushAdd(n);\n      } else if (isAncestorInSet(this.movedSet, n)) {\n        pushAdd(n);\n      } else {\n        this.droppedSet.add(n);\n      }\n    }\n\n    let candidate: DoubleLinkedListNode | null = null;\n    while (addList.length) {\n      let node: DoubleLinkedListNode | null = null;\n      if (candidate) {\n        const parentId = this.mirror.getId(\n          (candidate.value.parentNode as Node) as INode,\n        );\n        const nextId = getNextId(candidate.value);\n        if (parentId !== -1 && nextId !== -1) {\n          node = candidate;\n        }\n      }\n      if (!node) {\n        for (let index = addList.length - 1; index >= 0; index--) {\n          const _node = addList.get(index)!;\n          const parentId = this.mirror.getId(\n            (_node.value.parentNode as Node) as INode,\n          );\n          const nextId = getNextId(_node.value);\n          if (parentId !== -1 && nextId !== -1) {\n            node = _node;\n            break;\n          }\n        }\n      }\n      if (!node) {\n        /**\n         * If all nodes in queue could not find a serialized parent,\n         * it may be a bug or corner case. We need to escape the\n         * dead while loop at once.\n         */\n        while (addList.head) {\n          addList.removeNode(addList.head.value);\n        }\n        break;\n      }\n      candidate = node.previous;\n      addList.removeNode(node.value);\n      pushAdd(node.value);\n    }\n\n    const payload = {\n      texts: this.texts\n        .map((text) => ({\n          id: this.mirror.getId(text.node as INode),\n          value: text.value,\n        }))\n        // text mutation's id was not in the mirror map means the target node has been removed\n        .filter((text) => this.mirror.has(text.id)),\n      attributes: this.attributes\n        .map((attribute) => ({\n          id: this.mirror.getId(attribute.node as INode),\n          attributes: attribute.attributes,\n        }))\n        // attribute mutation's id was not in the mirror map means the target node has been removed\n        .filter((attribute) => this.mirror.has(attribute.id)),\n      removes: this.removes,\n      adds,\n    };\n    // payload may be empty if the mutations happened in some blocked elements\n    if (\n      !payload.texts.length &&\n      !payload.attributes.length &&\n      !payload.removes.length &&\n      !payload.adds.length\n    ) {\n      return;\n    }\n\n    // reset\n    this.texts = [];\n    this.attributes = [];\n    this.removes = [];\n    this.addedSet = new Set<Node>();\n    this.movedSet = new Set<Node>();\n    this.droppedSet = new Set<Node>();\n    this.movedMap = {};\n\n    this.emissionCallback(payload);\n  };\n\n  private processMutation = (m: mutationRecord) => {\n    // console.log({ m });\n    if (isIgnored(m.target)) {\n      return;\n    }\n    switch (m.type) {\n      case 'characterData': {\n        const value = m.target.textContent;\n        if (!isBlocked(m.target, this.blockClass) && value !== m.oldValue) {\n          this.texts.push({\n            value:\n              needMaskingText(\n                m.target,\n                this.maskTextClass,\n                this.maskTextSelector,\n              ) && value\n                ? this.maskTextFn\n                  ? this.maskTextFn(value)\n                  : value.replace(/[\\S]/g, '*')\n                : value,\n            node: m.target,\n          });\n        }\n        break;\n      }\n      case 'attributes': {\n        const value = (m.target as HTMLElement).getAttribute(m.attributeName!);\n        if (isBlocked(m.target, this.blockClass) || value === m.oldValue) {\n          return;\n        }\n        let item: attributeCursor | undefined = this.attributes.find(\n          (a) => a.node === m.target,\n        );\n        if (!item) {\n          item = {\n            node: m.target,\n            attributes: {},\n          };\n          this.attributes.push(item);\n        }\n        // overwrite attribute if the mutations was triggered in same time\n        item.attributes[m.attributeName!] = transformAttribute(\n          this.doc,\n          (m.target as HTMLElement).tagName,\n          m.attributeName!,\n          value!,\n        );\n        break;\n      }\n      case 'childList': {\n        m.addedNodes.forEach((n) => this.genAdds(n, m.target));\n        m.removedNodes.forEach((n) => {\n          const nodeId = this.mirror.getId(n as INode);\n          const parentId = isShadowRoot(m.target)\n            ? this.mirror.getId((m.target.host as unknown) as INode)\n            : this.mirror.getId(m.target as INode);\n          if (\n            isBlocked(n, this.blockClass) ||\n            isBlocked(m.target, this.blockClass) ||\n            isIgnored(n)\n          ) {\n            return;\n          }\n          // removed node has not been serialized yet, just remove it from the Set\n          if (this.addedSet.has(n)) {\n            deepDelete(this.addedSet, n);\n            this.droppedSet.add(n);\n          } else if (this.addedSet.has(m.target) && nodeId === -1) {\n            /**\n             * If target was newly added and removed child node was\n             * not serialized, it means the child node has been removed\n             * before callback fired, so we can ignore it because\n             * newly added node will be serialized without child nodes.\n             * TODO: verify this\n             */\n          } else if (isAncestorRemoved(m.target as INode, this.mirror)) {\n            /**\n             * If parent id was not in the mirror map any more, it\n             * means the parent node has already been removed. So\n             * the node is also removed which we do not need to track\n             * and replay.\n             */\n          } else if (\n            this.movedSet.has(n) &&\n            this.movedMap[moveKey(nodeId, parentId)]\n          ) {\n            deepDelete(this.movedSet, n);\n          } else {\n            this.removes.push({\n              parentId,\n              id: nodeId,\n              isShadow: isShadowRoot(m.target) ? true : undefined,\n            });\n          }\n          this.mapRemoves.push(n);\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  };\n\n  private genAdds = (n: Node | INode, target?: Node | INode) => {\n    if (isBlocked(n, this.blockClass)) {\n      return;\n    }\n    if (target && isBlocked(target, this.blockClass)) {\n      return;\n    }\n    if (isINode(n)) {\n      if (isIgnored(n)) {\n        return;\n      }\n      this.movedSet.add(n);\n      let targetId: number | null = null;\n      if (target && isINode(target)) {\n        targetId = target.__sn.id;\n      }\n      if (targetId) {\n        this.movedMap[moveKey(n.__sn.id, targetId)] = true;\n      }\n    } else {\n      this.addedSet.add(n);\n      this.droppedSet.delete(n);\n    }\n    n.childNodes.forEach((childN) => this.genAdds(childN));\n  };\n}\n\n/**\n * Some utils to handle the mutation observer DOM records.\n * It should be more clear to extend the native data structure\n * like Set and Map, but currently Typescript does not support\n * that.\n */\nfunction deepDelete(addsSet: Set<Node>, n: Node) {\n  addsSet.delete(n);\n  n.childNodes.forEach((childN) => deepDelete(addsSet, childN));\n}\n\nfunction isParentRemoved(\n  removes: removedNodeMutation[],\n  n: Node,\n  mirror: Mirror,\n): boolean {\n  const { parentNode } = n;\n  if (!parentNode) {\n    return false;\n  }\n  const parentId = mirror.getId((parentNode as Node) as INode);\n  if (removes.some((r) => r.id === parentId)) {\n    return true;\n  }\n  return isParentRemoved(removes, parentNode, mirror);\n}\n\nfunction isAncestorInSet(set: Set<Node>, n: Node): boolean {\n  const { parentNode } = n;\n  if (!parentNode) {\n    return false;\n  }\n  if (set.has(parentNode)) {\n    return true;\n  }\n  return isAncestorInSet(set, parentNode);\n}\n","// tslint:disable:no-any no-bitwise forin\n/**\n * this file is used to serialize log message to string\n *\n */\n\nimport { StringifyOptions } from '../types';\n\n/**\n * transfer the node path in Event to string\n * @param node the first node in a node path array\n */\nfunction pathToSelector(node: HTMLElement): string | '' {\n  if (!node || !node.outerHTML) {\n    return '';\n  }\n\n  let path = '';\n  while (node.parentElement) {\n    let name = node.localName;\n    if (!name) {\n      break;\n    }\n    name = name.toLowerCase();\n    let parent = node.parentElement;\n\n    let domSiblings = [];\n\n    if (parent.children && parent.children.length > 0) {\n      // tslint:disable-next-line:prefer-for-of\n      for (let i = 0; i < parent.children.length; i++) {\n        let sibling = parent.children[i];\n        if (sibling.localName && sibling.localName.toLowerCase) {\n          if (sibling.localName.toLowerCase() === name) {\n            domSiblings.push(sibling);\n          }\n        }\n      }\n    }\n\n    if (domSiblings.length > 1) {\n      name += ':eq(' + domSiblings.indexOf(node) + ')';\n    }\n    path = name + (path ? '>' + path : '');\n    node = parent;\n  }\n\n  return path;\n}\n\n/**\n * stringify any js object\n * @param obj the object to stringify\n */\nexport function stringify(\n  obj: any,\n  stringifyOptions?: StringifyOptions,\n): string {\n  const options: StringifyOptions = {\n    numOfKeysLimit: 50,\n  };\n  Object.assign(options, stringifyOptions);\n  const stack: any[] = [];\n  const keys: any[] = [];\n  return JSON.stringify(obj, function (key, value) {\n    /**\n     * forked from https://github.com/moll/json-stringify-safe/blob/master/stringify.js\n     * to deCycle the object\n     */\n    if (stack.length > 0) {\n      const thisPos = stack.indexOf(this);\n      ~thisPos ? stack.splice(thisPos + 1) : stack.push(this);\n      ~thisPos ? keys.splice(thisPos, Infinity, key) : keys.push(key);\n      if (~stack.indexOf(value)) {\n        if (stack[0] === value) {\n          value = '[Circular ~]';\n        } else {\n          value =\n            '[Circular ~.' +\n            keys.slice(0, stack.indexOf(value)).join('.') +\n            ']';\n        }\n      }\n    } else {\n      stack.push(value);\n    }\n    /* END of the FORK */\n\n    if (value === null || value === undefined) {\n      return value;\n    }\n    if (shouldToString(value)) {\n      return toString(value);\n    }\n    if (value instanceof Event) {\n      const eventResult: any = {};\n      for (const eventKey in value) {\n        const eventValue = (value as any)[eventKey];\n        if (Array.isArray(eventValue)) {\n          eventResult[eventKey] = pathToSelector(\n            eventValue.length ? eventValue[0] : null,\n          );\n        } else {\n          eventResult[eventKey] = eventValue;\n        }\n      }\n      return eventResult;\n    } else if (value instanceof Node) {\n      if (value instanceof HTMLElement) {\n        return value ? value.outerHTML : '';\n      }\n      return value.nodeName;\n    }\n    return value;\n  });\n\n  /**\n   * whether we should call toString function of this object\n   */\n  function shouldToString(_obj: object): boolean {\n    if (\n      typeof _obj === 'object' &&\n      Object.keys(_obj).length > options.numOfKeysLimit\n    ) {\n      return true;\n    }\n    if (typeof _obj === 'function') {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * limit the toString() result according to option\n   */\n  function toString(_obj: object): string {\n    let str = _obj.toString();\n    if (options.stringLengthLimit && str.length > options.stringLengthLimit) {\n      str = `${str.slice(0, options.stringLengthLimit)}...`;\n    }\n    return str;\n  }\n}\n","/**\n * Class StackFrame is a fork of https://github.com/stacktracejs/stackframe/blob/master/stackframe.js\n * I fork it because:\n * 1. There are some build issues when importing this package.\n * 2. Rewrites into typescript give us a better type interface.\n * 3. StackFrame contains some functions we don't need.\n */\nexport class StackFrame {\n  private fileName: string;\n  private functionName: string;\n  private lineNumber?: number;\n  private columnNumber?: number;\n\n  constructor(obj: {\n    fileName?: string;\n    functionName?: string;\n    lineNumber?: number;\n    columnNumber?: number;\n  }) {\n    this.fileName = obj.fileName || '';\n    this.functionName = obj.functionName || '';\n    this.lineNumber = obj.lineNumber;\n    this.columnNumber = obj.columnNumber;\n  }\n\n  toString() {\n    const lineNumber = this.lineNumber || '';\n    const columnNumber = this.columnNumber || '';\n    if (this.functionName) {\n      return (\n        this.functionName +\n        ' (' +\n        this.fileName +\n        ':' +\n        lineNumber +\n        ':' +\n        columnNumber +\n        ')'\n      );\n    }\n    return this.fileName + ':' + lineNumber + ':' + columnNumber;\n  }\n}\n\n/**\n * ErrorStackParser is a fork of https://github.com/stacktracejs/error-stack-parser/blob/master/error-stack-parser.js\n * I fork it because:\n * 1. There are some build issues when importing this package.\n * 2. Rewrites into typescript give us a better type interface.\n */\nconst FIREFOX_SAFARI_STACK_REGEXP = /(^|@)\\S+:\\d+/;\nconst CHROME_IE_STACK_REGEXP = /^\\s*at .*(\\S+:\\d+|\\(native\\))/m;\nconst SAFARI_NATIVE_CODE_REGEXP = /^(eval@)?(\\[native code])?$/;\nexport const ErrorStackParser = {\n  /**\n   * Given an Error object, extract the most information from it.\n   *\n   * @param {Error} error object\n   * @return {Array} of StackFrames\n   */\n  parse: function (error: Error): StackFrame[] {\n    if (\n      // @ts-ignore\n      typeof error.stacktrace !== 'undefined' ||\n      // @ts-ignore\n      typeof error['opera#sourceloc'] !== 'undefined'\n    ) {\n      return this.parseOpera(\n        error as {\n          stacktrace?: string;\n          message: string;\n          stack?: string;\n        },\n      );\n    } else if (error.stack && error.stack.match(CHROME_IE_STACK_REGEXP)) {\n      return this.parseV8OrIE(error as { stack: string });\n    } else if (error.stack) {\n      return this.parseFFOrSafari(error as { stack: string });\n    } else {\n      throw new Error('Cannot parse given Error object');\n    }\n  },\n  // Separate line and column numbers from a string of the form: (URI:Line:Column)\n  extractLocation: function (urlLike: string) {\n    // Fail-fast but return locations like \"(native)\"\n    if (urlLike.indexOf(':') === -1) {\n      return [urlLike];\n    }\n\n    const regExp = /(.+?)(?::(\\d+))?(?::(\\d+))?$/;\n    const parts = regExp.exec(urlLike.replace(/[()]/g, ''));\n    if (!parts) throw new Error(`Cannot parse given url: ${urlLike}`);\n    return [parts[1], parts[2] || undefined, parts[3] || undefined];\n  },\n  parseV8OrIE: function (error: { stack: string }) {\n    const filtered = error.stack.split('\\n').filter(function (line) {\n      return !!line.match(CHROME_IE_STACK_REGEXP);\n    }, this);\n\n    return filtered.map(function (line) {\n      if (line.indexOf('(eval ') > -1) {\n        // Throw away eval information until we implement stacktrace.js/stackframe#8\n        line = line\n          .replace(/eval code/g, 'eval')\n          .replace(/(\\(eval at [^()]*)|(\\),.*$)/g, '');\n      }\n      let sanitizedLine = line.replace(/^\\s+/, '').replace(/\\(eval code/g, '(');\n\n      // capture and preseve the parenthesized location \"(/foo/my bar.js:12:87)\" in\n      // case it has spaces in it, as the string is split on \\s+ later on\n      const location = sanitizedLine.match(/ (\\((.+):(\\d+):(\\d+)\\)$)/);\n\n      // remove the parenthesized location from the line, if it was matched\n      sanitizedLine = location\n        ? sanitizedLine.replace(location[0], '')\n        : sanitizedLine;\n\n      const tokens = sanitizedLine.split(/\\s+/).slice(1);\n      // if a location was matched, pass it to extractLocation() otherwise pop the last token\n      const locationParts = this.extractLocation(\n        location ? location[1] : tokens.pop(),\n      );\n      const functionName = tokens.join(' ') || undefined;\n      const fileName =\n        ['eval', '<anonymous>'].indexOf(locationParts[0]) > -1\n          ? undefined\n          : locationParts[0];\n\n      return new StackFrame({\n        functionName,\n        fileName,\n        lineNumber: locationParts[1],\n        columnNumber: locationParts[2],\n      });\n    }, this);\n  },\n  parseFFOrSafari: function (error: { stack: string }) {\n    const filtered = error.stack.split('\\n').filter(function (line) {\n      return !line.match(SAFARI_NATIVE_CODE_REGEXP);\n    }, this);\n\n    return filtered.map(function (line) {\n      // Throw away eval information until we implement stacktrace.js/stackframe#8\n      if (line.indexOf(' > eval') > -1) {\n        line = line.replace(\n          / line (\\d+)(?: > eval line \\d+)* > eval:\\d+:\\d+/g,\n          ':$1',\n        );\n      }\n\n      if (line.indexOf('@') === -1 && line.indexOf(':') === -1) {\n        // Safari eval frames only have function names and nothing else\n        return new StackFrame({\n          functionName: line,\n        });\n      } else {\n        const functionNameRegex = /((.*\".+\"[^@]*)?[^@]*)(?:@)/;\n        const matches = line.match(functionNameRegex);\n        const functionName = matches && matches[1] ? matches[1] : undefined;\n        const locationParts = this.extractLocation(\n          line.replace(functionNameRegex, ''),\n        );\n\n        return new StackFrame({\n          functionName,\n          fileName: locationParts[0],\n          lineNumber: locationParts[1],\n          columnNumber: locationParts[2],\n        });\n      }\n    }, this);\n  },\n  parseOpera: function (e: {\n    stacktrace?: string;\n    message: string;\n    stack?: string;\n  }): StackFrame[] {\n    if (\n      !e.stacktrace ||\n      (e.message.indexOf('\\n') > -1 &&\n        e.message.split('\\n').length > e.stacktrace.split('\\n').length)\n    ) {\n      return this.parseOpera9(e as { message: string });\n    } else if (!e.stack) {\n      return this.parseOpera10(e as { stacktrace: string });\n    } else {\n      return this.parseOpera11(e as { stack: string });\n    }\n  },\n  parseOpera9: function (e: { message: string }) {\n    const lineRE = /Line (\\d+).*script (?:in )?(\\S+)/i;\n    const lines = e.message.split('\\n');\n    const result = [];\n\n    for (let i = 2, len = lines.length; i < len; i += 2) {\n      const match = lineRE.exec(lines[i]);\n      if (match) {\n        result.push(\n          new StackFrame({\n            fileName: match[2],\n            lineNumber: parseFloat(match[1]),\n          }),\n        );\n      }\n    }\n\n    return result;\n  },\n  parseOpera10: function (e: { stacktrace: string }) {\n    const lineRE = /Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;\n    const lines = e.stacktrace.split('\\n');\n    const result = [];\n\n    for (let i = 0, len = lines.length; i < len; i += 2) {\n      const match = lineRE.exec(lines[i]);\n      if (match) {\n        result.push(\n          new StackFrame({\n            functionName: match[3] || undefined,\n            fileName: match[2],\n            lineNumber: parseFloat(match[1]),\n          }),\n        );\n      }\n    }\n\n    return result;\n  },\n  // Opera 10.65+ Error.stack very similar to FF/Safari\n  parseOpera11: function (error: { stack: string }) {\n    const filtered = error.stack.split('\\n').filter(function (line) {\n      return (\n        !!line.match(FIREFOX_SAFARI_STACK_REGEXP) &&\n        !line.match(/^Error created at/)\n      );\n    }, this);\n\n    return filtered.map(function (line: string) {\n      const tokens = line.split('@');\n      const locationParts = this.extractLocation(tokens.pop());\n      const functionCall = tokens.shift() || '';\n      const functionName =\n        functionCall\n          .replace(/<anonymous function(: (\\w+))?>/, '$2')\n          .replace(/\\([^)]*\\)/g, '') || undefined;\n      return new StackFrame({\n        functionName,\n        fileName: locationParts[0],\n        lineNumber: locationParts[1],\n        columnNumber: locationParts[2],\n      });\n    }, this);\n  },\n};\n","// @ts-nocheck\nimport { INode, MaskInputOptions, SlimDOMOptions } from '../snapshot';\nimport { FontFaceDescriptors, FontFaceSet } from 'css-font-loading-module';\nimport {\n  throttle,\n  on,\n  hookSetter,\n  getWindowHeight,\n  getWindowWidth,\n  isBlocked,\n  isTouchEvent,\n  patch,\n} from '../utils';\nimport {\n  mutationCallBack,\n  observerParam,\n  mousemoveCallBack,\n  mousePosition,\n  mouseInteractionCallBack,\n  MouseInteractions,\n  listenerHandler,\n  scrollCallback,\n  styleSheetRuleCallback,\n  viewportResizeCallback,\n  inputValue,\n  inputCallback,\n  hookResetter,\n  blockClass,\n  maskTextClass,\n  IncrementalSource,\n  hooksParam,\n  Arguments,\n  mediaInteractionCallback,\n  MediaInteractions,\n  SamplingStrategy,\n  canvasMutationCallback,\n  fontCallback,\n  fontParam,\n  MaskInputFn,\n  MaskTextFn,\n  logCallback,\n  LogRecordOptions,\n  Logger,\n  LogLevel,\n  Mirror,\n} from '../types';\nimport MutationBuffer from './mutation';\nimport { stringify } from './stringify';\nimport { IframeManager } from './iframe-manager';\nimport { ShadowDomManager } from './shadow-dom-manager';\nimport { StackFrame, ErrorStackParser } from './error-stack-parser';\n\ntype WindowWithStoredMutationObserver = Window & {\n  __rrMutationObserver?: MutationObserver;\n};\ntype WindowWithAngularZone = Window & {\n  Zone?: {\n    __symbol__?: (key: string) => string;\n  };\n};\n\nexport const mutationBuffers: MutationBuffer[] = [];\n\nexport function initMutationObserver(\n  cb: mutationCallBack,\n  doc: Document,\n  blockClass: blockClass,\n  blockSelector: string | null,\n  maskTextClass: maskTextClass,\n  maskTextSelector: string | null,\n  inlineStylesheet: boolean,\n  maskInputOptions: MaskInputOptions,\n  maskTextFn: MaskTextFn | undefined,\n  recordCanvas: boolean,\n  slimDOMOptions: SlimDOMOptions,\n  mirror: Mirror,\n  iframeManager: IframeManager,\n  shadowDomManager: ShadowDomManager,\n  rootEl: Node,\n): MutationObserver {\n  const mutationBuffer = new MutationBuffer();\n  mutationBuffers.push(mutationBuffer);\n  // see mutation.ts for details\n  mutationBuffer.init(\n    cb,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    inlineStylesheet,\n    maskInputOptions,\n    maskTextFn,\n    recordCanvas,\n    slimDOMOptions,\n    doc,\n    mirror,\n    iframeManager,\n    shadowDomManager,\n  );\n  let mutationObserverCtor =\n    window.MutationObserver ||\n    /**\n     * Some websites may disable MutationObserver by removing it from the window object.\n     * If someone is using rrweb to build a browser extention or things like it, they\n     * could not change the website's code but can have an opportunity to inject some\n     * code before the website executing its JS logic.\n     * Then they can do this to store the native MutationObserver:\n     * window.__rrMutationObserver = MutationObserver\n     */\n    (window as WindowWithStoredMutationObserver).__rrMutationObserver;\n  const angularZoneSymbol = (window as WindowWithAngularZone)?.Zone?.__symbol__?.(\n    'MutationObserver',\n  );\n  if (\n    angularZoneSymbol &&\n    ((window as unknown) as Record<string, typeof MutationObserver>)[\n    angularZoneSymbol\n    ]\n  ) {\n    mutationObserverCtor = ((window as unknown) as Record<\n      string,\n      typeof MutationObserver\n    >)[angularZoneSymbol];\n  }\n  const observer = new mutationObserverCtor(\n    mutationBuffer.processMutations.bind(mutationBuffer),\n  );\n  observer.observe(rootEl, {\n    attributes: true,\n    attributeOldValue: true,\n    characterData: true,\n    characterDataOldValue: true,\n    childList: true,\n    subtree: true,\n  });\n  return observer;\n}\n\nfunction initMoveObserver(\n  cb: mousemoveCallBack,\n  sampling: SamplingStrategy,\n  doc: Document,\n  mirror: Mirror,\n): listenerHandler {\n  if (sampling.mousemove === false) {\n    return () => { };\n  }\n\n  const threshold =\n    typeof sampling.mousemove === 'number' ? sampling.mousemove : 50;\n  const callbackThreshold =\n    typeof sampling.mousemoveCallback === 'number'\n      ? sampling.mousemoveCallback\n      : 500;\n\n  let positions: mousePosition[] = [];\n  let timeBaseline: number | null;\n  const wrappedCb = throttle(\n    (\n      source:\n        | IncrementalSource.MouseMove\n        | IncrementalSource.TouchMove\n        | IncrementalSource.Drag,\n    ) => {\n      const totalOffset = Date.now() - timeBaseline!;\n      cb(\n        positions.map((p) => {\n          p.timeOffset -= totalOffset;\n          return p;\n        }),\n        source,\n      );\n      positions = [];\n      timeBaseline = null;\n    },\n    callbackThreshold,\n  );\n  const updatePosition = throttle<MouseEvent | TouchEvent | DragEvent>(\n    (evt) => {\n      const { target } = evt;\n      const { clientX, clientY } = isTouchEvent(evt)\n        ? evt.changedTouches[0]\n        : evt;\n      if (!timeBaseline) {\n        timeBaseline = Date.now();\n      }\n      positions.push({\n        x: clientX,\n        y: clientY,\n        id: mirror.getId(target as INode),\n        timeOffset: Date.now() - timeBaseline,\n      });\n      wrappedCb(\n        evt instanceof MouseEvent\n          ? IncrementalSource.MouseMove\n          : evt instanceof DragEvent\n            ? IncrementalSource.Drag\n            : IncrementalSource.TouchMove,\n      );\n    },\n    threshold,\n    {\n      trailing: false,\n    },\n  );\n  const handlers = [\n    on('mousemove', updatePosition, doc),\n    on('touchmove', updatePosition, doc),\n    on('drag', updatePosition, doc),\n  ];\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initMouseInteractionObserver(\n  cb: mouseInteractionCallBack,\n  doc: Document,\n  mirror: Mirror,\n  blockClass: blockClass,\n  sampling: SamplingStrategy,\n): listenerHandler {\n  if (sampling.mouseInteraction === false) {\n    return () => { };\n  }\n  const disableMap: Record<string, boolean | undefined> =\n    sampling.mouseInteraction === true ||\n      sampling.mouseInteraction === undefined\n      ? {}\n      : sampling.mouseInteraction;\n\n  const handlers: listenerHandler[] = [];\n  const getHandler = (eventKey: keyof typeof MouseInteractions) => {\n    return (event: MouseEvent | TouchEvent) => {\n      if (isBlocked(event.target as Node, blockClass)) {\n        return;\n      }\n      const e = isTouchEvent(event) ? event.changedTouches[0] : event;\n      if (!e) {\n        return;\n      }\n      const id = mirror.getId(event.target as INode);\n      const { clientX, clientY } = e;\n      cb({\n        type: MouseInteractions[eventKey],\n        id,\n        x: clientX,\n        y: clientY,\n      });\n    };\n  };\n  Object.keys(MouseInteractions)\n    .filter(\n      (key) =>\n        Number.isNaN(Number(key)) &&\n        !key.endsWith('_Departed') &&\n        disableMap[key] !== false,\n    )\n    .forEach((eventKey: keyof typeof MouseInteractions) => {\n      const eventName = eventKey.toLowerCase();\n      const handler = getHandler(eventKey);\n      handlers.push(on(eventName, handler, doc));\n    });\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initScrollObserver(\n  cb: scrollCallback,\n  doc: Document,\n  mirror: Mirror,\n  blockClass: blockClass,\n  sampling: SamplingStrategy,\n): listenerHandler {\n  const updatePosition = throttle<UIEvent>((evt) => {\n    if (!evt.target || isBlocked(evt.target as Node, blockClass)) {\n      return;\n    }\n    const id = mirror.getId(evt.target as INode);\n    if (evt.target === doc) {\n      const scrollEl = (doc.scrollingElement || doc.documentElement)!;\n      cb({\n        id,\n        x: scrollEl.scrollLeft,\n        y: scrollEl.scrollTop,\n      });\n    } else {\n      cb({\n        id,\n        x: (evt.target as HTMLElement).scrollLeft,\n        y: (evt.target as HTMLElement).scrollTop,\n      });\n    }\n  }, sampling.scroll || 100);\n  return on('scroll', updatePosition);\n}\n\nfunction initViewportResizeObserver(\n  cb: viewportResizeCallback,\n): listenerHandler {\n  let lastH = -1;\n  let lastW = -1;\n  const updateDimension = throttle(() => {\n    const height = getWindowHeight();\n    const width = getWindowWidth();\n    if (lastH !== height || lastW !== width) {\n      cb({\n        width: Number(width),\n        height: Number(height),\n      });\n      lastH = height;\n      lastW = width;\n    }\n  }, 200);\n  return on('resize', updateDimension, window);\n}\n\nexport const INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nconst lastInputValueMap: WeakMap<EventTarget, inputValue> = new WeakMap();\nfunction initInputObserver(\n  cb: inputCallback,\n  doc: Document,\n  mirror: Mirror,\n  blockClass: blockClass,\n  ignoreClass: string,\n  maskInputOptions: MaskInputOptions,\n  maskInputFn: MaskInputFn | undefined,\n  sampling: SamplingStrategy,\n): listenerHandler {\n  function eventHandler(event: Event) {\n    const { target } = event;\n    if (\n      !target ||\n      !(target as Element).tagName ||\n      INPUT_TAGS.indexOf((target as Element).tagName) < 0 ||\n      isBlocked(target as Node, blockClass)\n    ) {\n      return;\n    }\n    const type: string | undefined = (target as HTMLInputElement).type;\n    if (\n      type === 'password' ||\n      (target as HTMLElement).classList.contains(ignoreClass)\n    ) {\n      return;\n    }\n    let text = (target as HTMLInputElement).value;\n    let isChecked = false;\n    if (type === 'radio' || type === 'checkbox') {\n      isChecked = (target as HTMLInputElement).checked;\n    } else if (\n      maskInputOptions[\n      (target as Element).tagName.toLowerCase() as keyof MaskInputOptions\n      ] ||\n      maskInputOptions[type as keyof MaskInputOptions]\n    ) {\n      if (maskInputFn) {\n        text = maskInputFn(text);\n      } else {\n        text = '*'.repeat(text.length);\n      }\n    }\n    cbWithDedup(target, { text, isChecked });\n    // if a radio was checked\n    // the other radios with the same name attribute will be unchecked.\n    const name: string | undefined = (target as HTMLInputElement).name;\n    if (type === 'radio' && name && isChecked) {\n      doc\n        .querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`)\n        .forEach((el) => {\n          if (el !== target) {\n            cbWithDedup(el, {\n              text: (el as HTMLInputElement).value,\n              isChecked: !isChecked,\n            });\n          }\n        });\n    }\n  }\n  function cbWithDedup(target: EventTarget, v: inputValue) {\n    const lastInputValue = lastInputValueMap.get(target);\n    if (\n      !lastInputValue ||\n      lastInputValue.text !== v.text ||\n      lastInputValue.isChecked !== v.isChecked\n    ) {\n      lastInputValueMap.set(target, v);\n      const id = mirror.getId(target as INode);\n      cb({\n        ...v,\n        id,\n      });\n    }\n  }\n  const events = sampling.input === 'last' ? ['change'] : ['input', 'change'];\n  const handlers: Array<\n    listenerHandler | hookResetter\n  > = events.map((eventName) => on(eventName, eventHandler, doc));\n  const propertyDescriptor = Object.getOwnPropertyDescriptor(\n    HTMLInputElement.prototype,\n    'value',\n  );\n  const hookProperties: Array<[HTMLElement, string]> = [\n    [HTMLInputElement.prototype, 'value'],\n    [HTMLInputElement.prototype, 'checked'],\n    [HTMLSelectElement.prototype, 'value'],\n    [HTMLTextAreaElement.prototype, 'value'],\n    // Some UI library use selectedIndex to set select value\n    [HTMLSelectElement.prototype, 'selectedIndex'],\n  ];\n  if (propertyDescriptor && propertyDescriptor.set) {\n    handlers.push(\n      ...hookProperties.map((p) =>\n        hookSetter<HTMLElement>(p[0], p[1], {\n          set() {\n            // mock to a normal event\n            eventHandler({ target: this } as Event);\n          },\n        }),\n      ),\n    );\n  }\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initStyleSheetObserver(\n  cb: styleSheetRuleCallback,\n  mirror: Mirror,\n): listenerHandler {\n  const insertRule = CSSStyleSheet.prototype.insertRule;\n  CSSStyleSheet.prototype.insertRule = function (rule: string, index?: number) {\n    const id = mirror.getId(this.ownerNode as INode);\n    if (id !== -1) {\n      cb({\n        id,\n        adds: [{ rule, index }],\n      });\n    }\n    return insertRule.apply(this, arguments);\n  };\n\n  const deleteRule = CSSStyleSheet.prototype.deleteRule;\n  CSSStyleSheet.prototype.deleteRule = function (index: number) {\n    const id = mirror.getId(this.ownerNode as INode);\n    if (id !== -1) {\n      cb({\n        id,\n        removes: [{ index }],\n      });\n    }\n    return deleteRule.apply(this, arguments);\n  };\n\n  return () => {\n    CSSStyleSheet.prototype.insertRule = insertRule;\n    CSSStyleSheet.prototype.deleteRule = deleteRule;\n  };\n}\n\nfunction initMediaInteractionObserver(\n  mediaInteractionCb: mediaInteractionCallback,\n  blockClass: blockClass,\n  mirror: Mirror,\n): listenerHandler {\n  const handler = (type: 'play' | 'pause') => (event: Event) => {\n    const { target } = event;\n    if (!target || isBlocked(target as Node, blockClass)) {\n      return;\n    }\n    mediaInteractionCb({\n      type: type === 'play' ? MediaInteractions.Play : MediaInteractions.Pause,\n      id: mirror.getId(target as INode),\n    });\n  };\n  const handlers = [on('play', handler('play')), on('pause', handler('pause'))];\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initCanvasMutationObserver(\n  cb: canvasMutationCallback,\n  blockClass: blockClass,\n  mirror: Mirror,\n): listenerHandler {\n  const props = Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype);\n  const handlers: listenerHandler[] = [];\n  for (const prop of props) {\n    try {\n      if (\n        typeof CanvasRenderingContext2D.prototype[\n        prop as keyof CanvasRenderingContext2D\n        ] !== 'function'\n      ) {\n        continue;\n      }\n      const restoreHandler = patch(\n        CanvasRenderingContext2D.prototype,\n        prop,\n        function (original) {\n          return function (\n            this: CanvasRenderingContext2D,\n            ...args: Array<unknown>\n          ) {\n            if (!isBlocked(this.canvas, blockClass)) {\n              setTimeout(() => {\n                const recordArgs = [...args];\n                if (prop === 'drawImage') {\n                  if (\n                    recordArgs[0] &&\n                    recordArgs[0] instanceof HTMLCanvasElement\n                  ) {\n                    recordArgs[0] = recordArgs[0].toDataURL();\n                  }\n                }\n                cb({\n                  id: mirror.getId((this.canvas as unknown) as INode),\n                  property: prop,\n                  args: recordArgs,\n                });\n              }, 0);\n            }\n            return original.apply(this, args);\n          };\n        },\n      );\n      handlers.push(restoreHandler);\n    } catch {\n      const hookHandler = hookSetter<CanvasRenderingContext2D>(\n        CanvasRenderingContext2D.prototype,\n        prop,\n        {\n          set(v) {\n            cb({\n              id: mirror.getId((this.canvas as unknown) as INode),\n              property: prop,\n              args: [v],\n              setter: true,\n            });\n          },\n        },\n      );\n      handlers.push(hookHandler);\n    }\n  }\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initFontObserver(cb: fontCallback): listenerHandler {\n  const handlers: listenerHandler[] = [];\n\n  const fontMap = new WeakMap<FontFace, fontParam>();\n\n  const originalFontFace = FontFace;\n  // tslint:disable-next-line: no-any\n  (window as any).FontFace = function FontFace(\n    family: string,\n    source: string | ArrayBufferView,\n    descriptors?: FontFaceDescriptors,\n  ) {\n    const fontFace = new originalFontFace(family, source, descriptors);\n    fontMap.set(fontFace, {\n      family,\n      buffer: typeof source !== 'string',\n      descriptors,\n      fontSource:\n        typeof source === 'string'\n          ? source\n          : // tslint:disable-next-line: no-any\n          JSON.stringify(Array.from(new Uint8Array(source as any))),\n    });\n    return fontFace;\n  };\n\n  const restoreHandler = patch(document.fonts, 'add', function (original) {\n    return function (this: FontFaceSet, fontFace: FontFace) {\n      setTimeout(() => {\n        const p = fontMap.get(fontFace);\n        if (p) {\n          cb(p);\n          fontMap.delete(fontFace);\n        }\n      }, 0);\n      return original.apply(this, [fontFace]);\n    };\n  });\n\n  handlers.push(() => {\n    // tslint:disable-next-line: no-any\n    (window as any).FonFace = originalFontFace;\n  });\n  handlers.push(restoreHandler);\n\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initLogObserver(\n  cb: logCallback,\n  logOptions: LogRecordOptions,\n): listenerHandler {\n  const logger = logOptions.logger;\n  if (!logger) {\n    return () => { };\n  }\n  let logCount = 0;\n  const cancelHandlers: listenerHandler[] = [];\n  // add listener to thrown errors\n  if (logOptions.level!.includes('error')) {\n    if (window) {\n      const originalOnError = window.onerror;\n      window.onerror = (\n        msg: Event | string,\n        file: string,\n        line: number,\n        col: number,\n        error: Error,\n      ) => {\n        if (originalOnError) {\n          originalOnError.apply(this, [msg, file, line, col, error]);\n        }\n        const trace: string[] = ErrorStackParser.parse(\n          error,\n        ).map((stackFrame: StackFrame) => stackFrame.toString());\n        const payload = [stringify(msg, logOptions.stringifyOptions)];\n        cb({\n          level: 'error',\n          trace,\n          payload,\n        });\n      };\n      cancelHandlers.push(() => {\n        window.onerror = originalOnError;\n      });\n    }\n  }\n  for (const levelType of logOptions.level!) {\n    cancelHandlers.push(replace(logger, levelType));\n  }\n  return () => {\n    cancelHandlers.forEach((h) => h());\n  };\n\n  /**\n   * replace the original console function and record logs\n   * @param logger the logger object such as Console\n   * @param level the name of log function to be replaced\n   */\n  function replace(_logger: Logger, level: LogLevel) {\n    if (!_logger[level]) {\n      return () => { };\n    }\n    // replace the logger.{level}. return a restore function\n    return patch(_logger, level, (original) => {\n      return (...args: unknown[]) => {\n        original.apply(this, args);\n        try {\n          const trace = ErrorStackParser.parse(new Error())\n            .map((stackFrame: StackFrame) => stackFrame.toString())\n            .splice(1); // splice(1) to omit the hijacked log function\n          const payload = args.map((s) =>\n            stringify(s, logOptions.stringifyOptions),\n          );\n          logCount++;\n          if (logCount < logOptions.lengthThreshold!) {\n            cb({\n              level,\n              trace,\n              payload,\n            });\n          } else if (logCount === logOptions.lengthThreshold) {\n            // notify the user\n            cb({\n              level: 'warn',\n              trace: [],\n              payload: [\n                stringify('The number of log records reached the threshold.'),\n              ],\n            });\n          }\n        } catch (error) {\n          original('rrweb logger error:', error, ...args);\n        }\n      };\n    });\n  }\n}\n\nfunction mergeHooks(o: observerParam, hooks: hooksParam) {\n  const {\n    mutationCb,\n    mousemoveCb,\n    mouseInteractionCb,\n    scrollCb,\n    viewportResizeCb,\n    inputCb,\n    mediaInteractionCb,\n    styleSheetRuleCb,\n    canvasMutationCb,\n    fontCb,\n    logCb,\n  } = o;\n  o.mutationCb = (...p: Arguments<mutationCallBack>) => {\n    if (hooks.mutation) {\n      hooks.mutation(...p);\n    }\n    mutationCb(...p);\n  };\n  o.mousemoveCb = (...p: Arguments<mousemoveCallBack>) => {\n    if (hooks.mousemove) {\n      hooks.mousemove(...p);\n    }\n    mousemoveCb(...p);\n  };\n  o.mouseInteractionCb = (...p: Arguments<mouseInteractionCallBack>) => {\n    if (hooks.mouseInteraction) {\n      hooks.mouseInteraction(...p);\n    }\n    mouseInteractionCb(...p);\n  };\n  o.scrollCb = (...p: Arguments<scrollCallback>) => {\n    if (hooks.scroll) {\n      hooks.scroll(...p);\n    }\n    scrollCb(...p);\n  };\n  o.viewportResizeCb = (...p: Arguments<viewportResizeCallback>) => {\n    if (hooks.viewportResize) {\n      hooks.viewportResize(...p);\n    }\n    viewportResizeCb(...p);\n  };\n  o.inputCb = (...p: Arguments<inputCallback>) => {\n    if (hooks.input) {\n      hooks.input(...p);\n    }\n    inputCb(...p);\n  };\n  o.mediaInteractionCb = (...p: Arguments<mediaInteractionCallback>) => {\n    if (hooks.mediaInteaction) {\n      hooks.mediaInteaction(...p);\n    }\n    mediaInteractionCb(...p);\n  };\n  o.styleSheetRuleCb = (...p: Arguments<styleSheetRuleCallback>) => {\n    if (hooks.styleSheetRule) {\n      hooks.styleSheetRule(...p);\n    }\n    styleSheetRuleCb(...p);\n  };\n  o.canvasMutationCb = (...p: Arguments<canvasMutationCallback>) => {\n    if (hooks.canvasMutation) {\n      hooks.canvasMutation(...p);\n    }\n    canvasMutationCb(...p);\n  };\n  o.fontCb = (...p: Arguments<fontCallback>) => {\n    if (hooks.font) {\n      hooks.font(...p);\n    }\n    fontCb(...p);\n  };\n  o.logCb = (...p: Arguments<logCallback>) => {\n    if (hooks.log) {\n      hooks.log(...p);\n    }\n    logCb(...p);\n  };\n}\n\nexport function initObservers(\n  o: observerParam,\n  hooks: hooksParam = {},\n): listenerHandler {\n  mergeHooks(o, hooks);\n  const mutationObserver = initMutationObserver(\n    o.mutationCb,\n    o.doc,\n    o.blockClass,\n    o.blockSelector,\n    o.maskTextClass,\n    o.maskTextSelector,\n    o.inlineStylesheet,\n    o.maskInputOptions,\n    o.maskTextFn,\n    o.recordCanvas,\n    o.slimDOMOptions,\n    o.mirror,\n    o.iframeManager,\n    o.shadowDomManager,\n    o.doc,\n  );\n  const mousemoveHandler = initMoveObserver(\n    o.mousemoveCb,\n    o.sampling,\n    o.doc,\n    o.mirror,\n  );\n  const mouseInteractionHandler = initMouseInteractionObserver(\n    o.mouseInteractionCb,\n    o.doc,\n    o.mirror,\n    o.blockClass,\n    o.sampling,\n  );\n  const scrollHandler = initScrollObserver(\n    o.scrollCb,\n    o.doc,\n    o.mirror,\n    o.blockClass,\n    o.sampling,\n  );\n  const viewportResizeHandler = initViewportResizeObserver(o.viewportResizeCb);\n  const inputHandler = initInputObserver(\n    o.inputCb,\n    o.doc,\n    o.mirror,\n    o.blockClass,\n    o.ignoreClass,\n    o.maskInputOptions,\n    o.maskInputFn,\n    o.sampling,\n  );\n  const mediaInteractionHandler = initMediaInteractionObserver(\n    o.mediaInteractionCb,\n    o.blockClass,\n    o.mirror,\n  );\n  const styleSheetObserver = initStyleSheetObserver(\n    o.styleSheetRuleCb,\n    o.mirror,\n  );\n  const canvasMutationObserver = o.recordCanvas\n    ? initCanvasMutationObserver(o.canvasMutationCb, o.blockClass, o.mirror)\n    : () => { };\n  const fontObserver = o.collectFonts ? initFontObserver(o.fontCb) : () => { };\n  const logObserver = o.logOptions\n    ? initLogObserver(o.logCb, o.logOptions)\n    : () => { };\n\n  return () => {\n    mutationObserver.disconnect();\n    mousemoveHandler();\n    mouseInteractionHandler();\n    scrollHandler();\n    viewportResizeHandler();\n    inputHandler();\n    mediaInteractionHandler();\n    styleSheetObserver();\n    canvasMutationObserver();\n    fontObserver();\n    logObserver();\n  };\n}\n","import { serializedNodeWithId, INode } from '../snapshot';\nimport { mutationCallBack } from '../types';\n\nexport class IframeManager {\n  private iframes: WeakMap<HTMLIFrameElement, true> = new WeakMap();\n  private mutationCb: mutationCallBack;\n  private loadListener?: (iframeEl: HTMLIFrameElement) => unknown;\n\n  constructor(options: { mutationCb: mutationCallBack }) {\n    this.mutationCb = options.mutationCb;\n  }\n\n  public addIframe(iframeEl: HTMLIFrameElement) {\n    this.iframes.set(iframeEl, true);\n  }\n\n  public addLoadListener(cb: (iframeEl: HTMLIFrameElement) => unknown) {\n    this.loadListener = cb;\n  }\n\n  public attachIframe(iframeEl: INode, childSn: serializedNodeWithId) {\n    this.mutationCb({\n      adds: [\n        {\n          parentId: iframeEl.__sn.id,\n          nextId: null,\n          node: childSn,\n        },\n      ],\n      removes: [],\n      texts: [],\n      attributes: [],\n      isAttachIframe: true,\n    });\n    this.loadListener?.((iframeEl as unknown) as HTMLIFrameElement);\n  }\n}\n","import {\n  mutationCallBack,\n  blockClass,\n  maskTextClass,\n  MaskTextFn,\n  Mirror,\n} from '../types';\nimport { MaskInputOptions, SlimDOMOptions } from '../snapshot';\nimport { IframeManager } from './iframe-manager';\nimport { initMutationObserver } from './observer';\n\ntype BypassOptions = {\n  blockClass: blockClass;\n  blockSelector: string | null;\n  maskTextClass: maskTextClass;\n  maskTextSelector: string | null;\n  inlineStylesheet: boolean;\n  maskInputOptions: MaskInputOptions;\n  maskTextFn: MaskTextFn | undefined;\n  recordCanvas: boolean;\n  slimDOMOptions: SlimDOMOptions;\n  iframeManager: IframeManager;\n};\n\nexport class ShadowDomManager {\n  private mutationCb: mutationCallBack;\n  private bypassOptions: BypassOptions;\n  private mirror: Mirror;\n\n  constructor(options: {\n    mutationCb: mutationCallBack;\n    bypassOptions: BypassOptions;\n    mirror: Mirror;\n  }) {\n    this.mutationCb = options.mutationCb;\n    this.bypassOptions = options.bypassOptions;\n    this.mirror = options.mirror;\n  }\n\n  public addShadowRoot(shadowRoot: ShadowRoot, doc: Document) {\n    initMutationObserver(\n      this.mutationCb,\n      doc,\n      this.bypassOptions.blockClass,\n      this.bypassOptions.blockSelector,\n      this.bypassOptions.maskTextClass,\n      this.bypassOptions.maskTextSelector,\n      this.bypassOptions.inlineStylesheet,\n      this.bypassOptions.maskInputOptions,\n      this.bypassOptions.maskTextFn,\n      this.bypassOptions.recordCanvas,\n      this.bypassOptions.slimDOMOptions,\n      this.mirror,\n      this.bypassOptions.iframeManager,\n      this,\n      shadowRoot,\n    );\n  }\n}\n","import { snapshot, MaskInputOptions, SlimDOMOptions } from '../snapshot';\nimport { initObservers, mutationBuffers } from './observer';\nimport {\n  on,\n  getWindowWidth,\n  getWindowHeight,\n  polyfill,\n  isIframeINode,\n  hasShadowRoot,\n  createMirror,\n} from '../utils';\nimport {\n  EventType,\n  event,\n  eventWithTime,\n  recordOptions,\n  IncrementalSource,\n  listenerHandler,\n  LogRecordOptions,\n  mutationCallbackParam,\n} from '../types';\nimport { IframeManager } from './iframe-manager';\nimport { ShadowDomManager } from './shadow-dom-manager';\n\nfunction wrapEvent(e: event): eventWithTime {\n  return {\n    ...e,\n    timestamp: Date.now(),\n  };\n}\n\nlet wrappedEmit!: (e: eventWithTime, isCheckout?: boolean) => void;\n\nlet takeFullSnapshot!: (isCheckout?: boolean) => void;\n\nconst mirror = createMirror();\nfunction record<T = eventWithTime>(\n  options: recordOptions<T> = {},\n): listenerHandler | undefined {\n  const {\n    emit,\n    checkoutEveryNms,\n    checkoutEveryNth,\n    blockClass = 'rr-block',\n    blockSelector = null,\n    ignoreClass = 'rr-ignore',\n    maskTextClass = 'rr-mask',\n    maskTextSelector = null,\n    inlineStylesheet = true,\n    maskAllInputs,\n    maskInputOptions: _maskInputOptions,\n    slimDOMOptions: _slimDOMOptions,\n    maskInputFn,\n    maskTextFn,\n    hooks,\n    packFn,\n    sampling = {},\n    mousemoveWait,\n    recordCanvas = false,\n    collectFonts = false,\n    recordLog = false,\n  } = options;\n  // runtime checks for user options\n  if (!emit) {\n    throw new Error('emit function is required');\n  }\n  // move departed options to new options\n  if (mousemoveWait !== undefined && sampling.mousemove === undefined) {\n    sampling.mousemove = mousemoveWait;\n  }\n\n  const maskInputOptions: MaskInputOptions =\n    maskAllInputs === true\n      ? {\n          color: true,\n          date: true,\n          'datetime-local': true,\n          email: true,\n          month: true,\n          number: true,\n          range: true,\n          search: true,\n          tel: true,\n          text: true,\n          time: true,\n          url: true,\n          week: true,\n          textarea: true,\n          select: true,\n        }\n      : _maskInputOptions !== undefined\n      ? _maskInputOptions\n      : {};\n\n  const slimDOMOptions: SlimDOMOptions =\n    _slimDOMOptions === true || _slimDOMOptions === 'all'\n      ? {\n          script: true,\n          comment: true,\n          headFavicon: true,\n          headWhitespace: true,\n          headMetaSocial: true,\n          headMetaRobots: true,\n          headMetaHttpEquiv: true,\n          headMetaVerification: true,\n          // the following are off for slimDOMOptions === true,\n          // as they destroy some (hidden) info:\n          headMetaAuthorship: _slimDOMOptions === 'all',\n          headMetaDescKeywords: _slimDOMOptions === 'all',\n        }\n      : _slimDOMOptions\n      ? _slimDOMOptions\n      : {};\n  const defaultLogOptions: LogRecordOptions = {\n    level: [\n      'assert',\n      'clear',\n      'count',\n      'countReset',\n      'debug',\n      'dir',\n      'dirxml',\n      // 'error',\n      'group',\n      'groupCollapsed',\n      'groupEnd',\n      'info',\n      'log',\n      'table',\n      'time',\n      'timeEnd',\n      'timeLog',\n      'trace',\n      'warn',\n    ],\n    lengthThreshold: 1000,\n    logger: console,\n  };\n\n  const logOptions: LogRecordOptions = recordLog\n    ? recordLog === true\n      ? defaultLogOptions\n      : Object.assign({}, defaultLogOptions, recordLog)\n    : {};\n\n  polyfill();\n\n  let lastFullSnapshotEvent: eventWithTime;\n  let incrementalSnapshotCount = 0;\n  wrappedEmit = (e: eventWithTime, isCheckout?: boolean) => {\n    if (\n      mutationBuffers[0]?.isFrozen() &&\n      e.type !== EventType.FullSnapshot &&\n      !(\n        e.type === EventType.IncrementalSnapshot &&\n        e.data.source === IncrementalSource.Mutation\n      )\n    ) {\n      // we've got a user initiated event so first we need to apply\n      // all DOM changes that have been buffering during paused state\n      mutationBuffers.forEach((buf) => buf.unfreeze());\n    }\n\n    emit(((packFn ? packFn(e) : e) as unknown) as T, isCheckout);\n    if (e.type === EventType.FullSnapshot) {\n      lastFullSnapshotEvent = e;\n      incrementalSnapshotCount = 0;\n    } else if (e.type === EventType.IncrementalSnapshot) {\n      // attch iframe should be considered as full snapshot\n      if (\n        e.data.source === IncrementalSource.Mutation &&\n        e.data.isAttachIframe\n      ) {\n        return;\n      }\n\n      incrementalSnapshotCount++;\n      const exceedCount =\n        checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\n      const exceedTime =\n        checkoutEveryNms &&\n        e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\n      if (exceedCount || exceedTime) {\n        takeFullSnapshot(true);\n      }\n    }\n  };\n\n  const wrappedMutationEmit = (m: mutationCallbackParam) => {\n    wrappedEmit(\n      wrapEvent({\n        type: EventType.IncrementalSnapshot,\n        data: {\n          source: IncrementalSource.Mutation,\n          ...m,\n        },\n      }),\n    );\n  };\n\n  const iframeManager = new IframeManager({\n    mutationCb: wrappedMutationEmit,\n  });\n\n  const shadowDomManager = new ShadowDomManager({\n    mutationCb: wrappedMutationEmit,\n    bypassOptions: {\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      inlineStylesheet,\n      maskInputOptions,\n      maskTextFn,\n      recordCanvas,\n      slimDOMOptions,\n      iframeManager,\n    },\n    mirror,\n  });\n\n  takeFullSnapshot = (isCheckout = false) => {\n    wrappedEmit(\n      wrapEvent({\n        type: EventType.Meta,\n        data: {\n          href: window.location.href,\n          width: getWindowWidth(),\n          height: getWindowHeight(),\n        },\n      }),\n      isCheckout,\n    );\n\n    mutationBuffers.forEach((buf) => buf.lock()); // don't allow any mirror modifications during snapshotting\n    const [node, idNodeMap] = snapshot(document, {\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      inlineStylesheet,\n      maskAllInputs: maskInputOptions,\n      maskTextFn,\n      slimDOM: slimDOMOptions,\n      recordCanvas,\n      onSerialize: (n) => {\n        if (isIframeINode(n)) {\n          iframeManager.addIframe(n);\n        }\n        if (hasShadowRoot(n)) {\n          shadowDomManager.addShadowRoot(n.shadowRoot, document);\n        }\n      },\n      onIframeLoad: (iframe, childSn) => {\n        iframeManager.attachIframe(iframe, childSn);\n      },\n    });\n\n    if (!node) {\n      return console.warn('Failed to snapshot the document');\n    }\n\n    mirror.map = idNodeMap;\n    wrappedEmit(\n      wrapEvent({\n        type: EventType.FullSnapshot,\n        data: {\n          node,\n          initialOffset: {\n            left:\n              window.pageXOffset !== undefined\n                ? window.pageXOffset\n                : document?.documentElement.scrollLeft ||\n                  document?.body?.parentElement?.scrollLeft ||\n                  document?.body.scrollLeft ||\n                  0,\n            top:\n              window.pageYOffset !== undefined\n                ? window.pageYOffset\n                : document?.documentElement.scrollTop ||\n                  document?.body?.parentElement?.scrollTop ||\n                  document?.body.scrollTop ||\n                  0,\n          },\n        },\n      }),\n    );\n    mutationBuffers.forEach((buf) => buf.unlock()); // generate & emit any mutations that happened during snapshotting, as can now apply against the newly built mirror\n  };\n\n  try {\n    const handlers: listenerHandler[] = [];\n    handlers.push(\n      on('DOMContentLoaded', () => {\n        wrappedEmit(\n          wrapEvent({\n            type: EventType.DomContentLoaded,\n            data: {},\n          }),\n        );\n      }),\n    );\n\n    const observe = (doc: Document) => {\n      return initObservers(\n        {\n          mutationCb: wrappedMutationEmit,\n          mousemoveCb: (positions, source) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source,\n                  positions,\n                },\n              }),\n            ),\n          mouseInteractionCb: (d) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.MouseInteraction,\n                  ...d,\n                },\n              }),\n            ),\n          scrollCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Scroll,\n                  ...p,\n                },\n              }),\n            ),\n          viewportResizeCb: (d) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.ViewportResize,\n                  ...d,\n                },\n              }),\n            ),\n          inputCb: (v) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Input,\n                  ...v,\n                },\n              }),\n            ),\n          mediaInteractionCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.MediaInteraction,\n                  ...p,\n                },\n              }),\n            ),\n          styleSheetRuleCb: (r) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.StyleSheetRule,\n                  ...r,\n                },\n              }),\n            ),\n          canvasMutationCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.CanvasMutation,\n                  ...p,\n                },\n              }),\n            ),\n          fontCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Font,\n                  ...p,\n                },\n              }),\n            ),\n          logCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Log,\n                  ...p,\n                },\n              }),\n            ),\n          blockClass,\n          ignoreClass,\n          maskTextClass,\n          maskTextSelector,\n          maskInputOptions,\n          inlineStylesheet,\n          sampling,\n          recordCanvas,\n          collectFonts,\n          doc,\n          maskInputFn,\n          maskTextFn,\n          logOptions,\n          blockSelector,\n          slimDOMOptions,\n          mirror,\n          iframeManager,\n          shadowDomManager,\n        },\n        hooks,\n      );\n    };\n\n    iframeManager.addLoadListener((iframeEl) => {\n      handlers.push(observe(iframeEl.contentDocument!));\n    });\n\n    const init = () => {\n      takeFullSnapshot();\n      handlers.push(observe(document));\n    };\n    if (\n      document.readyState === 'interactive' ||\n      document.readyState === 'complete'\n    ) {\n      init();\n    } else {\n      handlers.push(\n        on(\n          'load',\n          () => {\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.Load,\n                data: {},\n              }),\n            );\n            init();\n          },\n          window,\n        ),\n      );\n    }\n    return () => {\n      handlers.forEach((h) => h());\n    };\n  } catch (error) {\n    // TODO: handle internal error\n    console.warn(error);\n  }\n}\n\nrecord.addCustomEvent = <T>(tag: string, payload: T) => {\n  if (!wrappedEmit) {\n    throw new Error('please add custom event after start recording');\n  }\n  wrappedEmit(\n    wrapEvent({\n      type: EventType.Custom,\n      data: {\n        tag,\n        payload,\n      },\n    }),\n  );\n};\n\nrecord.freezePage = () => {\n  mutationBuffers.forEach((buf) => buf.freeze());\n};\n\nrecord.takeFullSnapshot = (isCheckout?: boolean) => {\n  if (!takeFullSnapshot) {\n    throw new Error('please take full snapshot after start recording');\n  }\n  takeFullSnapshot(isCheckout);\n};\n\nrecord.mirror = mirror;\n\nexport default record;\n","// @ts-nocheck\n// Mediocre shim\nlet Worker: typeof import('worker_threads').Worker;\nconst workerAdd = \";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global\";\n\ntry {\n  Worker = require('worker_threads').Worker;\n} catch(e) {\n}\nexport default Worker ? <T>(c: string, _: number, msg: unknown, transfer: ArrayBuffer[], cb: (err: Error, msg: T) => void) => {\n  let done = false;\n  const w = new Worker(c + workerAdd, { eval: true })\n    .on('error', e => cb(e, null))\n    .on('message', m => cb(null, m))\n    .on('exit', c => {\n      if (c && !done) cb(new Error('exited with code ' + c), null);\n    });\n  w.postMessage(msg, transfer);\n  w.terminate = () => {\n    done = true;\n    return Worker.prototype.terminate.call(w);\n  }\n  return w;\n} : (_: string, __: number, ___: unknown, ____: ArrayBuffer[], cb: (err: Error, msg: null) => void) => {\n  setImmediate(() => cb(new Error('async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)'), null));\n  const NOP = () => {};\n  return {\n    terminate: NOP,\n    postMessage: NOP\n  } as unknown as import('worker_threads').Worker;\n}","// @ts-nocheck\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\n\nimport wk from './node-worker';\n\n// aliases for shorter compressed code (most minifers don't do this)\nconst u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n\n// fixed length extra bits\nconst fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n\n// fixed distance extra bits\n// see fleb note\nconst fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n\n// code length index map\nconst clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n\n// get base, reverse index map from extra bits\nconst freb = (eb: Uint8Array, start: number) => {\n  const b = new u16(31);\n  for (let i = 0; i < 31; ++i) {\n    b[i] = start += 1 << eb[i - 1];\n  }\n  // numbers here are at max 18 bits\n  const r = new u32(b[30]);\n  for (let i = 1; i < 30; ++i) {\n    for (let j = b[i]; j < b[i + 1]; ++j) {\n      r[j] = ((j - b[i]) << 5) | i;\n    }\n  }\n  return [b, r] as const;\n}\n\nconst [fl, revfl] = freb(fleb, 2);\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nconst [fd, revfd] = freb(fdeb, 0);\n\n// map of value to reverse (assuming 16 bits)\nconst rev = new u16(32768);\nfor (let i = 0; i < 32768; ++i) {\n  // reverse table algorithm from SO\n  let x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n  x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n  x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n  rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nconst hMap = ((cd: Uint8Array, mb: number, r: 0 | 1) => {\n  const s = cd.length;\n  // index\n  let i = 0;\n  // u16 \"map\": index -> # of codes with bit length = index\n  const l = new u16(mb);\n  // length of cd must be 288 (total # of codes)\n  for (; i < s; ++i) ++l[cd[i] - 1];\n  // u16 \"map\": index -> minimum code for bit length = index\n  const le = new u16(mb);\n  for (i = 0; i < mb; ++i) {\n    le[i] = (le[i - 1] + l[i - 1]) << 1;\n  }\n  let co: Uint16Array;\n  if (r) {\n    // u16 \"map\": index -> number of actual bits, symbol for code\n    co = new u16(1 << mb);\n    // bits to remove for reverser\n    const rvb = 15 - mb;\n    for (i = 0; i < s; ++i) {\n      // ignore 0 lengths\n      if (cd[i]) {\n        // num encoding both symbol and bits read\n        const sv = (i << 4) | cd[i];\n        // free bits\n        const r = mb - cd[i];\n        // start value\n        let v = le[cd[i] - 1]++ << r;\n        // m is end value\n        for (const m = v | ((1 << r) - 1); v <= m; ++v) {\n          // every 16 bit value starting with the code yields the same result\n          co[rev[v] >>> rvb] = sv;\n        }\n      }\n    }\n  } else {\n    co = new u16(s);\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n      }\n    }\n  }\n  return co;\n});\n\n// fixed length tree\nconst flt = new u8(288);\nfor (let i = 0; i < 144; ++i) flt[i] = 8;\nfor (let i = 144; i < 256; ++i) flt[i] = 9;\nfor (let i = 256; i < 280; ++i) flt[i] = 7;\nfor (let i = 280; i < 288; ++i) flt[i] = 8;\n// fixed distance tree\nconst fdt = new u8(32);\nfor (let i = 0; i < 32; ++i) fdt[i] = 5;\n// fixed length map\nconst flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nconst fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n\n// find max of array\nconst max = (a: Uint8Array | number[]) => {\n  let m = a[0];\n  for (let i = 1; i < a.length; ++i) {\n    if (a[i] > m) m = a[i];\n  }\n  return m;\n};\n\n// read d, starting at bit p and mask with m\nconst bits = (d: Uint8Array, p: number, m: number) => {\n  const o = (p / 8) | 0;\n  return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n}\n\n// read d, starting at bit p continuing for at least 16 bits\nconst bits16 = (d: Uint8Array, p: number) => {\n  const o = (p / 8) | 0;\n  return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n}\n\n// get end of byte\nconst shft = (p: number) => ((p / 8) | 0) + (p & 7 && 1);\n\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nconst slc = <T extends Uint8Array | Uint16Array | Uint32Array>(v: T, s: number, e?: number): T => {\n  if (s == null || s < 0) s = 0;\n  if (e == null || e > v.length) e = v.length;\n  // can't use .constructor in case user-supplied\n  const n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s) as T;\n  n.set(v.subarray(s, e));\n  return n;\n}\n\n// inflate state\ntype InflateState = {\n  // lmap\n  l?: Uint16Array;\n  // dmap\n  d?: Uint16Array;\n  // lbits\n  m?: number;\n  // dbits\n  n?: number;\n  // final\n  f?: number;\n  // pos\n  p?: number;\n  // byte\n  b?: number;\n  // lstchk\n  i?: boolean;\n};\n\n/**\n * Codes for errors generated within this library\n */\nexport const FlateErrorCode = {\n  UnexpectedEOF: 0,\n  InvalidBlockType: 1,\n  InvalidLengthLiteral: 2,\n  InvalidDistance: 3,\n  StreamFinished: 4,\n  NoStreamHandler: 5,\n  InvalidHeader: 6,\n  NoCallback: 7,\n  InvalidUTF8: 8,\n  ExtraFieldTooLong: 9,\n  InvalidDate: 10,\n  FilenameTooLong: 11,\n  StreamFinishing: 12,\n  InvalidZipData: 13,\n  UnknownCompressionMethod: 14\n} as const;\n\n// error codes\nconst ec = [\n  'unexpected EOF',\n  'invalid block type',\n  'invalid length/literal',\n  'invalid distance',\n  'stream finished',\n  'no stream handler',\n  , // determined by compression function\n  'no callback',\n  'invalid UTF-8 data',\n  'extra field too long',\n  'date not in range 1980-2099',\n  'filename too long',\n  'stream finishing',\n  'invalid zip data'\n  // determined by unknown compression method\n];\n\n/**\n * An error generated within this library\n */\nexport interface FlateError extends Error {\n  /**\n   * The code associated with this error\n   */\n  code: number;\n};\n\nconst err = (ind: number, msg?: string | 0, nt?: 1) => {\n  const e: Partial<FlateError> = new Error(msg || ec[ind]);\n  e.code = ind;\n  if (Error.captureStackTrace) Error.captureStackTrace(e, err);\n  if (!nt) throw e;\n  return e as FlateError;\n}\n\n// expands raw DEFLATE data\nconst inflt = (dat: Uint8Array, buf?: Uint8Array, st?: InflateState) => {\n  // source length\n  const sl = dat.length;\n  if (!sl || (st && !st.l && sl < 5)) return buf || new u8(0);\n  // have to estimate size\n  const noBuf = !buf || (st as unknown as boolean);\n  // no state\n  const noSt = !st || st.i;\n  if (!st) st = {};\n  // Assumes roughly 33% compression ratio average\n  if (!buf) buf = new u8(sl * 3);\n  // ensure buffer can fit at least l elements\n  const cbuf = (l: number) => {\n    let bl = buf.length;\n    // need to increase size to fit\n    if (l > bl) {\n      // Double or set to necessary, whichever is greater\n      const nbuf = new u8(Math.max(bl * 2, l));\n      nbuf.set(buf);\n      buf = nbuf;\n    }\n  };\n  //  last chunk         bitpos           bytes\n  let final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n  // total bits\n  const tbts = sl * 8;\n  do {\n    if (!lm) {\n      // BFINAL - this is only 1 when last chunk is next\n      st.f = final = bits(dat, pos, 1);\n      // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n      const type = bits(dat, pos + 1, 3);\n      pos += 3;\n      if (!type) {\n        // go to end of byte boundary\n        const s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n        if (t > sl) {\n          if (noSt) err(0);\n          break;\n        }\n        // ensure size\n        if (noBuf) cbuf(bt + l);\n        // Copy over uncompressed data\n        buf.set(dat.subarray(s, t), bt);\n        // Get new bitpos, update byte count\n        st.b = bt += l, st.p = pos = t * 8;\n        continue;\n      }\n      else if (type == 1) lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n      else if (type == 2) {\n        //  literal                            lengths\n        const hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n        const tl = hLit + bits(dat, pos + 5, 31) + 1;\n        pos += 14;\n        // length+distance tree\n        const ldt = new u8(tl);\n        // code length tree\n        const clt = new u8(19);\n        for (let i = 0; i < hcLen; ++i) {\n          // use index map to get real code\n          clt[clim[i]] = bits(dat, pos + i * 3, 7);\n        }\n        pos += hcLen * 3;\n        // code lengths bits\n        const clb = max(clt), clbmsk = (1 << clb) - 1;\n        // code lengths map\n        const clm = hMap(clt, clb, 1);\n        for (let i = 0; i < tl;) {\n          const r = clm[bits(dat, pos, clbmsk)];\n          // bits read\n          pos += r & 15;\n          // symbol\n          const s = r >>> 4;\n          // code length to copy\n          if (s < 16) {\n            ldt[i++] = s;\n          } else {\n            //  copy   count\n            let c = 0, n = 0;\n            if (s == 16) n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n            else if (s == 17) n = 3 + bits(dat, pos, 7), pos += 3;\n            else if (s == 18) n = 11 + bits(dat, pos, 127), pos += 7;\n            while (n--) ldt[i++] = c;\n          }\n        }\n        //    length tree                 distance tree\n        const lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n        // max length bits\n        lbt = max(lt)\n        // max dist bits\n        dbt = max(dt);\n        lm = hMap(lt, lbt, 1);\n        dm = hMap(dt, dbt, 1);\n      } else err(1);\n      if (pos > tbts) {\n        if (noSt) err(0);\n        break;\n      }\n    }\n    // Make sure the buffer can hold this + the largest possible addition\n    // Maximum chunk size (practically, theoretically infinite) is 2^17;\n    if (noBuf) cbuf(bt + 131072);\n    const lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n    let lpos = pos;\n    for (;; lpos = pos) {\n      // bits read, code\n      const c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n      pos += c & 15;\n      if (pos > tbts) {\n        if (noSt) err(0);\n        break;\n      }\n      if (!c) err(2);\n      if (sym < 256) buf[bt++] = sym;\n      else if (sym == 256) {\n        lpos = pos, lm = null;\n        break;\n      } else {\n        let add = sym - 254;\n        // no extra bits needed if less\n        if (sym > 264) {\n          // index\n          const i = sym - 257, b = fleb[i];\n          add = bits(dat, pos, (1 << b) - 1) + fl[i];\n          pos += b;\n        }\n        // dist\n        const d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n        if (!d) err(3);\n        pos += d & 15;\n        let dt = fd[dsym];\n        if (dsym > 3) {\n          const b = fdeb[dsym];\n          dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n        }\n        if (pos > tbts) {\n          if (noSt) err(0);\n          break;\n        }\n        if (noBuf) cbuf(bt + 131072);\n        const end = bt + add;\n        for (; bt < end; bt += 4) {\n          buf[bt] = buf[bt - dt];\n          buf[bt + 1] = buf[bt + 1 - dt];\n          buf[bt + 2] = buf[bt + 2 - dt];\n          buf[bt + 3] = buf[bt + 3 - dt];\n        }\n        bt = end;\n      }\n    }\n    st.l = lm, st.p = lpos, st.b = bt;\n    if (lm) final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n  } while (!final)\n  return bt == buf.length ? buf : slc(buf, 0, bt);\n}\n\n// starting at p, write the minimum number of bits that can hold v to d\nconst wbits = (d: Uint8Array, p: number, v: number) => {\n  v <<= p & 7;\n  const o = (p / 8) | 0;\n  d[o] |= v;\n  d[o + 1] |= v >>> 8;\n}\n\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nconst wbits16 = (d: Uint8Array, p: number, v: number) => {\n  v <<= p & 7;\n  const o = (p / 8) | 0;\n  d[o] |= v;\n  d[o + 1] |= v >>> 8;\n  d[o + 2] |= v >>> 16;\n}\n\ntype HuffNode = {\n  // symbol\n  s: number;\n  // frequency\n  f: number;\n  // left child\n  l?: HuffNode;\n  // right child\n  r?: HuffNode;\n};\n\n// creates code lengths from a frequency table\nconst hTree = (d: Uint16Array, mb: number) => {\n  // Need extra info to make a tree\n  const t: HuffNode[] = [];\n  for (let i = 0; i < d.length; ++i) {\n    if (d[i]) t.push({ s: i, f: d[i] });\n  }\n  const s = t.length;\n  const t2 = t.slice();\n  if (!s) return [et, 0] as const;\n  if (s == 1) {\n    const v = new u8(t[0].s + 1);\n    v[t[0].s] = 1;\n    return [v, 1] as const;\n  }\n  t.sort((a, b) => a.f - b.f);\n  // after i2 reaches last ind, will be stopped\n  // freq must be greater than largest possible number of symbols\n  t.push({ s: -1, f: 25001 });\n  let l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n  t[0] = { s: -1, f: l.f + r.f, l, r };\n  // efficient algorithm from UZIP.js\n  // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n  // symbols that combined have high freq, will start processing i2 (high-freq,\n  // non-composite) symbols instead\n  // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n  while (i1 != s - 1) {\n    l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n    r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n    t[i1++] = { s: -1, f: l.f + r.f, l, r };\n  }\n  let maxSym = t2[0].s;\n  for (let i = 1; i < s; ++i) {\n    if (t2[i].s > maxSym) maxSym = t2[i].s;\n  }\n  // code lengths\n  const tr = new u16(maxSym + 1);\n  // max bits in tree\n  let mbt = ln(t[i1 - 1], tr, 0);\n  if (mbt > mb) {\n    // more algorithms from UZIP.js\n    // TODO: find out how this code works (debt)\n    //  ind    debt\n    let i = 0, dt = 0;\n    //    left            cost\n    const lft = mbt - mb, cst = 1 << lft;\n    t2.sort((a, b) => tr[b.s] - tr[a.s] || a.f - b.f);\n    for (; i < s; ++i) {\n      const i2 = t2[i].s;\n      if (tr[i2] > mb) {\n        dt += cst - (1 << (mbt - tr[i2]));\n        tr[i2] = mb;\n      } else break;\n    }\n    dt >>>= lft;\n    while (dt > 0) {\n      const i2 = t2[i].s;\n      if (tr[i2] < mb) dt -= 1 << (mb - tr[i2]++ - 1);\n      else ++i;\n    }\n    for (; i >= 0 && dt; --i) {\n      const i2 = t2[i].s;\n      if (tr[i2] == mb) {\n        --tr[i2];\n        ++dt;\n      }\n    }\n    mbt = mb;\n  }\n  return [new u8(tr), mbt] as const;\n}\n// get the max length and assign length codes\nconst ln = (n: HuffNode, l: Uint16Array, d: number): number => {\n  return n.s == -1\n    ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n    : (l[n.s] = d);\n}\n\n// length codes generation\nconst lc = (c: Uint8Array) => {\n  let s = c.length;\n  // Note that the semicolon was intentional\n  while (s && !c[--s]);\n  const cl = new u16(++s);\n  //  ind      num         streak\n  let cli = 0, cln = c[0], cls = 1;\n  const w = (v: number) => { cl[cli++] = v; }\n  for (let i = 1; i <= s; ++i) {\n    if (c[i] == cln && i != s)\n      ++cls;\n    else {\n      if (!cln && cls > 2) {\n        for (; cls > 138; cls -= 138) w(32754);\n        if (cls > 2) {\n          w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n          cls = 0;\n        }\n      } else if (cls > 3) {\n        w(cln), --cls;\n        for (; cls > 6; cls -= 6) w(8304);\n        if (cls > 2) w(((cls - 3) << 5) | 8208), cls = 0;\n      }\n      while (cls--) w(cln);\n      cls = 1;\n      cln = c[i];\n    }\n  }\n  return [cl.subarray(0, cli), s] as const;\n}\n\n// calculate the length of output from tree, code lengths\nconst clen = (cf: Uint16Array, cl: Uint8Array) => {\n  let l = 0;\n  for (let i = 0; i < cl.length; ++i) l += cf[i] * cl[i];\n  return l;\n}\n\n// writes a fixed block\n// returns the new bit pos\nconst wfblk = (out: Uint8Array, pos: number, dat: Uint8Array) => {\n  // no need to write 00 as type: TypedArray defaults to 0\n  const s = dat.length;\n  const o = shft(pos + 2);\n  out[o] = s & 255;\n  out[o + 1] = s >>> 8;\n  out[o + 2] = out[o] ^ 255;\n  out[o + 3] = out[o + 1] ^ 255;\n  for (let i = 0; i < s; ++i) out[o + i + 4] = dat[i];\n  return (o + 4 + s) * 8;\n}\n\n// writes a block\nconst wblk = (dat: Uint8Array, out: Uint8Array, final: number, syms: Uint32Array, lf: Uint16Array, df: Uint16Array, eb: number, li: number, bs: number, bl: number, p: number) => {\n  wbits(out, p++, final);\n  ++lf[256];\n  const [dlt, mlb] = hTree(lf, 15);\n  const [ddt, mdb] = hTree(df, 15);\n  const [lclt, nlc] = lc(dlt);\n  const [lcdt, ndc] = lc(ddt);\n  const lcfreq = new u16(19);\n  for (let i = 0; i < lclt.length; ++i) lcfreq[lclt[i] & 31]++;\n  for (let i = 0; i < lcdt.length; ++i) lcfreq[lcdt[i] & 31]++;\n  const [lct, mlcb] = hTree(lcfreq, 7);\n  let nlcc = 19;\n  for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc);\n  const flen = (bl + 5) << 3;\n  const ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n  const dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n  if (flen <= ftlen && flen <= dtlen) return wfblk(out, p, dat.subarray(bs, bs + bl));\n  let lm: Uint16Array, ll: Uint8Array, dm: Uint16Array, dl: Uint8Array;\n  wbits(out, p, 1 + (dtlen < ftlen as unknown as number)), p += 2;\n  if (dtlen < ftlen) {\n    lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n    const llm = hMap(lct, mlcb, 0);\n    wbits(out, p, nlc - 257);\n    wbits(out, p + 5, ndc - 1);\n    wbits(out, p + 10, nlcc - 4);\n    p += 14;\n    for (let i = 0; i < nlcc; ++i) wbits(out, p + 3 * i, lct[clim[i]]);\n    p += 3 * nlcc;\n    const lcts = [lclt, lcdt];\n    for (let it = 0; it < 2; ++it) {\n      const clct = lcts[it];\n      for (let i = 0; i < clct.length; ++i) {\n        const len = clct[i] & 31;\n        wbits(out, p, llm[len]), p += lct[len];\n        if (len > 15) wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n      }\n    }\n  } else {\n    lm = flm, ll = flt, dm = fdm, dl = fdt;\n  }\n  for (let i = 0; i < li; ++i) {\n    if (syms[i] > 255) {\n      const len = (syms[i] >>> 18) & 31;\n      wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n      if (len > 7) wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n      const dst = syms[i] & 31;\n      wbits16(out, p, dm[dst]), p += dl[dst];\n      if (dst > 3) wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n    } else {\n      wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n    }\n  }\n  wbits16(out, p, lm[256]);\n  return p + ll[256];\n}\n\n// deflate options (nice << 13) | chain\nconst deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n\n// empty\nconst et = /*#__PURE__*/new u8(0);\n\n// compresses data into a raw DEFLATE buffer\nconst dflt = (dat: Uint8Array, lvl: number, plvl: number, pre: number, post: number, lst: 0 | 1) => {\n  const s = dat.length;\n  const o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n  // writing to this writes to the output buffer\n  const w = o.subarray(pre, o.length - post);\n  let pos = 0;\n  if (!lvl || s < 8) {\n    for (let i = 0; i <= s; i += 65535) {\n      // end\n      const e = i + 65535;\n      if (e < s) {\n        // write full block\n        pos = wfblk(w, pos, dat.subarray(i, e));\n      } else {\n        // write final block\n        w[i] = lst;\n        pos = wfblk(w, pos, dat.subarray(i, s));\n      }\n    }\n  } else {\n    const opt = deo[lvl - 1];\n    const n = opt >>> 13, c = opt & 8191;\n    const msk = (1 << plvl) - 1;\n    //    prev 2-byte val map    curr 2-byte val map\n    const prev = new u16(32768), head = new u16(msk + 1);\n    const bs1 = Math.ceil(plvl / 3), bs2 = 2 * bs1;\n    const hsh = (i: number) => (dat[i] ^ (dat[i + 1] << bs1) ^ (dat[i + 2] << bs2)) & msk;\n    // 24576 is an arbitrary number of maximum symbols per block\n    // 424 buffer for last block\n    const syms = new u32(25000);\n    // length/literal freq   distance freq\n    const lf = new u16(288), df = new u16(32);\n    //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n    let lc = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n    for (; i < s; ++i) {\n      // hash value\n      // deopt when i > s - 3 - at end, deopt acceptable\n      const hv = hsh(i);\n      // index mod 32768    previous index mod\n      let imod = i & 32767, pimod = head[hv];\n      prev[imod] = pimod;\n      head[hv] = imod;\n      // We always should modify head and prev, but only add symbols if\n      // this data is not yet processed (\"wait\" for wait index)\n      if (wi <= i) {\n        // bytes remaining\n        const rem = s - i;\n        if ((lc > 7000 || li > 24576) && rem > 423) {\n          pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n          li = lc = eb = 0, bs = i;\n          for (let j = 0; j < 286; ++j) lf[j] = 0;\n          for (let j = 0; j < 30; ++j) df[j] = 0;\n        }\n        //  len    dist   chain\n        let l = 2, d = 0, ch = c, dif = (imod - pimod) & 32767;\n        if (rem > 2 && hv == hsh(i - dif)) {\n          const maxn = Math.min(n, rem) - 1;\n          const maxd = Math.min(32767, i);\n          // max possible length\n          // not capped at dif because decompressors implement \"rolling\" index population\n          const ml = Math.min(258, rem);\n          while (dif <= maxd && --ch && imod != pimod) {\n            if (dat[i + l] == dat[i + l - dif]) {\n              let nl = 0;\n              for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl);\n              if (nl > l) {\n                l = nl, d = dif;\n                // break out early when we reach \"nice\" (we are satisfied enough)\n                if (nl > maxn) break;\n                // now, find the rarest 2-byte sequence within this\n                // length of literals and search for that instead.\n                // Much faster than just using the start\n                const mmd = Math.min(dif, nl - 2);\n                let md = 0;\n                for (let j = 0; j < mmd; ++j) {\n                  const ti = (i - dif + j + 32768) & 32767;\n                  const pti = prev[ti];\n                  const cd = (ti - pti + 32768) & 32767;\n                  if (cd > md) md = cd, pimod = ti;\n                }\n              }\n            }\n            // check the previous match\n            imod = pimod, pimod = prev[imod];\n            dif += (imod - pimod + 32768) & 32767;\n          }\n        }\n        // d will be nonzero only when a match was found\n        if (d) {\n          // store both dist and len data in one Uint32\n          // Make sure this is recognized as a len/dist with 28th bit (2^28)\n          syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n          const lin = revfl[l] & 31, din = revfd[d] & 31;\n          eb += fleb[lin] + fdeb[din];\n          ++lf[257 + lin];\n          ++df[din];\n          wi = i + l;\n          ++lc;\n        } else {\n          syms[li++] = dat[i];\n          ++lf[dat[i]];\n        }\n      }\n    }\n    pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n    // this is the easiest way to avoid needing to maintain state\n    if (!lst && pos & 7) pos = wfblk(w, pos + 1, et);\n  }\n  return slc(o, 0, pre + shft(pos) + post);\n}\n\n// crc check\ntype CRCV = {\n  p(d: Uint8Array): void;\n  d(): number;\n};\n\n// CRC32 table\nconst crct = /*#__PURE__*/ (() => {\n  const t = new Int32Array(256);\n  for (let i = 0; i < 256; ++i) {\n    let c = i, k = 9;\n    while (--k) c = ((c & 1) && -306674912) ^ (c >>> 1);\n    t[i] = c;\n  }\n  return t;\n})();\n\n// CRC32\nconst crc = (): CRCV => {\n  let c = -1;\n  return {\n    p(d) {\n      // closures have awful performance\n      let cr = c;\n      for (let i = 0; i < d.length; ++i) cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n      c = cr;\n    },\n    d() { return ~c; }\n  }\n}\n\n// Alder32\nconst adler = (): CRCV => {\n  let a = 1, b = 0;\n  return {\n    p(d) {\n      // closures have awful performance\n      let n = a, m = b;\n      const l = d.length | 0;\n      for (let i = 0; i != l;) {\n        const e = Math.min(i + 2655, l);\n        for (; i < e; ++i) m += n += d[i];\n        n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n      }\n      a = n, b = m;\n    },\n    d() {\n      a %= 65521, b %= 65521;\n      return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n    }\n  }\n}\n\n/**\n * Options for compressing data into a DEFLATE format\n */\nexport interface DeflateOptions {\n  /**\n   * The level of compression to use, ranging from 0-9.\n   * \n   * 0 will store the data without compression.\n   * 1 is fastest but compresses the worst, 9 is slowest but compresses the best.\n   * The default level is 6.\n   * \n   * Typically, binary data benefits much more from higher values than text data.\n   * In both cases, higher values usually take disproportionately longer than the reduction in final size that results.\n   * \n   * For example, a 1 MB text file could:\n   * - become 1.01 MB with level 0 in 1ms\n   * - become 400 kB with level 1 in 10ms\n   * - become 320 kB with level 9 in 100ms\n   */\n  level?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;\n  /**\n   * The memory level to use, ranging from 0-12. Increasing this increases speed and compression ratio at the cost of memory.\n   * \n   * Note that this is exponential: while level 0 uses 4 kB, level 4 uses 64 kB, level 8 uses 1 MB, and level 12 uses 16 MB.\n   * It is recommended not to lower the value below 4, since that tends to hurt performance.\n   * In addition, values above 8 tend to help very little on most data and can even hurt performance.\n   * \n   * The default value is automatically determined based on the size of the input data.\n   */\n  mem?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12;\n};\n\n/**\n * Options for compressing data into a GZIP format\n */\nexport interface GzipOptions extends DeflateOptions {\n  /**\n   * When the file was last modified. Defaults to the current time.\n   * Set this to 0 to avoid revealing a modification date entirely.\n   */\n  mtime?: Date | string | number;\n  /**\n   * The filename of the data. If the `gunzip` command is used to decompress the data, it will output a file\n   * with this name instead of the name of the compressed file.\n   */\n  filename?: string;\n}\n\n/**\n * Options for compressing data into a Zlib format\n */\nexport interface ZlibOptions extends DeflateOptions {}\n\n/**\n * Handler for data (de)compression streams\n * @param data The data output from the stream processor\n * @param final Whether this is the final block\n */\nexport type FlateStreamHandler = (data: Uint8Array, final: boolean) => void;\n\n/**\n * Handler for asynchronous data (de)compression streams\n * @param err Any error that occurred\n * @param data The data output from the stream processor\n * @param final Whether this is the final block\n */\nexport type AsyncFlateStreamHandler = (err: FlateError, data: Uint8Array, final: boolean) => void;\n\n/**\n * Callback for asynchronous (de)compression methods\n * @param err Any error that occurred\n * @param data The resulting data. Only present if `err` is null\n */\nexport type FlateCallback = (err: FlateError, data: Uint8Array) => void;\n\n// async callback-based compression\ninterface AsyncOptions {\n  /**\n   * Whether or not to \"consume\" the source data. This will make the typed array/buffer you pass in\n   * unusable but will increase performance and reduce memory usage.\n   */\n  consume?: boolean;\n}\n\n/**\n * Options for compressing data asynchronously into a DEFLATE format\n */\nexport interface AsyncDeflateOptions extends DeflateOptions, AsyncOptions {}\n\n/**\n * Options for decompressing DEFLATE data asynchronously\n */\nexport interface AsyncInflateOptions extends AsyncOptions {\n  /**\n   * The original size of the data. Currently, the asynchronous API disallows\n   * writing into a buffer you provide; the best you can do is provide the\n   * size in bytes and be given back a new typed array.\n   */\n  size?: number;\n}\n\n/**\n * Options for compressing data asynchronously into a GZIP format\n */\nexport interface AsyncGzipOptions extends GzipOptions, AsyncOptions {}\n\n/**\n * Options for decompressing GZIP data asynchronously\n */\nexport interface AsyncGunzipOptions extends AsyncOptions {}\n\n/**\n * Options for compressing data asynchronously into a Zlib format\n */\nexport interface AsyncZlibOptions extends ZlibOptions, AsyncOptions {}\n\n/**\n * Options for decompressing Zlib data asynchronously\n */\nexport interface AsyncUnzlibOptions extends AsyncInflateOptions {}\n\n/**\n * A terminable compression/decompression process\n */\nexport interface AsyncTerminable {\n  /**\n   * Terminates the worker thread immediately. The callback will not be called.\n   */\n  (): void;\n}\n\n// deflate with opts\nconst dopt = (dat: Uint8Array, opt: DeflateOptions, pre: number, post: number, st?: boolean) =>\n  dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st as unknown as 0 | 1);\n\n// Walmart object spread\nconst mrg = <A, B>(a: A, b: B) => {\n  const o = {} as Record<string, unknown>;\n  for (const k in a) o[k] = a[k];\n  for (const k in b) o[k] = b[k];\n  return o as A & B;\n}\n\n// worker clone\n\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n\n// This took me three weeks to figure out how to do.\nconst wcln = (fn: () => unknown[], fnStr: string, td: Record<string, unknown>) => {\n  const dt = fn();\n  const st = fn.toString();\n  const ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n  for (let i = 0; i < dt.length; ++i) {\n    let v = dt[i], k = ks[i];\n    if (typeof v == 'function') {\n      fnStr += ';' + k + '=';\n      const st = v.toString();\n      if (v.prototype) {\n        // for global objects\n        if (st.indexOf('[native code]') != -1) {\n          const spInd = st.indexOf(' ', 8) + 1;\n          fnStr += st.slice(spInd, st.indexOf('(', spInd));\n        } else {\n          fnStr += st;\n          for (const t in v.prototype) fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n        }\n      } else fnStr += st;\n    } else td[k] = v;\n  }\n  return [fnStr, td] as const;\n}\n\ntype CachedWorker = readonly [string, Record<string, unknown>];\n\nconst ch: CachedWorker[] = [];\n// clone bufs\nconst cbfs = (v: Record<string, unknown>) => {\n  const tl: ArrayBuffer[] = [];\n  for (const k in v) {\n    if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32) tl.push((v[k] = new (v[k].constructor as typeof u8)(v[k] as Uint8Array)).buffer);\n  }\n  return tl;\n}\n\n// use a worker to execute code\nconst wrkr = <T, R>(fns: (() => unknown[])[], init: (ev: MessageEvent<T>) => void, id: number, cb: (err: FlateError, msg: R) => void) => {\n  if (!ch[id]) {\n    let fnStr = '', td: Record<string, unknown> = {}, m = fns.length - 1;\n    for (let i = 0; i < m; ++i)\n      [fnStr, td] = wcln(fns[i], fnStr, td);\n    ch[id] = wcln(fns[m], fnStr, td);\n  }\n  const td = mrg({}, ch[id][1]);\n  return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n}\n\n// base async inflate fn\nconst bInflt = () => [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gu8];\nconst bDflt = () => [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]\n\n// gzip extra\nconst gze = () => [gzh, gzhl, wbytes, crc, crct];\n// gunzip extra\nconst guze = () => [gzs, gzl];\n// zlib extra\nconst zle = () => [zlh, wbytes, adler];\n// unzlib extra\nconst zule = () => [zlv];\n\n// post buf\nconst pbf = (msg: Uint8Array) => (postMessage as Worker['postMessage'])(msg, [msg.buffer]);\n\n// get u8\nconst gu8 = (o?: AsyncInflateOptions) => o && o.size && new u8(o.size);\n\n// async helper\nconst cbify = <T extends AsyncOptions>(dat: Uint8Array, opts: T, fns: (() => unknown[])[], init: (ev: MessageEvent<[Uint8Array, T]>) => void, id: number, cb: FlateCallback) => {\n  const w = wrkr<[Uint8Array, T], Uint8Array>(\n    fns,\n    init,\n    id,\n    (err, dat) => {\n      w.terminate();\n      cb(err, dat);\n    }\n  );\n  w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n  return () => { w.terminate(); };\n}\n\ntype CmpDecmpStrm = Inflate | Deflate | Gzip | Gunzip | Zlib | Unzlib;\n\n// auto stream\nconst astrm = (strm: CmpDecmpStrm) => {\n  strm.ondata = (dat, final) => (postMessage as Worker['postMessage'])([dat, final], [dat.buffer]);\n  return (ev: MessageEvent<[Uint8Array, boolean]>) => strm.push(ev.data[0], ev.data[1]);\n}\n\ntype Astrm = { ondata: AsyncFlateStreamHandler; push: (d: Uint8Array, f?: boolean) => void; terminate: AsyncTerminable; };\n\n// async stream attach\nconst astrmify = <T>(fns: (() => unknown[])[], strm: Astrm, opts: T | 0, init: (ev: MessageEvent<T>) => void, id: number) => {\n  let t: boolean;\n  const w = wrkr<T, [Uint8Array, boolean]>(\n    fns,\n    init,\n    id,\n    (err, dat) => {\n      if (err) w.terminate(), strm.ondata.call(strm, err);\n      else {\n        if (dat[1]) w.terminate();\n        strm.ondata.call(strm, err, dat[0], dat[1]);\n      }\n    }\n  )\n  w.postMessage(opts);\n  strm.push = (d, f) => {\n    if (!strm.ondata) err(5);\n    if (t) strm.ondata(err(4, 0, 1), null, !!f);\n    w.postMessage([d, t = f], [d.buffer]);\n  };\n  strm.terminate = () => { w.terminate(); };\n}\n\n// read 2 bytes\nconst b2 = (d: Uint8Array, b: number) => d[b] | (d[b + 1] << 8);\n\n// read 4 bytes\nconst b4 = (d: Uint8Array, b: number) => (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0;\n\nconst b8 = (d: Uint8Array, b: number) => b4(d, b) + (b4(d, b + 4) * 4294967296);\n\n// write bytes\nconst wbytes = (d: Uint8Array, b: number, v: number) => {\n  for (; v; ++b) d[b] = v, v >>>= 8;\n}\n\n// gzip header\nconst gzh = (c: Uint8Array, o: GzipOptions) => {\n  const fn = o.filename;\n  c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n  if (o.mtime != 0) wbytes(c, 4, Math.floor((new Date(o.mtime as (string | number) || Date.now()) as unknown as number) / 1000));\n  if (fn) {\n    c[3] = 8;\n    for (let i = 0; i <= fn.length; ++i) c[i + 10] = fn.charCodeAt(i);\n  }\n}\n\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n\n// gzip start\nconst gzs = (d: Uint8Array) => {\n  if (d[0] != 31 || d[1] != 139 || d[2] != 8) err(6, 'invalid gzip data');\n  const flg = d[3];\n  let st = 10;\n  if (flg & 4) st += d[10] | (d[11] << 8) + 2;\n  for (let zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++] as unknown as number);\n  return st + (flg & 2);\n}\n\n// gzip length\nconst gzl = (d: Uint8Array) => {\n  const l = d.length;\n  return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n}\n\n// gzip header length\nconst gzhl = (o: GzipOptions) => 10 + ((o.filename && (o.filename.length + 1)) || 0);\n\n// zlib header\nconst zlh = (c: Uint8Array, o: ZlibOptions) => {\n  const lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n  c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n}\n\n// zlib valid\nconst zlv = (d: Uint8Array) => {\n  if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31)) err(6, 'invalid zlib data');\n  if (d[1] & 32) err(6, 'invalid zlib data: preset dictionaries not supported');\n}\n\n/**\n * Creates an asynchronous compression stream\n * @param opts The compression options\n * @param cb The callback to call whenever data is deflated\n */\nfunction AsyncCmpStrm<T>(opts: T, cb?: AsyncFlateStreamHandler): T;\n/**\n * Creates an asynchronous compression stream\n * @param cb The callback to call whenever data is deflated\n */\nfunction AsyncCmpStrm<T>(cb?: AsyncFlateStreamHandler): T;\nfunction AsyncCmpStrm<T>(opts?: T | AsyncFlateStreamHandler, cb?: AsyncFlateStreamHandler): T {\n  if (!cb && typeof opts == 'function') cb = opts as AsyncFlateStreamHandler, opts = {} as T;\n  this.ondata = cb as AsyncFlateStreamHandler;\n  return opts as T;\n}\n\n// zlib footer: -4 to -0 is Adler32\n\n/**\n * Streaming DEFLATE compression\n */\nexport class Deflate {\n  /**\n   * Creates a DEFLATE stream\n   * @param opts The compression options\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(opts: DeflateOptions, cb?: FlateStreamHandler);\n  constructor(cb?: FlateStreamHandler);\n  constructor(opts?: DeflateOptions | FlateStreamHandler, cb?: FlateStreamHandler) {\n    if (!cb && typeof opts == 'function') cb = opts as FlateStreamHandler, opts = {};\n    this.ondata = cb;\n    this.o = (opts as DeflateOptions) || {};\n  }\n  private o: DeflateOptions;\n  private d: boolean;\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n\n  private p(c: Uint8Array, f: boolean) {\n    this.ondata(dopt(c, this.o, 0, 0, !f), f);\n  }\n\n  /**\n   * Pushes a chunk to be deflated\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    if (!this.ondata) err(5);\n    if (this.d) err(4);\n    this.d = final;\n    this.p(chunk, final || false);\n  }\n}\n\n/**\n * Asynchronous streaming DEFLATE compression\n */\nexport class AsyncDeflate {\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Creates an asynchronous DEFLATE stream\n   * @param opts The compression options\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(opts: DeflateOptions, cb?: AsyncFlateStreamHandler);\n  /**\n   * Creates an asynchronous DEFLATE stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: AsyncFlateStreamHandler);\n  constructor(opts?: DeflateOptions | AsyncFlateStreamHandler, cb?: AsyncFlateStreamHandler) {\n    astrmify([\n      bDflt,\n      () => [astrm, Deflate]\n    ], this as unknown as Astrm, AsyncCmpStrm.call(this, opts, cb), ev => {\n      const strm = new Deflate(ev.data);\n      onmessage = astrm(strm);\n    }, 6);\n  }\n\n  /**\n   * Pushes a chunk to be deflated\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  // @ts-ignore\n  push(chunk: Uint8Array, final?: boolean): void;\n  \n  /**\n   * A method to terminate the stream's internal worker. Subsequent calls to\n   * push() will silently fail.\n   */\n  terminate: AsyncTerminable;\n}\n\n/**\n * Asynchronously compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @param cb The function to be called upon compression completion\n * @returns A function that can be used to immediately terminate the compression\n */\nexport function deflate(data: Uint8Array, opts: AsyncDeflateOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchronously compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param cb The function to be called upon compression completion\n */\nexport function deflate(data: Uint8Array, cb: FlateCallback): AsyncTerminable;\nexport function deflate(data: Uint8Array, opts: AsyncDeflateOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  return cbify(data, opts as AsyncDeflateOptions, [\n    bDflt,\n  ], ev => pbf(deflateSync(ev.data[0], ev.data[1])), 0, cb);\n}\n\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data: Uint8Array, opts?: DeflateOptions) {\n  return dopt(data, opts || {}, 0, 0);\n}\n\n/**\n * Streaming DEFLATE decompression\n */\nexport class Inflate {\n  /**\n   * Creates an inflation stream\n   * @param cb The callback to call whenever data is inflated\n   */\n  constructor(cb?: FlateStreamHandler) { this.ondata = cb; }\n  private s: InflateState = {};\n  private o: Uint8Array;\n  private p = new u8(0);\n  private d: boolean;\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n\n  private e(c: Uint8Array) {\n    if (!this.ondata) err(5);\n    if (this.d) err(4);\n    const l = this.p.length;\n    const n = new u8(l + c.length);\n    n.set(this.p), n.set(c, l), this.p = n;\n  }\n\n  private c(final: boolean) {\n    this.d = this.s.i = final || false;\n    const bts = this.s.b;\n    const dt = inflt(this.p, this.o, this.s);\n    this.ondata(slc(dt, bts, this.s.b), this.d);\n    this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n    this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n  }\n\n  /**\n   * Pushes a chunk to be inflated\n   * @param chunk The chunk to push\n   * @param final Whether this is the final chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    this.e(chunk), this.c(final);\n  }\n}\n\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nexport class AsyncInflate {\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Creates an asynchronous inflation stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: AsyncFlateStreamHandler) {\n    this.ondata = cb;\n    astrmify([\n      bInflt,\n      () => [astrm, Inflate]\n    ], this as unknown as Astrm, 0, () => {\n      const strm = new Inflate();\n      onmessage = astrm(strm);\n    }, 7);\n  }\n\n  /**\n   * Pushes a chunk to be inflated\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  // @ts-ignore\n  push(chunk: Uint8Array, final?: boolean): void;\n\n  /**\n   * A method to terminate the stream's internal worker. Subsequent calls to\n   * push() will silently fail.\n   */\n  terminate: AsyncTerminable;\n}\n\n/**\n * Asynchronously expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param opts The decompression options\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function inflate(data: Uint8Array, opts: AsyncInflateOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchronously expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function inflate(data: Uint8Array, cb: FlateCallback): AsyncTerminable;\nexport function inflate(data: Uint8Array, opts: AsyncInflateOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  return cbify(data, opts as AsyncInflateOptions, [\n    bInflt\n  ], ev => pbf(inflateSync(ev.data[0], gu8(ev.data[1]))), 1, cb);\n}\n\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data: Uint8Array, out?: Uint8Array) {\n  return inflt(data, out);\n}\n\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n\n/**\n * Streaming GZIP compression\n */\nexport class Gzip {\n  private c = crc();\n  private l = 0;\n  private v = 1;\n  private o: GzipOptions;\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n\n  /**\n   * Creates a GZIP stream\n   * @param opts The compression options\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(opts: GzipOptions, cb?: FlateStreamHandler);\n  /**\n   * Creates a GZIP stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: FlateStreamHandler);\n  constructor(opts?: GzipOptions | FlateStreamHandler, cb?: FlateStreamHandler) {\n    Deflate.call(this, opts, cb);\n  }\n\n  /**\n   * Pushes a chunk to be GZIPped\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    Deflate.prototype.push.call(this, chunk, final);\n  }\n  \n  private p(c: Uint8Array, f: boolean) {\n    this.c.p(c);\n    this.l += c.length;\n    const raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n    if (this.v) gzh(raw, this.o), this.v = 0;\n    if (f) wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n    this.ondata(raw, f);\n  }\n}\n\n/**\n * Asynchronous streaming GZIP compression\n */\nexport class AsyncGzip {\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Creates an asynchronous GZIP stream\n   * @param opts The compression options\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(opts: GzipOptions, cb?: AsyncFlateStreamHandler);\n  /**\n   * Creates an asynchronous GZIP stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: AsyncFlateStreamHandler);\n  constructor(opts?: GzipOptions | AsyncFlateStreamHandler, cb?: AsyncFlateStreamHandler) {\n    astrmify([\n      bDflt,\n      gze,\n      () => [astrm, Deflate, Gzip]\n    ], this as unknown as Astrm, AsyncCmpStrm.call(this, opts, cb), ev => {\n      const strm = new Gzip(ev.data);\n      onmessage = astrm(strm);\n    }, 8);\n  }\n\n  /**\n   * Pushes a chunk to be GZIPped\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  // @ts-ignore\n  push(chunk: Uint8Array, final?: boolean): void;\n\n  /**\n   * A method to terminate the stream's internal worker. Subsequent calls to\n   * push() will silently fail.\n   */\n  terminate: AsyncTerminable;\n}\n\n/**\n * Asynchronously compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @param cb The function to be called upon compression completion\n * @returns A function that can be used to immediately terminate the compression\n */\nexport function gzip(data: Uint8Array, opts: AsyncGzipOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchronously compresses data with GZIP\n * @param data The data to compress\n * @param cb The function to be called upon compression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function gzip(data: Uint8Array, cb: FlateCallback): AsyncTerminable;\nexport function gzip(data: Uint8Array, opts: AsyncGzipOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  return cbify(data, opts as AsyncGzipOptions, [\n    bDflt,\n    gze,\n    () => [gzipSync]\n  ], ev => pbf(gzipSync(ev.data[0], ev.data[1])), 2, cb);\n}\n\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data: Uint8Array, opts?: GzipOptions) {\n  if (!opts) opts = {};\n  const c = crc(), l = data.length;\n  c.p(data);\n  const d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n  return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n\n/**\n * Streaming GZIP decompression\n */\nexport class Gunzip {\n  private v = 1;\n  private p: Uint8Array;\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n\n  /**\n   * Creates a GUNZIP stream\n   * @param cb The callback to call whenever data is inflated\n   */\n  constructor(cb?: FlateStreamHandler) { Inflate.call(this, cb); }\n\n  /**\n   * Pushes a chunk to be GUNZIPped\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    (Inflate.prototype as unknown as { e: typeof Inflate.prototype['e'] }).e.call(this, chunk);\n    if (this.v) {\n      const s = this.p.length > 3 ? gzs(this.p) : 4;\n      if (s >= this.p.length && !final) return;\n      this.p = this.p.subarray(s), this.v = 0;\n    }\n    if (final) {\n      if (this.p.length < 8) err(6, 'invalid gzip data');\n      this.p = this.p.subarray(0, -8);\n    }\n    // necessary to prevent TS from using the closure value\n    // This allows for workerization to function correctly\n    (Inflate.prototype as unknown as { c: typeof Inflate.prototype['c'] }).c.call(this, final);\n  }\n}\n\n/**\n * Asynchronous streaming GZIP decompression\n */\nexport class AsyncGunzip {\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Creates an asynchronous GUNZIP stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: AsyncFlateStreamHandler) {\n    this.ondata = cb;\n    astrmify([\n      bInflt,\n      guze,\n      () => [astrm, Inflate, Gunzip]\n    ], this as unknown as Astrm, 0, () => {\n      const strm = new Gunzip();\n      onmessage = astrm(strm);\n    }, 9);\n  }\n\n  /**\n   * Pushes a chunk to be GUNZIPped\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  // @ts-ignore\n  push(chunk: Uint8Array, final?: boolean): void;\n\n  /**\n   * A method to terminate the stream's internal worker. Subsequent calls to\n   * push() will silently fail.\n   */\n  terminate: AsyncTerminable;\n}\n\n/**\n * Asynchronously expands GZIP data\n * @param data The data to decompress\n * @param opts The decompression options\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function gunzip(data: Uint8Array, opts: AsyncGunzipOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchronously expands GZIP data\n * @param data The data to decompress\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function gunzip(data: Uint8Array, cb: FlateCallback): AsyncTerminable;\nexport function gunzip(data: Uint8Array, opts: AsyncGunzipOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  return cbify(data, opts as AsyncGunzipOptions, [\n    bInflt,\n    guze,\n    () => [gunzipSync]\n  ], ev => pbf(gunzipSync(ev.data[0])), 3, cb);\n}\n\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data: Uint8Array, out?: Uint8Array) {\n  return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n\n/**\n * Streaming Zlib compression\n */\nexport class Zlib {\n  private c = adler();\n  private v = 1;\n  private o: GzipOptions;\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n\n  /**\n   * Creates a Zlib stream\n   * @param opts The compression options\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(opts: ZlibOptions, cb?: FlateStreamHandler);\n  /**\n   * Creates a Zlib stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: FlateStreamHandler);\n  constructor(opts?: ZlibOptions | FlateStreamHandler, cb?: FlateStreamHandler) {\n    Deflate.call(this, opts, cb);\n  }\n\n  /**\n   * Pushes a chunk to be zlibbed\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    Deflate.prototype.push.call(this, chunk, final);\n  }\n  \n  private p(c: Uint8Array, f: boolean) {\n    this.c.p(c);\n    const raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n    if (this.v) zlh(raw, this.o), this.v = 0;\n    if (f) wbytes(raw, raw.length - 4, this.c.d());\n    this.ondata(raw, f);\n  }\n}\n\n/**\n * Asynchronous streaming Zlib compression\n */\nexport class AsyncZlib {\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Creates an asynchronous DEFLATE stream\n   * @param opts The compression options\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(opts: ZlibOptions, cb?: AsyncFlateStreamHandler);\n  /**\n   * Creates an asynchronous DEFLATE stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: AsyncFlateStreamHandler);\n  constructor(opts?: ZlibOptions | AsyncFlateStreamHandler, cb?: AsyncFlateStreamHandler) {\n    astrmify([\n      bDflt,\n      zle,\n      () => [astrm, Deflate, Zlib]\n    ], this as unknown as Astrm, AsyncCmpStrm.call(this, opts, cb), ev => {\n      const strm = new Zlib(ev.data);\n      onmessage = astrm(strm);\n    }, 10);\n  }\n\n  /**\n   * Pushes a chunk to be deflated\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  // @ts-ignore\n  push(chunk: Uint8Array, final?: boolean): void;\n\n  /**\n   * A method to terminate the stream's internal worker. Subsequent calls to\n   * push() will silently fail.\n   */\n  terminate: AsyncTerminable;\n}\n\n/**\n * Asynchronously compresses data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @param cb The function to be called upon compression completion\n */\nexport function zlib(data: Uint8Array, opts: AsyncZlibOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchronously compresses data with Zlib\n * @param data The data to compress\n * @param cb The function to be called upon compression completion\n * @returns A function that can be used to immediately terminate the compression\n */\nexport function zlib(data: Uint8Array, cb: FlateCallback): AsyncTerminable;\nexport function zlib(data: Uint8Array, opts: AsyncZlibOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  return cbify(data, opts as AsyncZlibOptions, [\n    bDflt,\n    zle,\n    () => [zlibSync]\n  ], ev => pbf(zlibSync(ev.data[0], ev.data[1])), 4, cb);\n}\n\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data: Uint8Array, opts: ZlibOptions) {\n  if (!opts) opts = {};\n  const a = adler();\n  a.p(data);\n  const d = dopt(data, opts, 2, 4);\n  return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n\n/**\n * Streaming Zlib decompression\n */\nexport class Unzlib {\n  private v = 1;\n  private p: Uint8Array;\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n  /**\n   * Creates a Zlib decompression stream\n   * @param cb The callback to call whenever data is inflated\n   */\n  constructor(cb?: FlateStreamHandler) { Inflate.call(this, cb); }\n\n  /**\n   * Pushes a chunk to be unzlibbed\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    (Inflate.prototype as unknown as { e: typeof Inflate.prototype['e'] }).e.call(this, chunk);\n    if (this.v) {\n      if (this.p.length < 2 && !final) return;\n      this.p = this.p.subarray(2), this.v = 0;\n    }\n    if (final) {\n      if (this.p.length < 4) err(6, 'invalid zlib data');\n      this.p = this.p.subarray(0, -4);\n    }\n    // necessary to prevent TS from using the closure value\n    // This allows for workerization to function correctly\n    (Inflate.prototype as unknown as { c: typeof Inflate.prototype['c'] }).c.call(this, final);\n  }\n}\n\n/**\n * Asynchronous streaming Zlib decompression\n */\nexport class AsyncUnzlib {\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Creates an asynchronous Zlib decompression stream\n   * @param cb The callback to call whenever data is deflated\n   */\n  constructor(cb?: AsyncFlateStreamHandler) {\n    this.ondata = cb;\n    astrmify([\n      bInflt,\n      zule,\n      () => [astrm, Inflate, Unzlib]\n    ], this as unknown as Astrm, 0, () => {\n      const strm = new Unzlib();\n      onmessage = astrm(strm);\n    }, 11);\n  }\n\n  /**\n   * Pushes a chunk to be decompressed from Zlib\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  // @ts-ignore\n  push(chunk: Uint8Array, final?: boolean): void;\n\n  /**\n   * A method to terminate the stream's internal worker. Subsequent calls to\n   * push() will silently fail.\n   */\n  terminate: AsyncTerminable;\n}\n\n/**\n * Asynchronously expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function unzlib(data: Uint8Array, opts: AsyncGunzipOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchronously expands Zlib data\n * @param data The data to decompress\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function unzlib(data: Uint8Array, cb: FlateCallback): AsyncTerminable;\nexport function unzlib(data: Uint8Array, opts: AsyncGunzipOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  return cbify(data, opts as AsyncUnzlibOptions, [\n    bInflt,\n    zule,\n    () => [unzlibSync]\n  ], ev => pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))), 5, cb);\n}\n\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data: Uint8Array, out?: Uint8Array) {\n  return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress }\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress }\n\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nexport class Decompress {\n  private G = Gunzip;\n  private I = Inflate;\n  private Z = Unzlib;\n  /**\n   * Creates a decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n  constructor(cb?: FlateStreamHandler) { this.ondata = cb; }\n  private s: Inflate | Gunzip | Unzlib;\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n  private p: Uint8Array;\n\n  /**\n   * Pushes a chunk to be decompressed\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    if (!this.ondata) err(5);\n    if (!this.s) {\n      if (this.p && this.p.length) {\n        const n = new u8(this.p.length + chunk.length);\n        n.set(this.p), n.set(chunk, this.p.length);\n      } else this.p = chunk;\n      if (this.p.length > 2) {\n        const _this = this;\n        const cb: FlateStreamHandler = function() { _this.ondata.apply(_this, arguments); }\n        this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n          ? new this.G(cb)\n          : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n            ? new this.I(cb)\n            : new this.Z(cb);\n        this.s.push(this.p, final);\n        this.p = null;\n      }\n    } else this.s.push(chunk, final);\n  }\n}\n\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nexport class AsyncDecompress {\n  private G = AsyncGunzip;\n  private I = AsyncInflate;\n  private Z = AsyncUnzlib;\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n  constructor(cb?: AsyncFlateStreamHandler) { this.ondata = cb; }\n  \n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Pushes a chunk to be decompressed\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    Decompress.prototype.push.call(this, chunk, final);\n  }\n}\n\n/**\n * Asynchrononously expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param opts The decompression options\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function decompress(data: Uint8Array, opts: AsyncInflateOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchrononously expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param cb The function to be called upon decompression completion\n * @returns A function that can be used to immediately terminate the decompression\n */\nexport function decompress(data: Uint8Array, cb: FlateCallback): AsyncTerminable;\nexport function decompress(data: Uint8Array, opts: AsyncInflateOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n    ? gunzip(data, opts as AsyncInflateOptions, cb)\n    : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n      ? inflate(data, opts as AsyncInflateOptions, cb)\n      : unzlib(data, opts as AsyncInflateOptions, cb);\n}\n\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data: Uint8Array, out?: Uint8Array) {\n  return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n    ? gunzipSync(data, out)\n    : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n      ? inflateSync(data, out)\n      : unzlibSync(data, out);\n}\n\n/**\n * Attributes for files added to a ZIP archive object\n */\nexport interface ZipAttributes {\n  /**\n   * The operating system of origin for this file. The value is defined\n   * by PKZIP's APPNOTE.txt, section 4.4.2.2. For example, 0 (the default)\n   * is MS/DOS, 3 is UNIX, 19 is macOS.\n   */\n  os?: number;\n\n  /**\n   * The file's attributes. These are traditionally somewhat complicated\n   * and platform-dependent, so using them is scarcely necessary. However,\n   * here is a representation of what this is, bit by bit:\n   * \n   * `TTTTugtrwxrwxrwx0000000000ADVSHR`\n   * \n   * TTTT = file type (rarely useful)\n   * \n   * u = setuid, g = setgid, t = sticky\n   * \n   * rwx = user permissions, rwx = group permissions, rwx = other permissions\n   * \n   * 0000000000 = unused\n   * \n   * A = archive, D = directory, V = volume label, S = system file, H = hidden, R = read-only\n   * \n   * If you want to set the Unix permissions, for instance, just bit shift by 16, e.g. 0644 << 16\n   */\n  attrs?: number;\n\n  /**\n   * Extra metadata to add to the file. This field is defined by PKZIP's APPNOTE.txt,\n   * section 4.4.28. At most 65,535 bytes may be used in each ID. The ID must be an\n   * integer between 0 and 65,535, inclusive.\n   * \n   * This field is incredibly rare and almost never needed except for compliance with\n   * proprietary standards and software.\n   */\n  extra?: Record<number, Uint8Array>;\n\n  /**\n   * The comment to attach to the file. This field is defined by PKZIP's APPNOTE.txt,\n   * section 4.4.26. The comment must be at most 65,535 bytes long UTF-8 encoded. This\n   * field is not read by consumer software.\n   */\n  comment?: string;\n\n  /**\n   * When the file was last modified. Defaults to the current time.\n   */\n  mtime?: GzipOptions['mtime'];\n}\n\n/**\n * Options for creating a ZIP archive\n */\nexport interface ZipOptions extends DeflateOptions, ZipAttributes {}\n\n/**\n * Options for asynchronously creating a ZIP archive\n */\nexport interface AsyncZipOptions extends AsyncDeflateOptions, ZipAttributes {}\n\n/**\n * Options for asynchronously expanding a ZIP archive\n */\nexport interface AsyncUnzipOptions extends AsyncOptions {}\n\n/**\n * A file that can be used to create a ZIP archive\n */\nexport type ZippableFile = Uint8Array | [Uint8Array, ZipOptions];\n\n/**\n * A file that can be used to asynchronously create a ZIP archive\n */\nexport type AsyncZippableFile = Uint8Array | [Uint8Array, AsyncZipOptions];\n\n/**\n * The complete directory structure of a ZIPpable archive\n */\nexport interface Zippable {\n  [path: string]: Zippable | ZippableFile;\n}\n\n/**\n * The complete directory structure of an asynchronously ZIPpable archive\n */\nexport interface AsyncZippable {\n  [path: string]: AsyncZippable | AsyncZippableFile;\n}\n\n/**\n * An unzipped archive. The full path of each file is used as the key,\n * and the file is the value\n */\nexport interface Unzipped {\n  [path: string]: Uint8Array\n}\n\n/**\n * Handler for string generation streams\n * @param data The string output from the stream processor\n * @param final Whether this is the final block\n */\nexport type StringStreamHandler = (data: string, final: boolean) => void;\n\n/**\n * Callback for asynchronous ZIP decompression\n * @param err Any error that occurred\n * @param data The decompressed ZIP archive\n */\nexport type UnzipCallback = (err: FlateError, data: Unzipped) => void;\n\n/**\n * Handler for streaming ZIP decompression\n * @param file The file that was found in the archive\n */\nexport type UnzipFileHandler = (file: UnzipFile) => void;\n\n// flattened Zippable\ntype FlatZippable<A extends boolean> = Record<string, [Uint8Array, (A extends true ? AsyncZipOptions : ZipOptions)]>;\n\n// flatten a directory structure\nconst fltn = <A extends boolean>(d: A extends true ? AsyncZippable : Zippable, p: string, t: FlatZippable<A>, o: ZipOptions) => {\n  for (const k in d) {\n    const val = d[k], n = p + k;\n    if (val instanceof u8) t[n] = [val, o] as unknown as FlatZippable<A>[string];\n    else if (Array.isArray(val)) t[n] = [val[0], mrg(o, val[1])] as FlatZippable<A>[string];\n    else fltn(val as unknown as (A extends true ? AsyncZippable : Zippable), n + '/', t, o);\n  }\n}\n\n// text encoder\nconst te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nconst td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nlet tds = 0;\ntry {\n  td.decode(et, { stream: true });\n  tds = 1;\n} catch(e) {}\n\n// decode UTF8\nconst dutf8 = (d: Uint8Array) => {\n  for (let r = '', i = 0;;) {\n    let c = d[i++];\n    const eb = ((c > 127) as unknown as number) + ((c > 223) as unknown as number) + ((c > 239) as unknown as number);\n    if (i + eb > d.length) return [r, slc(d, i - 1)] as const;\n    if (!eb) r += String.fromCharCode(c)\n    else if (eb == 3) {\n      c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n      r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n    } else if (eb & 1) r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n    else r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n  }\n}\n\n/**\n * Streaming UTF-8 decoding\n */\nexport class DecodeUTF8 {\n  private p: Uint8Array;\n  private t: TextDecoder;\n  /**\n   * Creates a UTF-8 decoding stream\n   * @param cb The callback to call whenever data is decoded\n   */\n  constructor(cb?: StringStreamHandler) {\n    this.ondata = cb;\n    if (tds) this.t = new TextDecoder();\n    else this.p = et;\n  }\n\n  /**\n   * Pushes a chunk to be decoded from UTF-8 binary\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    if (!this.ondata) err(5);\n    final = !!final;\n    if (this.t) {\n      this.ondata(this.t.decode(chunk, { stream: true }), final);\n      if (final) {\n        if (this.t.decode().length) err(8);\n        this.t = null;\n      }\n      return;\n    }\n    if (!this.p) err(4);\n    const dat = new u8(this.p.length + chunk.length);\n    dat.set(this.p);\n    dat.set(chunk, this.p.length);\n    const [ch, np] = dutf8(dat);\n    if (final) {\n      if (np.length) err(8);\n      this.p = null;\n    } else this.p = np;\n    this.ondata(ch, final);\n  }\n\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: StringStreamHandler;\n}\n\n/**\n * Streaming UTF-8 encoding\n */\nexport class EncodeUTF8 {\n  private d: boolean;\n  /**\n   * Creates a UTF-8 decoding stream\n   * @param cb The callback to call whenever data is encoded\n   */\n  constructor(cb?: FlateStreamHandler) {\n    this.ondata = cb;\n  }\n\n  /**\n   * Pushes a chunk to be encoded to UTF-8\n   * @param chunk The string data to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: string, final?: boolean) {\n    if (!this.ondata) err(5);\n    if (this.d) err(4);\n    this.ondata(strToU8(chunk), this.d = final || false);\n  }\n\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: FlateStreamHandler;\n}\n\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str: string, latin1?: boolean): Uint8Array {\n  if (latin1) {\n    const ar = new u8(str.length);\n    for (let i = 0; i < str.length; ++i) ar[i] = str.charCodeAt(i);\n    return ar;\n  }\n  if (te) return te.encode(str);\n  const l = str.length;\n  let ar = new u8(str.length + (str.length >> 1));\n  let ai = 0;\n  const w = (v: number) => { ar[ai++] = v; };\n  for (let i = 0; i < l; ++i) {\n    if (ai + 5 > ar.length) {\n      const n = new u8(ai + 8 + ((l - i) << 1));\n      n.set(ar);\n      ar = n;\n    }\n    let c = str.charCodeAt(i);\n    if (c < 128 || latin1) w(c);\n    else if (c < 2048) w(192 | (c >> 6)), w(128 | (c & 63));\n    else if (c > 55295 && c < 57344)\n      c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n      w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    else w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n  }\n  return slc(ar, 0, ai);\n}\n\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat: Uint8Array, latin1?: boolean) {\n  if (latin1) {\n    let r = '';\n    for (let i = 0; i < dat.length; i += 16384)\n      r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n    return r;\n  } else if (td) return td.decode(dat)\n  else {\n    const [out, ext] = dutf8(dat);\n    if (ext.length) err(8);\n    return out;\n  } \n};\n\n// deflate bit flag\nconst dbf = (l: number) => l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0;\n\n// skip local zip header\nconst slzh = (d: Uint8Array, b: number) => b + 30 + b2(d, b + 26) + b2(d, b + 28);\n\n// read zip header\nconst zh = (d: Uint8Array, b: number, z: boolean) => {\n  const fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n  const [sc, su, off] = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)];\n  return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off] as const;\n}\n\n// read zip64 extra field\nconst z64e = (d: Uint8Array, b: number) => {\n  for (; b2(d, b) != 1; b += 4 + b2(d, b + 2));\n  return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)] as const;\n}\n\n// zip header file\ntype ZHF = Omit<ZipInputFile, 'terminate' | 'ondata' | 'filename'>;\n\n// extra field length\nconst exfl = (ex?: ZHF['extra']) => {\n  let le = 0;\n  if (ex) {\n    for (const k in ex) {\n      const l = ex[k].length;\n      if (l > 65535) err(9);\n      le += l + 4;\n    }\n  }\n  return le;\n}\n\n// write zip header\nconst wzh = (d: Uint8Array, b: number, f: ZHF, fn: Uint8Array, u: boolean, c?: number, ce?: number, co?: Uint8Array) => {\n  const fl = fn.length, ex = f.extra, col = co && co.length;\n  let exl = exfl(ex);\n  wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n  if (ce != null) d[b++] = 20, d[b++] = f.os;\n  d[b] = 20, b += 2; // spec compliance? what's that?\n  d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n  d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n  const dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n  if (y < 0 || y > 119) err(10);\n  wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n  if (c != null) {\n    wbytes(d, b, f.crc);\n    wbytes(d, b + 4, c);\n    wbytes(d, b + 8, f.size);\n  }\n  wbytes(d, b + 12, fl);\n  wbytes(d, b + 14, exl), b += 16;\n  if (ce != null) {\n    wbytes(d, b, col);\n    wbytes(d, b + 6, f.attrs);\n    wbytes(d, b + 10, ce), b += 14;\n  }\n  d.set(fn, b);\n  b += fl;\n  if (exl) {\n    for (const k in ex) {\n      const exf = ex[k], l = exf.length;\n      wbytes(d, b, +k);\n      wbytes(d, b + 2, l);\n      d.set(exf, b + 4), b += 4 + l;\n    }\n  }\n  if (col) d.set(co, b), b += col;\n  return b;\n}\n\n// write zip footer (end of central directory)\nconst wzf = (o: Uint8Array, b: number, c: number, d: number, e: number) => {\n  wbytes(o, b, 0x6054B50); // skip disk\n  wbytes(o, b + 8, c);\n  wbytes(o, b + 10, c);\n  wbytes(o, b + 12, d);\n  wbytes(o, b + 16, e);\n}\n\n/**\n * A stream that can be used to create a file in a ZIP archive\n */\nexport interface ZipInputFile extends ZipAttributes {\n  /**\n   * The filename to associate with the data provided to this stream. If you\n   * want a file in a subdirectory, use forward slashes as a separator (e.g.\n   * `directory/filename.ext`). This will still work on Windows.\n   */\n  filename: string;\n\n  /**\n   * The size of the file in bytes. This attribute may be invalid after\n   * the file is added to the ZIP archive; it must be correct only before the\n   * stream completes.\n   * \n   * If you don't want to have to compute this yourself, consider extending the\n   * ZipPassThrough class and overriding its process() method, or using one of\n   * ZipDeflate or AsyncZipDeflate.\n   */\n  size: number;\n\n  /**\n   * A CRC of the original file contents. This attribute may be invalid after\n   * the file is added to the ZIP archive; it must be correct only before the\n   * stream completes.\n   * \n   * If you don't want to have to generate this yourself, consider extending the\n   * ZipPassThrough class and overriding its process() method, or using one of\n   * ZipDeflate or AsyncZipDeflate.\n   */\n  crc: number;\n\n  /**\n   * The compression format for the data stream. This number is determined by\n   * the spec in PKZIP's APPNOTE.txt, section 4.4.5. For example, 0 = no\n   * compression, 8 = deflate, 14 = LZMA\n   */\n  compression: number;\n\n  /**\n   * Bits 1 and 2 of the general purpose bit flag, specified in PKZIP's\n   * APPNOTE.txt, section 4.4.4. Should be between 0 and 3. This is unlikely\n   * to be necessary.\n   */\n  flag?: number;\n\n  /**\n   * The handler to be called when data is added. After passing this stream to\n   * the ZIP file object, this handler will always be defined. To call it:\n   * \n   * `stream.ondata(error, chunk, final)`\n   * \n   * error = any error that occurred (null if there was no error)\n   * \n   * chunk = a Uint8Array of the data that was added (null if there was an\n   * error)\n   * \n   * final = boolean, whether this is the final chunk in the stream\n   */\n  ondata?: AsyncFlateStreamHandler;\n  \n  /**\n   * A method called when the stream is no longer needed, for clean-up\n   * purposes. This will not always be called after the stream completes,\n   * so you may wish to call this.terminate() after the final chunk is\n   * processed if you have clean-up logic.\n   */\n  terminate?: AsyncTerminable;\n}\n\ntype AsyncZipDat = ZHF & {\n  // compressed data\n  c: Uint8Array;\n  // filename\n  f: Uint8Array;\n  // comment\n  m?: Uint8Array;\n  // unicode\n  u: boolean;\n};\n\ntype ZipDat = AsyncZipDat & {\n  // offset\n  o: number;\n}\n\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nexport class ZipPassThrough implements ZipInputFile {\n  filename: string;\n  crc: number;\n  size: number;\n  compression: number;\n  os?: number;\n  attrs?: number;\n  comment?: string;\n  extra?: Record<number, Uint8Array>;\n  mtime?: GzipOptions['mtime'];\n  ondata: AsyncFlateStreamHandler;\n  private c: CRCV;\n\n  /**\n   * Creates a pass-through stream that can be added to ZIP archives\n   * @param filename The filename to associate with this data stream\n   */\n  constructor(filename: string) {\n    this.filename = filename;\n    this.c = crc();\n    this.size = 0;\n    this.compression = 0;\n  }\n\n  /**\n   * Processes a chunk and pushes to the output stream. You can override this\n   * method in a subclass for custom behavior, but by default this passes\n   * the data through. You must call this.ondata(err, chunk, final) at some\n   * point in this method.\n   * @param chunk The chunk to process\n   * @param final Whether this is the last chunk\n   */\n  protected process(chunk: Uint8Array, final: boolean) {\n    this.ondata(null, chunk, final);\n  }\n\n  /**\n   * Pushes a chunk to be added. If you are subclassing this with a custom\n   * compression algorithm, note that you must push data from the source\n   * file only, pre-compression.\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    if (!this.ondata) err(5);\n    this.c.p(chunk);\n    this.size += chunk.length;\n    if (final) this.crc = this.c.d();\n    this.process(chunk, final || false);\n  }\n}\n\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nexport class ZipDeflate implements ZipInputFile {\n  filename: string;\n  crc: number;\n  size: number;\n  compression: number;\n  flag: 0 | 1 | 2 | 3;\n  os?: number;\n  attrs?: number;\n  comment?: string;\n  extra?: Record<number, Uint8Array>;\n  mtime?: GzipOptions['mtime'];\n  ondata: AsyncFlateStreamHandler;\n  private d: Deflate;\n\n  /**\n   * Creates a DEFLATE stream that can be added to ZIP archives\n   * @param filename The filename to associate with this data stream\n   * @param opts The compression options\n   */\n  constructor(filename: string, opts?: DeflateOptions) {\n    if (!opts) opts = {};\n    ZipPassThrough.call(this, filename);\n    this.d = new Deflate(opts, (dat, final) => {\n      this.ondata(null, dat, final);\n    });\n    this.compression = 8;\n    this.flag = dbf(opts.level);\n  }\n  \n  process(chunk: Uint8Array, final: boolean) {\n    try {\n      this.d.push(chunk, final);\n    } catch(e) {\n      this.ondata(e, null, final);\n    }\n  }\n\n  /**\n   * Pushes a chunk to be deflated\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    ZipPassThrough.prototype.push.call(this, chunk, final);\n  }\n}\n\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nexport class AsyncZipDeflate implements ZipInputFile {\n  filename: string;\n  crc: number;\n  size: number;\n  compression: number;\n  flag: 0 | 1 | 2 | 3;\n  os?: number;\n  attrs?: number;\n  comment?: string;\n  extra?: Record<number, Uint8Array>;\n  mtime?: GzipOptions['mtime'];\n  ondata: AsyncFlateStreamHandler;\n  private d: AsyncDeflate;\n  terminate: AsyncTerminable;\n\n  /**\n   * Creates a DEFLATE stream that can be added to ZIP archives\n   * @param filename The filename to associate with this data stream\n   * @param opts The compression options\n   */\n  constructor(filename: string, opts?: DeflateOptions) {\n    if (!opts) opts = {};\n    ZipPassThrough.call(this, filename);\n    this.d = new AsyncDeflate(opts, (err, dat, final) => {\n      this.ondata(err, dat, final);\n    });\n    this.compression = 8;\n    this.flag = dbf(opts.level);\n    this.terminate = this.d.terminate;\n  }\n  \n  process(chunk: Uint8Array, final: boolean) {\n    this.d.push(chunk, final);\n  }\n\n  /**\n   * Pushes a chunk to be deflated\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    ZipPassThrough.prototype.push.call(this, chunk, final);\n  }\n}\n\ntype ZIFE = {\n  // compressed size\n  c: number;\n  // filename\n  f: Uint8Array;\n  // comment\n  o?: Uint8Array;\n  // unicode\n  u: boolean;\n  // byte offset\n  b: number;\n  // header offset\n  h: number;\n  // terminator\n  t: () => void;\n  // turn\n  r: () => void;\n};\n\ntype ZipInternalFile = ZHF & ZIFE;\n\n// TODO: Better tree shaking\n\n/**\n * A zippable archive to which files can incrementally be added\n */\nexport class Zip {\n  private u: ZipInternalFile[];\n  private d: number;\n\n  /**\n   * Creates an empty ZIP archive to which files can be added\n   * @param cb The callback to call whenever data for the generated ZIP archive\n   *           is available\n   */\n  constructor(cb?: AsyncFlateStreamHandler) {\n    this.ondata = cb;\n    this.u = [];\n    this.d = 1;\n  }\n  /**\n   * Adds a file to the ZIP archive\n   * @param file The file stream to add\n   */\n  add(file: ZipInputFile) {\n    if (!this.ondata) err(5);\n    // finishing or finished\n    if (this.d & 2) this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n    else {\n      const f = strToU8(file.filename), fl = f.length;\n      const com = file.comment, o = com && strToU8(com);\n      const u = fl != file.filename.length || (o && (com.length != o.length));\n      const hl = fl + exfl(file.extra) + 30;\n      if (fl > 65535) this.ondata(err(11, 0, 1), null, false);\n      const header = new u8(hl);\n      wzh(header, 0, file, f, u);\n      let chks: Uint8Array[] = [header];\n      const pAll = () => {\n        for (const chk of chks) this.ondata(null, chk, false);\n        chks = [];\n      };\n      let tr = this.d;\n      this.d = 0;\n      const ind = this.u.length;\n      const uf = mrg(file, {\n        f,\n        u,\n        o,\n        t: () => { \n          if (file.terminate) file.terminate();\n        },\n        r: () => {\n          pAll();\n          if (tr) {\n            const nxt = this.u[ind + 1];\n            if (nxt) nxt.r();\n            else this.d = 1;\n          }\n          tr = 1;\n        }\n      } as ZIFE);\n      let cl = 0;\n      file.ondata = (err, dat, final) => {\n        if (err) {\n          this.ondata(err, dat, final);\n          this.terminate();\n        } else {\n          cl += dat.length;\n          chks.push(dat);\n          if (final) {\n            const dd = new u8(16);\n            wbytes(dd, 0, 0x8074B50)\n            wbytes(dd, 4, file.crc);\n            wbytes(dd, 8, cl);\n            wbytes(dd, 12, file.size);\n            chks.push(dd);\n            uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n            if (tr) uf.r();\n            tr = 1;\n          } else if (tr) pAll();\n        }\n      }\n      this.u.push(uf);\n    }\n  }\n\n  /**\n   * Ends the process of adding files and prepares to emit the final chunks.\n   * This *must* be called after adding all desired files for the resulting\n   * ZIP file to work properly.\n   */\n  end() {\n    if (this.d & 2) {\n      this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n      return;\n    }\n    if (this.d) this.e();\n    else this.u.push({\n      r: () => {\n        if (!(this.d & 1)) return;\n        this.u.splice(-1, 1);\n        this.e();\n      },\n      t: () => {}\n    } as unknown as ZipInternalFile);\n    this.d = 3;\n  }\n\n  private e() {\n    let bt = 0, l = 0, tl = 0;\n    for (const f of this.u) tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n    const out = new u8(tl + 22);\n    for (const f of this.u) {\n      wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n      bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n    }\n    wzf(out, bt, this.u.length, tl, l)\n    this.ondata(null, out, true);\n    this.d = 2;\n  }\n\n  /**\n   * A method to terminate any internal workers used by the stream. Subsequent\n   * calls to add() will fail.\n   */\n  terminate() {\n    for (const f of this.u) f.t();\n    this.d = 2;\n  }\n\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n}\n\n/**\n * Asynchronously creates a ZIP file\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @param cb The callback to call with the generated ZIP archive\n * @returns A function that can be used to immediately terminate the compression\n */\nexport function zip(data: AsyncZippable, opts: AsyncZipOptions, cb: FlateCallback): AsyncTerminable;\n/**\n * Asynchronously creates a ZIP file\n * @param data The directory structure for the ZIP archive\n * @param cb The callback to call with the generated ZIP archive\n * @returns A function that can be used to immediately terminate the compression\n */\nexport function zip(data: AsyncZippable, cb: FlateCallback): AsyncTerminable;\nexport function zip(data: AsyncZippable, opts: AsyncZipOptions | FlateCallback, cb?: FlateCallback) {\n  if (!cb) cb = opts as FlateCallback, opts = {};\n  if (typeof cb != 'function') err(7);\n  const r: FlatZippable<true> = {};\n  fltn(data, '', r, opts as AsyncZipOptions);\n  const k = Object.keys(r);\n  let lft = k.length, o = 0, tot = 0;\n  const slft = lft, files = new Array<AsyncZipDat>(lft);\n  const term: AsyncTerminable[] = [];\n  const tAll = () => {\n    for (let i = 0; i < term.length; ++i) term[i]();\n  }\n  let cbd: FlateCallback = (a, b) => {\n    mt(() => { cb(a, b); });\n  }\n  mt(() => { cbd = cb; });\n  const cbf = () => {\n    const out = new u8(tot + 22), oe = o, cdl = tot - o;\n    tot = 0;\n    for (let i = 0; i < slft; ++i) {\n      const f = files[i];\n      try {\n        const l = f.c.length;\n        wzh(out, tot, f, f.f, f.u, l);\n        const badd = 30 + f.f.length + exfl(f.extra);\n        const loc = tot + badd;\n        out.set(f.c, loc);\n        wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n      } catch(e) {\n        return cbd(e, null);\n      }\n    }\n    wzf(out, o, files.length, cdl, oe);\n    cbd(null, out);\n  }\n  if (!lft) cbf();\n  // Cannot use lft because it can decrease\n  for (let i = 0; i < slft; ++i) {\n    const fn = k[i];\n    const [file, p] = r[fn];\n    const c = crc(), size = file.length;\n    c.p(file);\n    const f = strToU8(fn), s = f.length;\n    const com = p.comment, m = com && strToU8(com), ms = m && m.length;\n    const exl = exfl(p.extra);\n    const compression = p.level == 0 ? 0 : 8;\n    const cbl: FlateCallback = (e, d) => {\n      if (e) {\n        tAll();\n        cbd(e, null);\n      } else {\n        const l = d.length;\n        files[i] = mrg(p, {\n          size,\n          crc: c.d(),\n          c: d,\n          f,\n          m,\n          u: s != fn.length || (m && (com.length != ms)),\n          compression\n        });\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n        if (!--lft) cbf();\n      }\n    }\n    if (s > 65535) cbl(err(11, 0, 1), null);\n    if (!compression) cbl(null, file);\n    else if (size < 160000) {\n      try {\n        cbl(null, deflateSync(file, p));\n      } catch(e) {\n        cbl(e, null);\n      }\n    } else term.push(deflate(file, p, cbl));\n  }\n  return tAll;\n}\n\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data: Zippable, opts?: ZipOptions) {\n  if (!opts) opts = {};\n  const r: FlatZippable<false> = {};\n  const files: ZipDat[] = [];\n  fltn(data, '', r, opts);\n  let o = 0;\n  let tot = 0;\n  for (const fn in r) {\n    const [file, p] = r[fn];\n    const compression = p.level == 0 ? 0 : 8;\n    const f = strToU8(fn), s = f.length;\n    const com = p.comment, m = com && strToU8(com), ms = m && m.length;\n    const exl = exfl(p.extra);\n    if (s > 65535) err(11);\n    const d = compression ? deflateSync(file, p) : file, l = d.length;\n    const c = crc();\n    c.p(file);\n    files.push(mrg(p, {\n      size: file.length,\n      crc: c.d(),\n      c: d,\n      f,\n      m,\n      u: s != fn.length || (m && (com.length != ms)),\n      o,\n      compression\n    }));\n    o += 30 + s + exl + l;\n    tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n  }\n  const out = new u8(tot + 22), oe = o, cdl = tot - o;\n  for (let i = 0; i < files.length; ++i) {\n    const f = files[i];\n    wzh(out, f.o, f, f.f, f.u, f.c.length);\n    const badd = 30 + f.f.length + exfl(f.extra);\n    out.set(f.c, f.o + badd);\n    wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n  }\n  wzf(out, o, files.length, cdl, oe);\n  return out;\n}\n\n/**\n * A decoder for files in ZIP streams\n */\nexport interface UnzipDecoder {  \n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n  \n  /**\n   * Pushes a chunk to be decompressed\n   * @param data The data in this chunk. Do not consume (detach) this data.\n   * @param final Whether this is the last chunk in the data stream\n   */\n  push(data: Uint8Array, final: boolean): void;\n\n  /**\n   * A method to terminate any internal workers used by the stream. Subsequent\n   * calls to push() should silently fail.\n   */\n  terminate?: AsyncTerminable\n}\n\n/**\n * A constructor for a decoder for unzip streams\n */\nexport interface UnzipDecoderConstructor {\n  /**\n   * Creates an instance of the decoder\n   * @param filename The name of the file\n   * @param size The compressed size of the file\n   * @param originalSize The original size of the file\n   */\n  new(filename: string, size?: number, originalSize?: number): UnzipDecoder;\n\n  /**\n   * The compression format for the data stream. This number is determined by\n   * the spec in PKZIP's APPNOTE.txt, section 4.4.5. For example, 0 = no\n   * compression, 8 = deflate, 14 = LZMA\n   */\n  compression: number;\n}\n\n/**\n * Streaming file extraction from ZIP archives\n */\nexport interface UnzipFile {\n  /**\n   * The handler to call whenever data is available\n   */\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * The name of the file\n   */\n  name: string;\n\n  /**\n   * The compression format for the data stream. This number is determined by\n   * the spec in PKZIP's APPNOTE.txt, section 4.4.5. For example, 0 = no\n   * compression, 8 = deflate, 14 = LZMA. If start() is called but there is no\n   * decompression stream available for this method, start() will throw.\n   */\n  compression: number;\n\n  /**\n   * The compressed size of the file\n   */\n  size?: number;\n\n  /**\n   * The original size of the file\n   */\n  originalSize?: number;\n\n  /**\n   * Starts reading from the stream. Calling this function will always enable\n   * this stream, but ocassionally the stream will be enabled even without\n   * this being called.\n   */\n  start(): void;\n\n  /**\n   * A method to terminate any internal workers used by the stream. ondata\n   * will not be called any further.\n   */\n  terminate: AsyncTerminable\n}\n\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nexport class UnzipPassThrough implements UnzipDecoder {\n  static compression = 0;\n  ondata: AsyncFlateStreamHandler;\n  push(data: Uint8Array, final: boolean) {\n    this.ondata(null, data, final);\n  }\n}\n\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nexport class UnzipInflate implements UnzipDecoder {\n  static compression = 8;\n  private i: Inflate;\n  ondata: AsyncFlateStreamHandler;\n\n  /**\n   * Creates a DEFLATE decompression that can be used in ZIP archives\n   */\n  constructor() {\n    this.i = new Inflate((dat, final) => {\n      this.ondata(null, dat, final);\n    });\n  }\n\n  push(data: Uint8Array, final: boolean) {\n    try {\n      this.i.push(data, final);\n    } catch(e) {\n      this.ondata(e, data, final);\n    }\n  }\n}\n\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nexport class AsyncUnzipInflate implements UnzipDecoder {\n  static compression = 8;\n  private i: AsyncInflate | Inflate;\n  ondata: AsyncFlateStreamHandler;\n  terminate: AsyncTerminable;\n\n  /**\n   * Creates a DEFLATE decompression that can be used in ZIP archives\n   */\n  constructor(_: string, sz?: number) {\n    if (sz < 320000) {\n      this.i = new Inflate((dat, final) => {\n        this.ondata(null, dat, final);\n      });\n    } else {\n      this.i = new AsyncInflate((err, dat, final) => {\n        this.ondata(err, dat, final);\n      });\n      this.terminate = this.i.terminate;\n    }\n  }\n\n  push(data: Uint8Array, final: boolean) {\n    if ((this.i as AsyncInflate).terminate) data = slc(data, 0);\n    this.i.push(data, final);\n  }\n}\n\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nexport class Unzip {\n  private d: UnzipDecoder;\n  private c: number;\n  private p: Uint8Array;\n  private k: Uint8Array[][];\n  private o: Record<number, UnzipDecoderConstructor>;\n\n  /**\n   * Creates a ZIP decompression stream\n   * @param cb The callback to call whenever a file in the ZIP archive is found\n   */\n  constructor(cb?: UnzipFileHandler) {\n    this.onfile = cb;\n    this.k = [];\n    this.o = {\n      0: UnzipPassThrough\n    };\n    this.p = et;\n  }\n  \n  /**\n   * Pushes a chunk to be unzipped\n   * @param chunk The chunk to push\n   * @param final Whether this is the last chunk\n   */\n  push(chunk: Uint8Array, final?: boolean) {\n    if (!this.onfile) err(5);\n    if (!this.p) err(4);\n    if (this.c > 0) {\n      const len = Math.min(this.c, chunk.length);\n      const toAdd = chunk.subarray(0, len);\n      this.c -= len;\n      if (this.d) this.d.push(toAdd, !this.c);\n      else this.k[0].push(toAdd);\n      chunk = chunk.subarray(len);\n      if (chunk.length) return this.push(chunk, final);\n    } else {\n      let f = 0, i = 0, is: number, buf: Uint8Array;\n      if (!this.p.length) buf = chunk;\n      else if (!chunk.length) buf = this.p;\n      else {\n        buf = new u8(this.p.length + chunk.length)\n        buf.set(this.p), buf.set(chunk, this.p.length);\n      }\n      const l = buf.length, oc = this.c, add = oc && this.d;\n      for (; i < l - 4; ++i) {\n        const sig = b4(buf, i);\n        if (sig == 0x4034B50) {\n          f = 1, is = i;\n          this.d = null;\n          this.c = 0;\n          const bf = b2(buf, i + 6), cmp = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n          if (l > i + 30 + fnl + es) {\n            const chks: Uint8Array[] = [];\n            this.k.unshift(chks);\n            f = 2;\n            let sc = b4(buf, i + 18), su = b4(buf, i + 22);\n            const fn = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n            if (sc == 4294967295) { [sc, su] = dd ? [-2] : z64e(buf, i); }\n            else if (dd) sc = -1;\n            i += es;\n            this.c = sc;\n            let d: UnzipDecoder;\n            const file = {\n              name: fn,\n              compression: cmp,\n              start: () => {\n                if (!file.ondata) err(5);\n                if (!sc) file.ondata(null, et, true);\n                else {\n                  const ctr = this.o[cmp];\n                  if (!ctr) file.ondata(err(14, 'unknown compression type ' + cmp, 1), null, false);\n                  d = sc < 0 ? new ctr(fn) : new ctr(fn, sc, su);\n                  d.ondata = (err, dat, final) => { file.ondata(err, dat, final); }\n                  for (const dat of chks) d.push(dat, false);\n                  if (this.k[0] == chks && this.c) this.d = d;\n                  else d.push(et, true);\n                }\n              },\n              terminate: () => {\n                if (d && d.terminate) d.terminate();\n              }\n            } as UnzipFile;\n            if (sc >= 0) file.size = sc, file.originalSize = su;\n            this.onfile(file);\n          }\n          break;\n        } else if (oc) {\n          if (sig == 0x8074B50) {\n            is = i += 12 + (oc == -2 && 8), f = 3, this.c = 0;\n            break;\n          } else if (sig == 0x2014B50) {\n            is = i -= 4, f = 3, this.c = 0;\n            break;\n          }\n        }\n      }\n      this.p = et\n      if (oc < 0) {\n        const dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n        if (add) add.push(dat, !!f);\n        else this.k[+(f == 2)].push(dat);\n      }\n      if (f & 2) return this.push(buf.subarray(i), final);\n      this.p = buf.subarray(i);\n    }\n    if (final) {\n      if (this.c) err(13);\n      this.p = null;\n    }\n  }\n\n  /**\n   * Registers a decoder with the stream, allowing for files compressed with\n   * the compression type provided to be expanded correctly\n   * @param decoder The decoder constructor\n   */\n  register(decoder: UnzipDecoderConstructor) {\n    this.o[decoder.compression] = decoder;\n  }\n\n  /**\n   * The handler to call whenever a file is discovered\n   */\n  onfile: UnzipFileHandler;\n}\n\nconst mt = typeof queueMicrotask == 'function' ? queueMicrotask : setTimeout;\n\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data: Uint8Array, cb: UnzipCallback): AsyncTerminable {\n  if (typeof cb != 'function') err(7);\n  const term: AsyncTerminable[] = [];\n  const tAll = () => {\n    for (let i = 0; i < term.length; ++i) term[i]();\n  }\n  const files: Unzipped = {};\n  let cbd: UnzipCallback = (a, b) => {\n    mt(() => { cb(a, b); });\n  }\n  mt(() => { cbd = cb; });\n  let e = data.length - 22;\n  for (; b4(data, e) != 0x6054B50; --e) {\n    if (!e || data.length - e > 65558) {\n      cbd(err(13, 0, 1), null);\n      return tAll;\n    }\n  };\n  let lft = b2(data, e + 8);\n  if (lft) {\n    let c = lft;\n    let o = b4(data, e + 16);\n    const z = o == 4294967295;\n    if (z) {\n      e = b4(data, e - 12);\n      if (b4(data, e) != 0x6064B50) {\n        cbd(err(13, 0, 1), null);\n        return tAll;\n      }\n      c = lft = b4(data, e + 32);\n      o = b4(data, e + 48);\n    }\n    for (let i = 0; i < c; ++i) {\n      const [c, sc, su, fn, no, off] = zh(data, o, z), b = slzh(data, off);\n      o = no\n      const cbl: FlateCallback = (e, d) => {\n        if (e) {\n          tAll();\n          cbd(e, null);\n        } else {\n          files[fn] = d;\n          if (!--lft) cbd(null, files);\n        }\n      }\n      if (!c) cbl(null, slc(data, b, b + sc))\n      else if (c == 8) {\n        const infl = data.subarray(b, b + sc);\n        if (sc < 320000) {\n          try {\n            cbl(null, inflateSync(infl, new u8(su)));\n          } catch(e) {\n            cbl(e, null);\n          }\n        }\n        else term.push(inflate(infl, { size: su }, cbl));\n      } else cbl(err(14, 'unknown compression type ' + c, 1), null);\n    }\n  } else cbd(null, {});\n  return tAll;\n}\n\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data: Uint8Array) {\n  const files: Unzipped = {};\n  let e = data.length - 22;\n  for (; b4(data, e) != 0x6054B50; --e) {\n    if (!e || data.length - e > 65558) err(13);\n  };\n  let c = b2(data, e + 8);\n  if (!c) return {};\n  let o = b4(data, e + 16);\n  const z = o == 4294967295;\n  if (z) {\n    e = b4(data, e - 12);\n    if (b4(data, e) != 0x6064B50) err(13);\n    c = b4(data, e + 32);\n    o = b4(data, e + 48);\n  }\n  for (let i = 0; i < c; ++i) {\n    const [c, sc, su, fn, no, off] = zh(data, o, z), b = slzh(data, off);\n    o = no;\n    if (!c) files[fn] = slc(data, b, b + sc);\n    else if (c == 8) files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n    else err(14, 'unknown compression type ' + c);\n  }\n  return files;\n}","import { eventWithTime } from '../types';\n\nexport type PackFn = (event: eventWithTime) => string;\nexport type UnpackFn = (raw: string) => eventWithTime;\n\nexport type eventWithTimeAndPacker = eventWithTime & {\n  v: string;\n};\n\nexport const MARK = 'v1';\n","// @ts-nocheck\n\nimport { strFromU8, strToU8, zlibSync } from '../fflate';\nimport { PackFn, MARK, eventWithTimeAndPacker } from './base';\n\nexport const pack: PackFn = (event) => {\n  const _e: eventWithTimeAndPacker = {\n    ...event,\n    v: MARK,\n  };\n  return strFromU8(zlibSync(strToU8(JSON.stringify(_e))), true);\n};\n","import { strFromU8, strToU8, unzlibSync } from '../fflate';\nimport { UnpackFn, eventWithTimeAndPacker, MARK } from './base';\nimport { eventWithTime } from '../types';\n\nexport const unpack: UnpackFn = (raw: string) => {\n  if (typeof raw !== 'string') {\n    return raw;\n  }\n  try {\n    const e: eventWithTime = JSON.parse(raw);\n    if (e.timestamp) {\n      return e;\n    }\n  } catch (error) {\n    // ignore and continue\n  }\n  try {\n    const e: eventWithTimeAndPacker = JSON.parse(\n      strFromU8(unzlibSync(strToU8(raw, true)))\n    );\n    if (e.v === MARK) {\n      return e;\n    }\n    throw new Error(\n      `These events were packed with packer ${e.v} which is incompatible with current packer ${MARK}.`,\n    );\n  } catch (error) {\n    console.error(error);\n    throw new Error('Unknown data format.');\n  }\n};\n","export { pack } from './pack';\nexport { unpack } from './unpack';\n","import { AskLevel } from \"../types/types\"\nimport { config } from \"../config/config\"\nimport { W } from \"../constants\"\nimport record from \"../rrweb/record\"\nimport { pack } from \"../rrweb/packer\"\nimport { eventWithTime } from \"../rrweb/types\"\nimport { warn } from \"../utils/console\"\n/**\n * Error Trap\n */\n\nexport default class ErrorTrace {\n  private static instance: ErrorTrace | null = null\n  private eventsMatrix: Array<Array<eventWithTime>> = [[]]\n\n  private constructor() {\n    this.globalErrorTrace()\n    this.networkErrorTrace()\n    this.promiseErrorTrace()\n    this.iframeErrorTrace()\n    record({\n      ...config.recordOptions,\n      emit: (event, isCheckout) => {\n        if (isCheckout) {\n          this.eventsMatrix.push([]);\n        }\n        const lastEvents = this.eventsMatrix[this.eventsMatrix.length - 1];\n        lastEvents.push(event);\n      },\n      recordLog: false,\n      checkoutEveryNth: 10,\n      packFn: pack,\n    })\n  }\n\n  public static getInstance(): ErrorTrace {\n    if (!this.instance) {\n      this.instance = new ErrorTrace()\n    }\n    return this.instance\n  }\n\n  /**\n   * Globally catch synchronous or asynchronous errors\n   * 捕获异常的能力比try-catch稍微强点，无论是异步还是非异步，onerror都能捕获到运行时错误，返回true就不回报红\n   * 当时当<img src=\"\" />这种情况是捕获不到的\n   * 使用未使用的变量\n   */\n  private globalErrorTrace(): void {\n    W.onerror = (\n      event: Event | string,\n      source?: string,\n      lineno?: number,\n      colno?: number,\n      error?: Error\n    ) => {\n\n      warn({\n        source,\n        lineno,\n        colno,\n        error,\n      })\n\n      const len = this.eventsMatrix.length;\n\n      if (config.errEventRoute && len >= 2) {\n        const events = this.eventsMatrix[len - 2].concat(this.eventsMatrix[len - 1]);\n        config.reportData?.fetch(\n          AskLevel.IDLE,\n          JSON.stringify({ events }),\n          config.errEventRoute\n        )\n      }\n\n      if (config.errLogRoute) {\n        config.reportData?.fetch(\n          AskLevel.IDLE,\n          JSON.stringify({\n            source,\n            lineno,\n            colno,\n            error: JSON.stringify({\n              message: error?.message,\n              stack: error?.stack,\n              name: error?.name,\n            }),\n          }),\n          config.errLogRoute\n        )\n      }\n      return true\n    }\n  }\n  /**\n   * Catch network errors\n   * 图片加载失败等\n   */\n  private networkErrorTrace(): void {\n    W.addEventListener(\n      \"error\",\n      (e: ErrorEvent) => {\n        if (e.target !== W) {\n          warn(e.target)\n        }\n      },\n      true\n    )\n  }\n\n  /**\n   * Catching Promise errors\n   */\n  private promiseErrorTrace(): void {\n    window.addEventListener(\"unhandledrejection\", (e) => {\n      e.preventDefault()\n      warn(e.reason)\n      return true\n    })\n  }\n\n  private iframeErrorTrace(): void {\n    const frames = W.frames\n    for (let i = 0; i < frames.length; i++) {\n      frames[i].addEventListener(\n        \"error\",\n        (e: ErrorEvent) => {\n          warn(e)\n        },\n        true\n      )\n      frames[i].addEventListener(\n        \"unhandledrejection\",\n        (e) => {\n          warn(e)\n        },\n        true\n      )\n    }\n  }\n}\n","import { AskLevel, ReportDataAchieve } from \"../types/types\"\nimport { W, WN } from \"../constants\"\nimport { config } from \"../config/config\"\n\nexport interface ReportDataOptions {\n  logDomain: string | undefined,\n}\n\n/**\n * Log collection\n * 日志收集\n */\nexport default class ReportData implements ReportDataAchieve {\n  /**\n   * Log report, error report\n   * If the level is urgent, use http request directly, otherwise use navigator.sendBeacon\n   * 日志上报、错误上报\n   * 如果level很紧急，直接使用http请求，否者使用navigator.sendBeacon\n   * @param level\n   * @param body \n   * @param uri \n   */\n  public fetch(level: AskLevel, body: string, uri: string): void {\n    uri = config.fetchDomain + uri\n\n    switch (level) {\n      case AskLevel.URGENT: {\n        if (!!W.fetch) {\n          fetch(uri, { body, method: \"POST\", keepalive: true })\n        } else {\n          let xhr: XMLHttpRequest | null = new XMLHttpRequest()\n          xhr.open(\"post\", uri, true)\n          xhr.setRequestHeader(\"Content-Type\", \"application/json\")\n          xhr.send(body)\n          xhr.onload = () => xhr = null // 防止内存泄漏\n        }\n        return\n      }\n      default:\n        if (!!WN.sendBeacon) {\n          navigator.sendBeacon(uri, body)\n        } else {\n          let image: HTMLImageElement | null = new Image()\n          image.src = `${uri}?body=${body}`\n          image.onload = () => image = null // 防止内存泄漏\n        }\n    }\n  }\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = require(\"regenerator-runtime\");\n","import { W, WP } from \"../constants\"\n\n/**\n * Determine whether the browser supports getEntriesByType\n * @returns \n */\nexport const isPerformanceSupported = (): boolean => {\n  return WP && !!WP.getEntriesByType && !!WP.now && !!WP.mark\n}\n\n/**\n * bytes to kb\n * @param {number} bytes\n */\nexport const bytes2kb = (bytes: number) => {\n  return parseFloat((bytes / Math.pow(1024, 2)).toFixed(2))\n}\n\n/**\n * Keep two decimal places\n * @param {number} num\n * @returns \n */\nexport const roundByTwo = (num: number) => {\n  return parseFloat(num.toFixed(2))\n}\n\n/**\n * PushTask to requestIdleCallback\n * Efficient use of each frame for data collection\n * @param {() => void} callback\n */\nexport const pushTask = (callback: () => void) => {\n  if (\"requestIdleCallback\" in W) {\n    (W as any).requestIdleCallback(callback, { timeout: 3000 })\n  } else {\n    callback()\n  }\n}","import { bytes2kb } from \"../utils/helper\"\nimport { WN } from \"../constants\"\nimport type { StorageOpt } from \"../types/types\"\n\n/**\n  * Record local cache information\n*/\n\nexport const recordingStorage = async (): Promise<StorageOpt> => {\n  const { quota, usage, usageDetails } = await WN.storage.estimate() as StorageOpt\n  let res = {\n    quota: bytes2kb(quota || 0),\n    usage: bytes2kb(usage || 0),\n    usageDetails,\n  }\n  if (res.usageDetails) {\n    Object.keys(res.usageDetails || {}).forEach(key => res.usageDetails[key] = bytes2kb(res.usageDetails[key]))\n  }\n  return res\n}","module.exports = {\n  \"name\": \"mini-pm\",\n  \"version\": \"1.0.0\",\n  \"description\": \"一款mini性能优化监控平台\",\n  \"source\": \"src/index.ts\",\n  \"main\": \"dist/mini-pm.js\",\n  \"exports\": \"./dist/mini-pm.modern.js\",\n  \"module\": \"dist/mini-pm.module.js\",\n  \"types\": \"dist/typings/index.d.ts\",\n  \"unpkg\": \"dist/mini-pm.umd.js\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"build\": \"microbundle && npm run api:run && npm run api:doc\",\n    \"dev\": \"microbundle watch\",\n    \"example\": \"parcel serve ./examples/index.html -p 12345\",\n    \"api:init\": \"api-extractor init\",\n    \"api:run\": \"api-extractor run --local --verbose\",\n    \"api:doc\": \"typedoc --out docs src\"\n  },\n  \"devDependencies\": {\n    \"@babel/core\": \"^7.14.0\",\n    \"@babel/plugin-transform-runtime\": \"^7.13.15\",\n    \"@microsoft/api-extractor\": \"^7.15.2\",\n    \"@types/css-font-loading-module\": \"^0.0.4\",\n    \"microbundle\": \"^0.13.0\",\n    \"parcel-bundler\": \"^1.12.5\",\n    \"scripty\": \"^2.0.0\",\n    \"typedoc\": \"^0.20.36\"\n  },\n  \"dependencies\": {\n    \"fflate\": \"^0.7.0\",\n    \"performance\": \"^1.4.0\",\n    \"rrweb-snapshot\": \"^1.1.3\",\n    \"src\": \"^1.1.2\",\n    \"types\": \"^0.1.1\"\n  }\n}\n;","import { WN } from \"../constants\"\nimport type { EffectiveType, NavigatorOpt } from \"../types/types\"\nimport { pushTask } from \"../utils/helper\"\n\nexport let effectiveType: EffectiveType = \"4g\"\nexport let saveData: boolean = false\n\n/**\n   * Get user's browser information, internet speed and other information\n   * Calculating network speed formula\n   * T1 = DNS + New Connection(TCP) + RTT(One-time transmission)\n   * T2 = New Connection(TCP) + RTT(One-time transmission)\n   * T3 = RTT(One-time transmission)\n   * bandwidth = (100k-50k)/(t5-t4)\n   * @return {NavigatorOpt}\n   */\nexport const recordClientNavigator = async (): Promise<NavigatorOpt> => {\n  return new Promise(resolve => {\n    let res = {} as NavigatorOpt\n    if (\"connection\" in WN) {\n      res.connection = {\n        downlink: WN.connection.downlink,\n        effectiveType: WN.connection.effectiveType,\n        rtt: WN.connection.rtt,\n        saveData: WN.connection.saveData,\n      }\n      saveData = res.connection.saveData || saveData\n      effectiveType = res.connection.effectiveType || effectiveType\n    }\n    // Doppler Velocity\n    if (\"fetch\" in window) {\n      pushTask(async () => {\n        let times = []\n        const sizes = [0, 0, 0, 50, 100]\n        const fetchs = sizes.map(i => (() => new Promise(async resolve => {\n          await fetch(`http://performance-monitoring.zhourengui.top/performance-monitoring/doppler-velocity?size=${i}`)\n          resolve(true)\n        })))\n\n        times.push(+ new Date())\n\n        while (fetchs.length) {\n          const f = fetchs.shift()\n          await f?.()\n          times.push(+ new Date())\n        }\n        res.connection.bandwidth = `${((sizes[4] - sizes[3]) / ((times[5] - times[4]) / 1000)).toFixed(2)} k/s`\n        resolve(res)\n      })\n    }\n\n    res.userAgent = WN.userAgent\n  })\n}","import { WP } from \"../constants\"\nimport { isPerformanceSupported } from \"../utils/helper\"\nimport type { TimingOpt } from \"../types/types\"\n/**\n  * Navigation Timing API provides performance metrics for HTML documents.\n  * w3c.github.io/navigation-timing/\n  * developers.google.com/web/fundamentals/performance/navigation-and-resource-timing\n  */\nexport const recordTiming = async (): Promise<TimingOpt> => {\n  let res = {} as TimingOpt\n  if (isPerformanceSupported()) {\n    // There is an open issue to type correctly getEntriesByType\n    // github.com/microsoft/TypeScript/issues/33866\n    const n = WP.getEntriesByType(\"navigation\")[0] as any\n    if (n) {\n      const responseEnd = n.responseEnd\n      const responseStart = n.responseStart\n      const requestStart = n.requestStart\n      res = {\n        // fetchStart marks when the browser starts to fetch a resource\n        // responseEnd is when the last byte of the response arrives\n        fetchTime: responseEnd - n.fetchStart,\n        // Service worker time plus response time\n        workerTime: responseEnd - n.workerStart,\n        // Request plus response time (network only)\n        networkTime: responseEnd - requestStart,\n        // Response time only (download)\n        downloadTime: responseEnd - responseStart,\n        // Time to First Byte (TTFB)\n        timeToFirstByte: responseStart - requestStart,\n        // HTTP header size\n        headerSize: n.decodedBodySize - n.transferSize || 0,\n        // DNS Lookup Time\n        dnsLookupTime: n.domainLookupStart - n.domainLookupEnd,\n        // TCP time\n        tcpTime: n.connectStart - n.connectEnd || 0,\n        // First paint\n        firstPaintTime: responseEnd - responseStart || 0,\n        // Dom Parse Time\n        domParseTime: n.domComplete - n.domInteractive,\n        // Dom Render Time\n        domRenderTime: n.domContentLoadedEventEnd - n.domContentLoadedEventStart || 0,\n        // onload time\n        onloadTime: n.loadEventEnd - n.loadEventStart\n      }\n    }\n  }\n\n  return res\n}","import { WN } from \"../constants\"\nimport { effectiveType, saveData } from \"../performance/record-client-navigator\"\nimport { EffectiveType, NavigatorInformation } from \"../types/types\"\n\nexport const isLowEndDevice = (): boolean => {\n  return WN.deviceMemory <= 4 || WN.hardwareConcurrency <= 4\n}\n\nexport const isLowEndExperience = (\n  effectiveType: EffectiveType,\n  saveData: boolean\n): boolean => {\n  if ([\"slow-2g\", \"2g\", \"3g\"].includes(effectiveType)) {\n    return true\n  }\n\n  return isLowEndDevice() || saveData\n}\n\n/**\n * 信息来源于 window.navigator:\n * 1. Device Memory 设备内存\n * 2. Hardware Concurency 并发数\n * 3. Status of the service worker:\n *     - controlled: a service worker is controlling the page\n *     - supported: the browser supports service worker\n *     - unsupported: the user's browser does not support service worker\n */\nexport const getNavigatorInformation = (): NavigatorInformation | undefined => {\n  if (WN) {\n    return {\n      deviceMemory: WN.deviceMemory || 0,\n      hardwareConcurrency: WN.hardwareConcurrency || 0,\n      serviceWorkerStatus:\n        'serviceWorker' in WN\n          ? WN.serviceWorker?.controller\n            ? \"controlled\"\n            : \"supported\"\n          : \"unsupported\",\n      isLowEndDevice: isLowEndDevice(),\n      isLowEndExperience: isLowEndExperience(effectiveType, saveData)\n    }\n  }\n}","import { NavigatorOpt, TimingOpt, VitalsScore } from \"../types/types\";\n\n/**\n * https://web.dev/vitals/\n * https://web.dev/cls/\n */\nconst fcpScore = [1000, 2500];\nconst lcpScore = [2500, 4000];\nconst fidcore = [100, 300];\nconst clsScore = [0.1, 0.25];\nconst tbtScore = [300, 600];\n\nexport const webVitalsScore: Record<string, number[]> = {\n  fp: fcpScore,\n  fcp: fcpScore,\n  lcp: lcpScore,\n  lcpFinal: lcpScore,\n  fid: fidcore,\n  fidVitals: fidcore,\n  cls: clsScore,\n  clsFinal: clsScore,\n  tbt: tbtScore,\n  tbt5S: tbtScore,\n  tbt10S: tbtScore,\n  tbtFinal: tbtScore,\n};\n\nexport const getVitalsScore = (\n  measureName: string,\n  value: number\n): VitalsScore => {\n  if (!webVitalsScore[measureName]) {\n    return null\n  }\n\n  if (value <= webVitalsScore[measureName][0]) {\n    return \"good\"\n  }\n\n  return value <= webVitalsScore[measureName][1] ? \"needsImprovement\" : \"poor\"\n}","import { config } from \"../config/config\"\nimport { D } from \"../constants\"\nimport { NavigatorOpt, TimingOpt } from \"../types/types\"\nimport { pushTask } from \"./helper\"\nimport { getNavigatorInformation } from \"./navigator-information\"\nimport { getVitalsScore } from \"./vitals-score\"\n\n/**\n * Sends the User timing measure to analyticsTracker\n * Do not report specific data when the page is hidden\n * @param {string} measureName\n * @param {number} duration\n * @param {object} eventProperties\n */\nexport const reportPerformance = (\n  data: TimingOpt | number | NavigatorOpt | any,\n  measureName: string,\n  eventProperties?: object\n): void => {\n  pushTask(() => {\n    if (D.visibilityState === \"hidden\" && !measureName.includes(\"Final\") || !config.analyticsTracker) return\n    config.analyticsTracker({\n      metricName: measureName,\n      data,\n      eventProperties,\n      navigatorInformation: getNavigatorInformation(),\n      vitalsScore: getVitalsScore(measureName, data as number)\n    })\n  })\n}","import { config } from \"../config/config\"\nimport { roundByTwo } from \"./helper\"\nimport { reportPerformance } from \"./report-performance\"\n\n/**\n * Sends the metric to an external tracking service\n * 将指标发送到外部跟踪服务\n * @param {string} measureName \n * @param {{[key: string]: any}} metric \n * @param {object} customProperties \n */\nexport const logData = (\n  measureName: string,\n  metric: { [key: string]: any },\n  customProperties?: object\n): void => {\n  Object.keys(metric).forEach((key) => {\n    if (typeof metric[key] === 'number') {\n      metric[key] = roundByTwo(metric[key]);\n    }\n  });\n  reportPerformance(metric, measureName, customProperties);\n};\n\n/**\n * Dispatches the metric duration into internal logs\n * and the external time tracking service.\n * @param {string} measureName\n * @param {number} duration\n * @param {object} customProperties\n */\nexport const logMetric = (\n  measureName: string,\n  duration: number,\n  customProperties?: object\n) => {\n  const duration2decimal = roundByTwo(duration)\n  if (duration2decimal <= (config.maxTime as number)) {\n    reportPerformance(duration, measureName, customProperties)\n  }\n}","import { ResourceTime } from \"../types/types\";\n\n// first-pait\nexport const fp = {\n  value: 0\n}\n\n// first-contentful-paint\nexport const fcp = {\n  value: 0\n}\n\n// block-time\nexport const bt = {\n  value: 0\n}\n\n// largest-contentful-paint\nexport const lcp = {\n  value: 0\n}\n\n// resource-time\nexport const rt: { value: ResourceTime } = {\n  value: {\n    beacon: 0,\n    css: 0,\n    fetch: 0,\n    img: 0,\n    other: 0,\n    script: 0,\n    total: 0,\n    xmlhttprequest: 0,\n  },\n};\n\n// cumulative-layout-shift\nexport const cls = {\n  value: 0\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logMetric } from \"../utils/log\"\nimport { fcp, fp, lcp } from \"../utils/metrics\"\nimport { disconnectPO } from \"./performance-observer\"\n\n/**\n * FirstPaintObserverCallback\n * @returns \n */\nexport const initFirstPaint = (\n  callback: () => void\n) => (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n    if (entry.name === \"first-paint\") {\n      fp.value = entry.startTime\n      logMetric(\"fp\", entry.startTime)\n    } else if (entry.name === \"first-contentful-paint\") {\n      fcp.value = entry.startTime\n      logMetric(\"fcp\", entry.startTime)\n      callback()\n      disconnectPO(\"paint\")\n    }\n  }\n}\n\n/**\n * LargestContentfulPaintObserverCallback\n * @param {Array<PerformanceEntryEncapsulation>} entries \n */\nexport const initLargestContentfulPaint = (entries: Array<PerformanceEntryEncapsulation>) => {\n  const lastEntry = entries.pop()\n  if (lastEntry) {\n    lcp.value = lastEntry.renderTime || lastEntry.startTime\n  }\n}\n\n/**\n * ElementTimingObserverCallback\n * @param {Array<PerformanceEntryEncapsulation>} entries\n */\nexport const initElementTiming = (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n    if (entry.identifier) {\n      logMetric(entry.identifier, entry.startTime, {\n        performanceEntry: entry\n      })\n    }\n  }\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logMetric } from \"../utils/log\"\nimport { bt, fcp } from \"../utils/metrics\"\n\n/**\n * LongtaskObserverCallback\n * https://developer.mozilla.org/zh-CN/docs/Web/API/Long_Tasks_API\n * The definition of a long task is a task longer than 50ms\n * 长任务的定义是超过50ms的任务\n * @param {Array<PerformanceEntryEncapsulation>} entries\n * @returns \n */\nexport const initLongtask = (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n    const blockingTime = entry.startTime - 50\n    if (entry.name !== \"self\" && entry.startTime < fcp.value) return\n    if (blockingTime > 0) {\n      bt.value += entry.startTime\n      logMetric(\"longtask\", entry.startTime)\n    }\n  }\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logData, logMetric } from \"../utils/log\"\nimport { bt, cls, lcp, rt } from \"../utils/metrics\"\nimport { disconnectPO, performanceObserverInstance } from \"./performance-observer\"\n\n/**\n * FirstInputObserverCallback\n * Take the last entry\n * @param {Array<PerformanceEntryEncapsulation>} entries\n */\nexport const initFirstInput = (entries: Array<PerformanceEntryEncapsulation>) => {\n  const lastEntry = entries.pop()\n  if (lastEntry) {\n    // Core Web Vitals FID logic\n    // Delayed operation of measurement input events\n    // 测量输入事件的延迟操作\n    logMetric(\n      \"fidVitals\",\n      lastEntry.processingStart - lastEntry.startTime,\n      {\n        performanceEntry: lastEntry\n      }\n    )\n\n    // Measure the duration of processing the first input event\n    // 测量处理第一个输入事件的持续时间\n    logMetric(\n      \"fid\",\n      lastEntry.duration,\n      {\n        performanceEntry: lastEntry\n      }\n    )\n  }\n\n  // Destroy the registered callback for FID to avoid memory leaks caused by too many observers\n  // 销毁对FID的注册回调 避免过多的观察者造成内存泄露\n  disconnectPO(\"first-input\")\n\n  // lcp log\n  logMetric(\"lcp\", lcp.value)\n\n  // Force any pending records to be dispatched\n  // 强制分派所有待处理的记录\n  if (\n    performanceObserverInstance[\"layout-shift\"] &&\n    typeof performanceObserverInstance[\"layout-shift\"].takeRecords === \"function\"\n  ) {\n    performanceObserverInstance[\"layout-shift\"].takeRecords()\n  }\n\n  // cls log\n  logMetric(\"cls\", cls.value)\n\n  // bt log\n  logMetric(\"bt\", bt.value)\n\n  // TBT with 5 second delay after FID\n  setTimeout(() => {\n    logMetric(\"bt5S\", bt.value)\n  }, 5000)\n\n  // TBT with 10 second delay after FID\n  // 10S overall data consumption after FID is activated\n  setTimeout(() => {\n    logMetric(\"bt10S\", bt.value)\n    logData(\"dataConsumption\", rt.value)\n  }, 10000)\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logData, logMetric } from \"../utils/log\"\nimport { bt, fcp, rt } from \"../utils/metrics\"\n\n/**\n * ResouceTimingObserverCallback\n * @param {Array<PerformanceEntryEncapsulation>} entries\n * @returns \n */\nexport const initResouceTiming = (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n\n    logData(\"resourceTiming\", entry)\n\n    if (entry.decodedBodySize && entry.initiatorType) {\n      const bodySize = entry.decodedBodySize / 1000\n      rt.value[entry.initiatorType] += bodySize\n      rt.value.total += bodySize\n    }\n  }\n}","import { PerformanceEntryEncapsulation } from \"../types/types\";\nimport { cls } from \"../utils/metrics\";\n\n/**\n * https://web.dev/cls/\n * https://requestmetrics.com/web-performance/cumulative-layout-shift\n * \n * Cumulative Layout Shift (CLS), \n * sometimes known as jank, \n * is a measurement of how much elements move due to late-rendered content.\n * You can think of it as a measurement of layout instability. \n * It has become a common problem for many websites due to third-party scripts and tag management and its one of the new Core Web Vital metrics.\n * \n * LayoutShiftObserverCallback\n * Detects new layout shift occurrences and updates the\n * Only count layout shifts without recent user input.\n * 检测新的布局偏移情况并更新\n * 仅在没有最近用户输入的情况下计算布局转移。\n * \n * What is a good CLS score?\n * To provide a good user experience, sites should strive to have a CLS score of 0.1 or less. To ensure you're hitting this target for most of your users, a good threshold to measure is the 75th percentile of page loads, segmented across mobile and desktop devices.\n * 为了提供良好的用户体验，网站应努力使CLS得分不超过0.1。为确保您达到大多数用户的这一目标，衡量移动设备和台式机设备的页面加载量的第75个百分位数是一个很好的衡量标准。\n * @param {Array<PerformanceEntryEncapsulation>} entries\n * @returns\n */\nexport const initLayoutShift = (entries: Array<PerformanceEntryEncapsulation>) => {\n  const lastEntry = entries.pop()\n  if (lastEntry && !lastEntry.hadRecentInput && lastEntry.value) {\n    cls.value += lastEntry.value\n  }\n}","import { PerformanceEntryEncapsulation, PerformanceObserverEventType, PerformanceObservers } from \"../types/types\"\nimport { name } from \"../../package.json\"\nimport { C } from \"../constants\"\nimport { initElementTiming, initFirstPaint, initLargestContentfulPaint } from \"./paint\"\nimport { initLongtask } from \"./longtask\"\nimport { initFirstInput } from \"./first-input\"\nimport { config } from \"../config/config\"\nimport { initResouceTiming } from \"./resource\"\nimport { initLayoutShift } from \"./layout-shift\"\nimport { logMetric } from \"../utils/log\"\nimport { bt, cls, lcp } from \"../utils/metrics\"\n\nexport const performanceObserverInstance: PerformanceObservers = {}\n\n/**\n * PerformanceObserver asynchronous subscription\n * PerformanceObserver异步订阅\n * @param {PerformanceObserverEventType} eventType 监听的事件类型 Types of events monitored\n * @param {(entries: Array<PerformanceEntryEncapsulation>) => void} callback 监听的回调 Listened callback\n */\nconst asyncSubscripePO = (\n  eventType: PerformanceObserverEventType,\n  callback: (entries: Array<PerformanceEntryEncapsulation>) => void\n): PerformanceObserver | null => {\n  try {\n    const Observer = new PerformanceObserver(\n      (entries) =>\n        callback(\n          entries.getEntries() as Array<PerformanceEntryEncapsulation>\n        )\n    )\n    Observer.observe({ type: eventType, buffered: true })\n    return Observer\n  } catch (error) {\n    C.warn(\"PerformanceMonitoring obsever🌲:\",`${name}: ${error}`);\n  }\n  return null\n}\n\n/**\n * Cancel the monitoring of PerformanceObserver\n * 取消PerformanceObserver的监听\n * @param {string} eventType 监听的事件类型 Types of events monitored\n */\nexport const disconnectPO = (eventType: string) => {\n  if (performanceObserverInstance[eventType]) {\n    performanceObserverInstance[eventType]?.disconnect()\n  }\n  delete performanceObserverInstance[eventType]\n}\n\n/**\n * PerformanceObserver initialization\n * PerformanceObserver初始化\n * paint: fp、fcp、largest-contentful-paint\n * longtask\n * first-input\n */\nexport const initPerformanceObserver = (): void => {\n  performanceObserverInstance[\"paint\"] = asyncSubscripePO(\n    \"paint\",\n    initFirstPaint(\n      () => performanceObserverInstance[\"longtask\"] = asyncSubscripePO(\"longtask\", initLongtask)\n    )\n  )\n\n  performanceObserverInstance[\"first-input\"] = asyncSubscripePO(\n    \"first-input\",\n    initFirstInput\n  )\n\n  performanceObserverInstance[\"largest-contentful-paint\"] = asyncSubscripePO(\n    \"largest-contentful-paint\",\n    initLargestContentfulPaint\n  )\n\n  // Collect page performance data\n  // 收集页面性能数据\n  if (config.isObserverResourceTiming) {\n    asyncSubscripePO(\"resource\", initResouceTiming)\n  }\n\n  performanceObserverInstance[\"layout-shift\"] = asyncSubscripePO(\n    \"layout-shift\",\n    initLayoutShift\n  )\n\n  if (config.isObserverElementTiming) {\n    asyncSubscripePO(\"element\", initElementTiming)\n  }\n}\n\n\nexport const disconnectPerformanceObserver = (): void => {\n  if (performanceObserverInstance[\"largest-contentful-paint\"]) {\n    logMetric(\"lcpFinal\", lcp.value)\n    disconnectPO(\"largest-contentful-paint\")\n  }\n\n  if (performanceObserverInstance[\"layout-shift\"]) {\n    // Force any pending records to be dispatched\n    // 强制分派所有待处理的记录\n    if (typeof performanceObserverInstance[\"layout-shift\"].takeRecords === \"function\") {\n      performanceObserverInstance[\"layout-shift\"].takeRecords()\n    }\n    logMetric(\"clsFinal\", cls.value)\n    disconnectPO(\"layout-shift\")\n  }\n\n  if (performanceObserverInstance[\"longtask\"]) {\n    logMetric(\"btFinal\", bt.value)\n    disconnectPO(\"longtask\")\n  }\n}","import ErrorTrace from \"./error-trace\"\nimport ReportData from \"./utils/ReportData\"\nimport { recordingStorage } from \"./performance/record-storage\"\nimport { version } from \"../package.json\"\nimport { config } from \"./config/config\"\nimport { recordClientNavigator } from \"./performance/record-client-navigator\"\nimport { recordTiming } from \"./performance/record-timing\"\nimport { isPerformanceSupported } from \"./utils/helper\"\nimport { AskLevel, PerformanceMonitoringOptions } from \"./types/types\"\nimport { disconnectPerformanceObserver, initPerformanceObserver } from \"./performance/performance-observer\"\nimport { D } from \"./constants\"\nimport { log } from \"./utils/console\"\n\n/**\n * A performance monitoring platform SDK\n * Features include error capture, error recording, performance monitoring\n * 功能包括错误捕获、错误录制、性能监控\n * 一款性能监控平台SDK\n * @packageDocumentation\n */\nexport default class PerformanceMonitoring {\n  constructor(options: PerformanceMonitoringOptions = {}) {\n    const {\n      isObserverElementTiming,\n      isObserverResourceTiming,\n      maxTime,\n      captureError,\n      fetchDomain,\n      errLogRoute,\n      errEventRoute,\n      logRoute,\n      analyticsTracker,\n      recordOptions,\n    } = options\n\n    config.isObserverElementTiming = !!isObserverElementTiming\n    config.isObserverResourceTiming = !!isObserverResourceTiming\n    config.maxTime = maxTime || config.maxTime\n    config.captureError = captureError || config.captureError\n    config.fetchDomain = fetchDomain\n    config.errLogRoute = errLogRoute\n    config.errEventRoute = errEventRoute\n    config.logRoute = logRoute\n    config.reportData = new ReportData()\n    config.analyticsTracker = analyticsTracker || config.analyticsTracker\n    config.recordOptions = recordOptions || config.recordOptions\n\n    log(version)\n\n    if (captureError && fetchDomain) {\n      ErrorTrace.getInstance()\n    }\n\n    if (isPerformanceSupported()) {\n\n      if (D.visibilityState === \"hidden\") {\n        D.addEventListener(\n          \"visibilitychange\",\n          disconnectPerformanceObserver\n        )\n      }\n\n      if (fetchDomain && logRoute) {\n        Promise.all([\n          recordTiming(),\n          recordClientNavigator(),\n          recordingStorage()\n        ]).then(res => {\n          config.reportData?.fetch(\n            AskLevel.IDLE,\n            JSON.stringify(res),\n            logRoute\n          )\n        })\n      }\n\n      initPerformanceObserver()\n    }\n  }\n}","import PerformanceMonitoring from \"../src/index\"\n\nnew PerformanceMonitoring({\n  captureError: true,\n  fetchDomain: \"http://performance-monitoring.zhourengui.top/performance-monitoring\",\n  errEventRoute: \"/err-events\",\n  errLogRoute: \"/err-traceback\",\n  logRoute: \"/performance-log\",\n  isObserverResourceTiming: true,\n  isObserverElementTiming: true\n})","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}