{"version":3,"sources":["../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/@babel/runtime/helpers/createClass.js","../src/types/types.ts","../src/constants.ts","../src/utils/console.ts","../src/config/config.ts","../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableRest.js","../node_modules/@babel/runtime/helpers/slicedToArray.js","../src/rrweb/snapshot/types.ts","../src/rrweb/snapshot/utils.ts","../src/rrweb/snapshot/snapshot.ts","../node_modules/@babel/runtime/helpers/typeof.js","../src/rrweb/snapshot/css.ts","../src/rrweb/snapshot/rebuild.ts","../src/rrweb/snapshot/index.ts","../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/iterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableSpread.js","../node_modules/@babel/runtime/helpers/toConsumableArray.js","../src/rrweb/types.ts","../src/rrweb/utils.ts","../src/rrweb/record/mutation.ts","../src/rrweb/record/stringify.ts","../src/rrweb/record/error-stack-parser.ts","../src/rrweb/record/observer.ts","../src/rrweb/record/iframe-manager.ts","../src/rrweb/record/shadow-dom-manager.ts","../src/rrweb/record/index.ts","../node_modules/fflate/esm/browser.js","../src/rrweb/packer/base.ts","../src/rrweb/packer/pack.ts","../src/rrweb/packer/unpack.ts","../src/rrweb/packer/index.ts","../src/error-trace/index.ts","../src/utils/ReportData.ts","../node_modules/@babel/runtime/helpers/asyncToGenerator.js","../node_modules/regenerator-runtime/runtime.js","../node_modules/@babel/runtime/regenerator/index.js","../src/utils/helper.ts","../src/performance/record-storage.ts","../package.json","../src/performance/record-client-navigator.ts","../src/performance/record-timing.ts","../src/utils/navigator-information.ts","../src/utils/vitals-score.ts","../src/utils/report-performance.ts","../src/utils/log.ts","../src/utils/metrics.ts","../src/performance/paint.ts","../src/performance/longtask.ts","../src/performance/first-input.ts","../src/performance/resource.ts","../src/performance/layout-shift.ts","../src/performance/performance-observer.ts","../src/index.ts","index.ts","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["_classCallCheck","instance","Constructor","TypeError","module","exports","__esModule","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_defineProperties","target","props","i","length","descriptor","_createClass","protoProps","staticProps","prototype","_arrayWithHoles","arr","Array","isArray","_iterableToArrayLimit","_i","Symbol","iterator","_arr","_n","_d","_s","_e","call","next","done","push","err","_arrayLikeToArray","len","arr2","arrayLikeToArray","require","_unsupportedIterableToArray","o","minLen","n","toString","slice","constructor","name","from","test","_nonIterableRest","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","_slicedToArray","_typeof","_arrayWithoutHoles","_iterableToArray","iter","_nonIterableSpread","arrayWithoutHoles","iterableToArray","nonIterableSpread","_toConsumableArray","ch2","wk","c","id","msg","transfer","cb","w","Worker","URL","createObjectURL","Blob","type","onmessage","e","d","data","ed","$e$","Error","stack","postMessage","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","start","b","r","j","_a","fl","revfl","_b","fd","revfd","rev","x","hMap","cd","mb","s","l","le","co","rvb","sv","r_1","v","m","flt","fdt","flm","flrm","fdm","fdrm","max","a","bits","p","bits16","shft","slc","set","subarray","FlateErrorCode","UnexpectedEOF","InvalidBlockType","InvalidLengthLiteral","InvalidDistance","StreamFinished","NoStreamHandler","InvalidHeader","NoCallback","InvalidUTF8","ExtraFieldTooLong","InvalidDate","FilenameTooLong","StreamFinishing","InvalidZipData","UnknownCompressionMethod","ec","ind","nt","code","captureStackTrace","inflt","dat","buf","st","sl","f","noBuf","noSt","cbuf","bl","nbuf","Math","final","pos","bt","lm","dm","lbt","dbt","tbts","t","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","add","dsym","end","wbits","wbits16","hTree","t2","et","sort","i0","i1","i2","maxSym","tr","mbt","ln","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","out","wblk","syms","lf","df","li","bs","dlt","mlb","ddt","mdb","_c","lclt","nlc","lcdt","ndc","lcfreq","lct","mlcb","nlcc","flen","ftlen","dtlen","ll","dl","llm","lcts","it","clct","dst","deo","dflt","lvl","plvl","pre","post","lst","ceil","opt","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","min","maxd","ml","nl","mmd","md","ti","pti","lin","din","crct","Int32Array","k","crc","cr","adler","dopt","level","mem","log","mrg","wcln","fn","fnStr","td","ks","indexOf","lastIndexOf","replace","split","st_1","spInd","ch","cbfs","buffer","wrkr","fns","init","td_1","bInflt","inflateSync","pbf","gu8","bDflt","deflateSync","gze","gzh","gzhl","wbytes","guze","gzs","gzl","zle","zlh","zule","zlv","size","cbify","opts","terminate","consume","astrm","strm","ondata","ev","astrmify","b2","b4","b8","filename","mtime","floor","Date","now","charCodeAt","flg","zs","lv","AsyncCmpStrm","Deflate","chunk","AsyncDeflate","deflate","Inflate","bts","AsyncInflate","inflate","Gzip","raw","AsyncGzip","gzip","gzipSync","Gunzip","AsyncGunzip","gunzip","gunzipSync","Zlib","AsyncZlib","zlib","zlibSync","Unzlib","AsyncUnzlib","unzlib","unzlibSync","Decompress","G","I","Z","_this_1","apply","arguments","AsyncDecompress","decompress","decompressSync","fltn","val","te","TextEncoder","TextDecoder","tds","decode","stream","dutf8","String","fromCharCode","DecodeUTF8","np","EncodeUTF8","strToU8","str","latin1","ar_1","encode","ar","ai","strFromU8","ext","dbf","slzh","zh","z","fnl","es","z64e","sc","su","off","exfl","ex","wzh","u","ce","extra","col","exl","os","flag","compression","y","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","attrs","exf","wzf","ZipPassThrough","process","ZipDeflate","AsyncZipDeflate","Zip","file","fl_1","com","comment","hl_1","header","chks_1","pAll_1","chks_2","chk","tr_1","ind_1","uf_1","nxt","cl_1","dd","splice","zip","keys","tot","slft","files","term","tAll","cbd","mt","cbf","oe","cdl","badd","loc","_loop_1","ms","cbl","zipSync","UnzipPassThrough","UnzipInflate","AsyncUnzipInflate","_","sz","Unzip","onfile","toAdd","is","oc","_loop_2","sig","this_1","bf","cmp_1","chks_3","unshift","sc_1","su_1","fn_1","d_1","file_1","ctr","chks_4","originalSize","state_1","register","decoder","queueMicrotask","setTimeout","unzip","fltr","filter","_loop_3","c_1","no","infl","unzipSync","c_2","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","Promise","then","_asyncToGenerator","self","args","undefined","OVERLAY_ID","OldModule","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","event","JSON","parse","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","console","clear","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","dep","concat","Function","deps","cached","cache","some"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5uBAF,MAAM,CAACC,OAAP,GAAiB2C,OAAO,CAAC,qBAAD,CAAxB;;;;;;;;;ACAA;;AAEA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","file":"examples.77de5100.js","sourceRoot":"../examples","sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import { recordOptions } from \"../rrweb/types\";\n\nexport interface PerformanceMonitoringOptions {\n  isObserverResourceTiming?: boolean | undefined,\n  isObserverElementTiming?: boolean | undefined,\n  maxTime?: number | undefined,\n  captureError?: boolean | undefined,\n  reportData?: ReportDataAchieve | undefined,\n  fetchDomain?: string | undefined,\n  errLogRoute?: string | undefined,\n  errEventRoute?: string | undefined,\n  logRoute?: string | undefined,\n  analyticsTracker?: ((options: AnalyticsTrackerOptions) => void) | undefined,\n  recordOptions?: recordOptions<any> | undefined\n}\n\nexport interface StorageOpt {\n  quota?: number | undefined,\n  usage?: number | undefined,\n  usageDetails: { [key: string]: any }\n}\n\nexport interface TimingOpt {\n  // The time to initiate the network is from AppCache to ResponseEnd\n  // 发起网络的时间是从AppCache到ResponseEnd\n  fetchTime: number,\n  // Response time\n  // 响应时间\n  workerTime: number,\n  // Network request time\n  // 网络请求时间\n  networkTime: number,\n  // Server response time\n  // 服务器响应时间\n  downloadTime: number,\n  // The time when the browser received the first byte of the server\n  // 浏览器接收服务端的第一个字节的时间\n  timeToFirstByte: number,\n  // Request header size\n  // 请求头大小\n  headerSize: number,\n  // dns resolution time\n  // dns解析时间\n  dnsLookupTime: number,\n  // tcp connection time\n  // tcp连接时间\n  tcpTime: number,\n  // Blank screen time\n  // 白屏时间\n  firstPaintTime: number,\n  // dom rendering time\n  // dom渲染时间\n  domRenderTime: number,\n  // onload time\n  // onload时间\n  onloadTime: number,\n  // dom parsing time\n  // dom解析时间\n  domParseTime: number,\n}\n\nexport interface NavigatorOpt {\n  // 浏览器信息\n  // Browser information\n  userAgent: string,\n  // User's internet speed\n  // 用户的网速\n  connection: {\n    downlink?: number,\n    effectiveType?: EffectiveType,\n    rtt?: number,\n    saveData?: boolean,\n    [key: string]: unknown,\n    bandwidth?: string\n  }\n}\n\nexport interface ReportDataAchieve {\n  fetch: (label: AskLevel, body: string, uri: string) => void\n}\n\nexport interface PerformanceObservers {\n  [eventType: string]: PerformanceObserver | null;\n}\n\nexport enum AskLevel {\n  URGENT = 1,\n  IDLE = 2,\n}\n\nexport type PerformanceObserverEventType =\n  | \"paint\"\n  | \"longtask\"\n  | \"first-input\"\n  | \"largest-contentful-paint\"\n  | \"resource\"\n  | \"layout-shift\"\n  | \"element\"\n\nexport type VitalsScore = 'good' | 'needsImprovement' | 'poor' | null;\n\nexport interface AnalyticsTrackerOptions {\n  metricName: string;\n  data: TimingOpt | number | NavigatorOpt;\n  eventProperties: object | undefined;\n  navigatorInformation: unknown;\n  vitalsScore: VitalsScore;\n}\n\nexport interface NavigatorInformation {\n  deviceMemory?: number;\n  hardwareConcurrency?: number;\n  isLowEndDevice?: boolean;\n  isLowEndExperience?: boolean;\n  serviceWorkerStatus?: 'controlled' | 'supported' | 'unsupported';\n}\n\nexport type EffectiveType =\n  | '2g'\n  | '3g'\n  | '4g'\n  | '5g'\n  | 'slow-2g'\n  | 'lte';\n\nexport interface PerformanceEntryEncapsulation extends PerformanceEntry {\n  identifier: any;\n  value?: number | undefined;\n  hadRecentInput?: PerformanceEntryEncapsulation | undefined;\n  initiatorType?: string;\n  decodedBodySize?: number;\n  processingStart: DOMHighResTimeStamp;\n  target?: Node;\n  renderTime?: number\n}\n\nexport interface ResourceTime {\n  beacon: number;\n  css: number;\n  fetch: number;\n  img: number;\n  other: number;\n  script: number;\n  total: number;\n  xmlhttprequest: number;\n  [key: string]: number\n}","interface Navigator {\n  sendBeacon: any\n  connection?: any\n  storage: any\n  userAgent: string\n  deviceMemory: number;\n  hardwareConcurrency: number;\n  serviceWorker?: {\n    controller?: string;\n  };\n}\n\nexport const W = window\nexport const WP = W.performance\nexport const WN = W.navigator as any as Navigator\nexport const C = W.console\nexport const D = document","import { C } from \"../constants\"\n\nconst prefix = \"mini-pm🐢：\"\n\nexport const log = (message: any, ...options: any[]): void => C.log(prefix, message, ...options)\n\nexport const warn = (message: any, ...options: any[]) => C.warn(prefix, message, ...options)\n\nexport const error = (message: any, ...options: any[]) => C.error(prefix, message, ...options)","import type { AnalyticsTrackerOptions, PerformanceMonitoringOptions } from \"../types/types\";\nimport { log } from \"../utils/console\";\n\nexport const config: PerformanceMonitoringOptions = {\n  isObserverResourceTiming: false,\n  isObserverElementTiming: false,\n  maxTime: 15000,\n  captureError: true,\n  reportData: undefined,\n  analyticsTracker: (options: AnalyticsTrackerOptions) => {\n    log(options)\n  },\n  recordOptions: {},\n  fetchDomain: \"\",\n  errLogRoute: \"\",\n  errEventRoute: \"\",\n  logRoute: \"\"\n}","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","export enum NodeType {\n  Document,\n  DocumentType,\n  Element,\n  Text,\n  CDATA,\n  Comment,\n}\n\nexport type documentNode = {\n  type: NodeType.Document;\n  childNodes: serializedNodeWithId[];\n};\n\nexport type documentTypeNode = {\n  type: NodeType.DocumentType;\n  name: string;\n  publicId: string;\n  systemId: string;\n};\n\nexport type attributes = {\n  [key: string]: string | number | boolean;\n};\nexport type elementNode = {\n  type: NodeType.Element;\n  tagName: string;\n  attributes: attributes;\n  childNodes: serializedNodeWithId[];\n  isSVG?: true;\n  needBlock?: boolean;\n};\n\nexport type textNode = {\n  type: NodeType.Text;\n  textContent: string;\n  isStyle?: true;\n};\n\nexport type cdataNode = {\n  type: NodeType.CDATA;\n  textContent: '';\n};\n\nexport type commentNode = {\n  type: NodeType.Comment;\n  textContent: string;\n};\n\nexport type serializedNode = (\n  | documentNode\n  | documentTypeNode\n  | elementNode\n  | textNode\n  | cdataNode\n  | commentNode\n) & {\n  rootId?: number;\n  isShadowHost?: boolean;\n  isShadow?: boolean;\n};\n\nexport type serializedNodeWithId = serializedNode & { id: number };\n\nexport type tagMap = {\n  [key: string]: string;\n};\n\nexport interface INode extends Node {\n  __sn: serializedNodeWithId;\n}\n\nexport type idNodeMap = {\n  [key: number]: INode;\n};\n\nexport type MaskInputOptions = Partial<{\n  color: boolean;\n  date: boolean;\n  'datetime-local': boolean;\n  email: boolean;\n  month: boolean;\n  number: boolean;\n  range: boolean;\n  search: boolean;\n  tel: boolean;\n  text: boolean;\n  time: boolean;\n  url: boolean;\n  week: boolean;\n  // unify textarea and select element with text input\n  textarea: boolean;\n  select: boolean;\n  password: boolean;\n}>;\n\nexport type SlimDOMOptions = Partial<{\n  script: boolean;\n  comment: boolean;\n  headFavicon: boolean;\n  headWhitespace: boolean;\n  headMetaDescKeywords: boolean;\n  headMetaSocial: boolean;\n  headMetaRobots: boolean;\n  headMetaHttpEquiv: boolean;\n  headMetaAuthorship: boolean;\n  headMetaVerification: boolean;\n}>;\n\nexport type MaskTextFn = (text: string) => string;\n","import { INode } from './types';\n\nexport function isElement(n: Node | INode): n is Element {\n  return n.nodeType === n.ELEMENT_NODE;\n}\n\nexport function isShadowRoot(n: Node): n is ShadowRoot {\n  const host: Element | null = (n as ShadowRoot)?.host;\n  return Boolean(host && host.shadowRoot && host.shadowRoot === n);\n}\n","import {\n  serializedNode,\n  serializedNodeWithId,\n  NodeType,\n  attributes,\n  INode,\n  idNodeMap,\n  MaskInputOptions,\n  SlimDOMOptions,\n  MaskTextFn,\n} from './types';\nimport { isElement, isShadowRoot } from './utils';\n\nlet _id = 1;\nconst tagNameRegex = RegExp('[^a-z0-9-_]');\n\nexport const IGNORED_NODE = -2;\n\nfunction genId(): number {\n  return _id++;\n}\n\nfunction getValidTagName(element: HTMLElement): string {\n  if (element instanceof HTMLFormElement) {\n    return 'form';\n  }\n\n  const processedTagName = element.tagName.toLowerCase().trim();\n\n  if (tagNameRegex.test(processedTagName)) {\n    // if the tag name is odd and we cannot extract\n    // anything from the string, then we return a\n    // generic div\n    return 'div';\n  }\n\n  return processedTagName;\n}\n\nfunction getCssRulesString(s: CSSStyleSheet): string | null {\n  try {\n    const rules = s.rules || s.cssRules;\n    return rules ? Array.from(rules).map(getCssRuleString).join('') : null;\n  } catch (error) {\n    return null;\n  }\n}\n\nfunction getCssRuleString(rule: CSSRule): string {\n  return isCSSImportRule(rule)\n    ? getCssRulesString(rule.styleSheet) || ''\n    : rule.cssText;\n}\n\nfunction isCSSImportRule(rule: CSSRule): rule is CSSImportRule {\n  return 'styleSheet' in rule;\n}\n\nfunction extractOrigin(url: string): string {\n  let origin;\n  if (url.indexOf('//') > -1) {\n    origin = url.split('/').slice(0, 3).join('/');\n  } else {\n    origin = url.split('/')[0];\n  }\n  origin = origin.split('?')[0];\n  return origin;\n}\n\nconst URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")([^\"]*)\"|([^)]*))\\)/gm;\nconst RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/|#).*/;\nconst DATA_URI = /^(data:)([^,]*),(.*)/i;\nexport function absoluteToStylesheet(\n  cssText: string | null,\n  href: string,\n): string {\n  return (cssText || '').replace(\n    URL_IN_CSS_REF,\n    (origin, quote1, path1, quote2, path2, path3) => {\n      const filePath = path1 || path2 || path3;\n      const maybeQuote = quote1 || quote2 || '';\n      if (!filePath) {\n        return origin;\n      }\n      if (!RELATIVE_PATH.test(filePath)) {\n        return `url(${maybeQuote}${filePath}${maybeQuote})`;\n      }\n      if (DATA_URI.test(filePath)) {\n        return `url(${maybeQuote}${filePath}${maybeQuote})`;\n      }\n      if (filePath[0] === '/') {\n        return `url(${maybeQuote}${\n          extractOrigin(href) + filePath\n        }${maybeQuote})`;\n      }\n      const stack = href.split('/');\n      const parts = filePath.split('/');\n      stack.pop();\n      for (const part of parts) {\n        if (part === '.') {\n          continue;\n        } else if (part === '..') {\n          stack.pop();\n        } else {\n          stack.push(part);\n        }\n      }\n      return `url(${maybeQuote}${stack.join('/')}${maybeQuote})`;\n    },\n  );\n}\n\nconst SRCSET_NOT_SPACES = /^[^ \\t\\n\\r\\u000c]+/; // Don't use \\s, to avoid matching non-breaking space\nconst SRCSET_COMMAS_OR_SPACES = /^[, \\t\\n\\r\\u000c]+/;\nfunction getAbsoluteSrcsetString(doc: Document, attributeValue: string) {\n  /*\n    run absoluteToDoc over every url in the srcset\n\n    this is adapted from https://github.com/albell/parse-srcset/\n    without the parsing of the descriptors (we return these as-is)\n    parce-srcset is in turn based on\n    https://html.spec.whatwg.org/multipage/embedded-content.html#parse-a-srcset-attribute\n  */\n  if (attributeValue.trim() === '') {\n    return attributeValue;\n  }\n\n  let pos = 0;\n\n  function collectCharacters(regEx: RegExp) {\n    var chars,\n      match = regEx.exec(attributeValue.substring(pos));\n    if (match) {\n      chars = match[0];\n      pos += chars.length;\n      return chars;\n    }\n    return '';\n  }\n\n  let output = [];\n  while (true) {\n    collectCharacters(SRCSET_COMMAS_OR_SPACES);\n    if (pos >= attributeValue.length) {\n      break;\n    }\n    // don't split on commas within urls\n    let url = collectCharacters(SRCSET_NOT_SPACES);\n    if (url.slice(-1) === ',') {\n      // aside: according to spec more than one comma at the end is a parse error, but we ignore that\n      url = absoluteToDoc(doc, url.substring(0, url.length - 1));\n      // the trailing comma splits the srcset, so the interpretion is that\n      // another url will follow, and the descriptor is empty\n      output.push(url);\n    } else {\n      let descriptorsStr = '';\n      url = absoluteToDoc(doc, url);\n      let inParens = false;\n      while (true) {\n        let c = attributeValue.charAt(pos);\n        if (c === '') {\n          output.push((url + descriptorsStr).trim());\n          break;\n        } else if (!inParens) {\n          if (c === ',') {\n            pos += 1;\n            output.push((url + descriptorsStr).trim());\n            break; // parse the next url\n          } else if (c === '(') {\n            inParens = true;\n          }\n        } else {\n          // in parenthesis; ignore commas\n          // (parenthesis may be supported by future additions to spec)\n          if (c === ')') {\n            inParens = false;\n          }\n        }\n        descriptorsStr += c;\n        pos += 1;\n      }\n    }\n  }\n  return output.join(', ');\n}\n\nexport function absoluteToDoc(doc: Document, attributeValue: string): string {\n  if (!attributeValue || attributeValue.trim() === '') {\n    return attributeValue;\n  }\n  const a: HTMLAnchorElement = doc.createElement('a');\n  a.href = attributeValue;\n  return a.href;\n}\n\nfunction isSVGElement(el: Element): boolean {\n  return el.tagName === 'svg' || el instanceof SVGElement;\n}\n\nfunction getHref() {\n  // return a href without hash\n  const a = document.createElement('a');\n  a.href = '';\n  return a.href;\n}\n\nexport function transformAttribute(\n  doc: Document,\n  tagName: string,\n  name: string,\n  value: string,\n): string {\n  // relative path in attribute\n  if (name === 'src' || ((name === 'href' || name === 'xlink:href') && value)) {\n    return absoluteToDoc(doc, value);\n  } else if (\n    name === 'background' &&\n    value &&\n    (tagName === 'table' || tagName === 'td' || tagName === 'th')\n  ) {\n    return absoluteToDoc(doc, value);\n  } else if (name === 'srcset' && value) {\n    return getAbsoluteSrcsetString(doc, value);\n  } else if (name === 'style' && value) {\n    return absoluteToStylesheet(value, getHref());\n  } else {\n    return value;\n  }\n}\n\nexport function _isBlockedElement(\n  element: HTMLElement,\n  blockClass: string | RegExp,\n  blockSelector: string | null,\n): boolean {\n  if (typeof blockClass === 'string') {\n    if (element.classList.contains(blockClass)) {\n      return true;\n    }\n  } else {\n    // tslint:disable-next-line: prefer-for-of\n    for (let eIndex = 0; eIndex < element.classList.length; eIndex++) {\n      const className = element.classList[eIndex];\n      if (blockClass.test(className)) {\n        return true;\n      }\n    }\n  }\n  if (blockSelector) {\n    return element.matches(blockSelector);\n  }\n\n  return false;\n}\n\nexport function needMaskingText(\n  node: Node | null,\n  maskTextClass: string | RegExp,\n  maskTextSelector: string | null,\n): boolean {\n  if (!node) {\n    return false;\n  }\n  if (node.nodeType === node.ELEMENT_NODE) {\n    if (typeof maskTextClass === 'string') {\n      if ((node as HTMLElement).classList.contains(maskTextClass)) {\n        return true;\n      }\n    } else {\n      (node as HTMLElement).classList.forEach((className) => {\n        if (maskTextClass.test(className)) {\n          return true;\n        }\n      });\n    }\n    if (maskTextSelector) {\n      if ((node as HTMLElement).matches(maskTextSelector)) {\n        return true;\n      }\n    }\n    return needMaskingText(node.parentNode, maskTextClass, maskTextSelector);\n  }\n  if (node.nodeType === node.TEXT_NODE) {\n    // check parent node since text node do not have class name\n    return needMaskingText(node.parentNode, maskTextClass, maskTextSelector);\n  }\n  return needMaskingText(node.parentNode, maskTextClass, maskTextSelector);\n}\n\n// https://stackoverflow.com/a/36155560\nfunction onceIframeLoaded(\n  iframeEl: HTMLIFrameElement,\n  listener: () => unknown,\n  iframeLoadTimeout: number,\n) {\n  const win = iframeEl.contentWindow;\n  if (!win) {\n    return;\n  }\n  // document is loading\n  let fired = false;\n\n  let readyState: DocumentReadyState;\n  try {\n    readyState = win.document.readyState;\n  } catch (error) {\n    return;\n  }\n  if (readyState !== 'complete') {\n    const timer = setTimeout(() => {\n      if (!fired) {\n        listener();\n        fired = true;\n      }\n    }, iframeLoadTimeout);\n    iframeEl.addEventListener('load', () => {\n      clearTimeout(timer);\n      fired = true;\n      listener();\n    });\n    return;\n  }\n  // check blank frame for Chrome\n  const blankUrl = 'about:blank';\n  if (\n    win.location.href !== blankUrl ||\n    iframeEl.src === blankUrl ||\n    iframeEl.src === ''\n  ) {\n    listener();\n    return;\n  }\n  // use default listener\n  iframeEl.addEventListener('load', listener);\n}\n\nfunction serializeNode(\n  n: Node,\n  options: {\n    doc: Document;\n    blockClass: string | RegExp;\n    blockSelector: string | null;\n    maskTextClass: string | RegExp;\n    maskTextSelector: string | null;\n    inlineStylesheet: boolean;\n    maskInputOptions: MaskInputOptions;\n    maskTextFn: MaskTextFn | undefined;\n    recordCanvas: boolean;\n  },\n): serializedNode | false {\n  const {\n    doc,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    inlineStylesheet,\n    maskInputOptions = {},\n    maskTextFn,\n    recordCanvas,\n  } = options;\n  // Only record root id when document object is not the base document\n  let rootId: number | undefined;\n  if (((doc as unknown) as INode).__sn) {\n    const docId = ((doc as unknown) as INode).__sn.id;\n    rootId = docId === 1 ? undefined : docId;\n  }\n  switch (n.nodeType) {\n    case n.DOCUMENT_NODE:\n      return {\n        type: NodeType.Document,\n        childNodes: [],\n        rootId,\n      };\n    case n.DOCUMENT_TYPE_NODE:\n      return {\n        type: NodeType.DocumentType,\n        name: (n as DocumentType).name,\n        publicId: (n as DocumentType).publicId,\n        systemId: (n as DocumentType).systemId,\n        rootId,\n      };\n    case n.ELEMENT_NODE:\n      const needBlock = _isBlockedElement(\n        n as HTMLElement,\n        blockClass,\n        blockSelector,\n      );\n      const tagName = getValidTagName(n as HTMLElement);\n      let attributes: attributes = {};\n      for (const { name, value } of Array.from((n as HTMLElement).attributes)) {\n        attributes[name] = transformAttribute(doc, tagName, name, value);\n      }\n      // remote css\n      if (tagName === 'link' && inlineStylesheet) {\n        const stylesheet = Array.from(doc.styleSheets).find((s) => {\n          return s.href === (n as HTMLLinkElement).href;\n        });\n        const cssText = getCssRulesString(stylesheet as CSSStyleSheet);\n        if (cssText) {\n          delete attributes.rel;\n          delete attributes.href;\n          attributes._cssText = absoluteToStylesheet(\n            cssText,\n            stylesheet!.href!,\n          );\n        }\n      }\n      // dynamic stylesheet\n      if (\n        tagName === 'style' &&\n        (n as HTMLStyleElement).sheet &&\n        // TODO: Currently we only try to get dynamic stylesheet when it is an empty style element\n        !(\n          (n as HTMLElement).innerText ||\n          (n as HTMLElement).textContent ||\n          ''\n        ).trim().length\n      ) {\n        const cssText = getCssRulesString(\n          (n as HTMLStyleElement).sheet as CSSStyleSheet,\n        );\n        if (cssText) {\n          attributes._cssText = absoluteToStylesheet(cssText, getHref());\n        }\n      }\n      // form fields\n      if (\n        tagName === 'input' ||\n        tagName === 'textarea' ||\n        tagName === 'select'\n      ) {\n        const value = (n as HTMLInputElement | HTMLTextAreaElement).value;\n        if (\n          attributes.type !== 'radio' &&\n          attributes.type !== 'checkbox' &&\n          attributes.type !== 'submit' &&\n          attributes.type !== 'button' &&\n          value\n        ) {\n          attributes.value =\n            maskInputOptions[attributes.type as keyof MaskInputOptions] ||\n            maskInputOptions[tagName as keyof MaskInputOptions]\n              ? '*'.repeat(value.length)\n              : value;\n        } else if ((n as HTMLInputElement).checked) {\n          attributes.checked = (n as HTMLInputElement).checked;\n        }\n      }\n      if (tagName === 'option') {\n        const selectValue = (n as HTMLOptionElement).parentElement;\n        if (attributes.value === (selectValue as HTMLSelectElement).value) {\n          attributes.selected = (n as HTMLOptionElement).selected;\n        }\n      }\n      // canvas image data\n      if (tagName === 'canvas' && recordCanvas) {\n        attributes.rr_dataURL = (n as HTMLCanvasElement).toDataURL();\n      }\n      // media elements\n      if (tagName === 'audio' || tagName === 'video') {\n        attributes.rr_mediaState = (n as HTMLMediaElement).paused\n          ? 'paused'\n          : 'played';\n      }\n      // scroll\n      if ((n as HTMLElement).scrollLeft) {\n        attributes.rr_scrollLeft = (n as HTMLElement).scrollLeft;\n      }\n      if ((n as HTMLElement).scrollTop) {\n        attributes.rr_scrollTop = (n as HTMLElement).scrollTop;\n      }\n      // block element\n      if (needBlock) {\n        const { width, height } = (n as HTMLElement).getBoundingClientRect();\n        attributes = {\n          class: attributes.class,\n          rr_width: `${width}px`,\n          rr_height: `${height}px`,\n        };\n      }\n      // iframe\n      if (tagName === 'iframe') {\n        delete attributes.src;\n      }\n      return {\n        type: NodeType.Element,\n        tagName,\n        attributes,\n        childNodes: [],\n        isSVG: isSVGElement(n as Element) || undefined,\n        needBlock,\n        rootId,\n      };\n    case n.TEXT_NODE:\n      // The parent node may not be a html element which has a tagName attribute.\n      // So just let it be undefined which is ok in this use case.\n      const parentTagName =\n        n.parentNode && (n.parentNode as HTMLElement).tagName;\n      let textContent = (n as Text).textContent;\n      const isStyle = parentTagName === 'STYLE' ? true : undefined;\n      const isScript = parentTagName === 'SCRIPT' ? true : undefined;\n      if (isStyle && textContent) {\n        textContent = absoluteToStylesheet(textContent, getHref());\n      }\n      if (isScript) {\n        textContent = 'SCRIPT_PLACEHOLDER';\n      }\n      if (\n        !isStyle &&\n        !isScript &&\n        needMaskingText(n, maskTextClass, maskTextSelector) &&\n        textContent\n      ) {\n        textContent = maskTextFn\n          ? maskTextFn(textContent)\n          : textContent.replace(/[\\S]/g, '*');\n      }\n      return {\n        type: NodeType.Text,\n        textContent: textContent || '',\n        isStyle,\n        rootId,\n      };\n    case n.CDATA_SECTION_NODE:\n      return {\n        type: NodeType.CDATA,\n        textContent: '',\n        rootId,\n      };\n    case n.COMMENT_NODE:\n      return {\n        type: NodeType.Comment,\n        textContent: (n as Comment).textContent || '',\n        rootId,\n      };\n    default:\n      return false;\n  }\n}\n\nfunction lowerIfExists(maybeAttr: string | number | boolean): string {\n  if (maybeAttr === undefined) {\n    return '';\n  } else {\n    return (maybeAttr as string).toLowerCase();\n  }\n}\n\nfunction slimDOMExcluded(\n  sn: serializedNode,\n  slimDOMOptions: SlimDOMOptions,\n): boolean {\n  if (slimDOMOptions.comment && sn.type === NodeType.Comment) {\n    // TODO: convert IE conditional comments to real nodes\n    return true;\n  } else if (sn.type === NodeType.Element) {\n    if (\n      slimDOMOptions.script &&\n      (sn.tagName === 'script' ||\n        (sn.tagName === 'link' &&\n          sn.attributes.rel === 'preload' &&\n          sn.attributes.as === 'script'))\n    ) {\n      return true;\n    } else if (\n      slimDOMOptions.headFavicon &&\n      ((sn.tagName === 'link' && sn.attributes.rel === 'shortcut icon') ||\n        (sn.tagName === 'meta' &&\n          (lowerIfExists(sn.attributes.name).match(\n            /^msapplication-tile(image|color)$/,\n          ) ||\n            lowerIfExists(sn.attributes.name) === 'application-name' ||\n            lowerIfExists(sn.attributes.rel) === 'icon' ||\n            lowerIfExists(sn.attributes.rel) === 'apple-touch-icon' ||\n            lowerIfExists(sn.attributes.rel) === 'shortcut icon')))\n    ) {\n      return true;\n    } else if (sn.tagName === 'meta') {\n      if (\n        slimDOMOptions.headMetaDescKeywords &&\n        lowerIfExists(sn.attributes.name).match(/^description|keywords$/)\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaSocial &&\n        (lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/) || // og = opengraph (facebook)\n          lowerIfExists(sn.attributes.name).match(/^(og|twitter):/) ||\n          lowerIfExists(sn.attributes.name) === 'pinterest')\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaRobots &&\n        (lowerIfExists(sn.attributes.name) === 'robots' ||\n          lowerIfExists(sn.attributes.name) === 'googlebot' ||\n          lowerIfExists(sn.attributes.name) === 'bingbot')\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaHttpEquiv &&\n        sn.attributes['http-equiv'] !== undefined\n      ) {\n        // e.g. X-UA-Compatible, Content-Type, Content-Language,\n        // cache-control, X-Translated-By\n        return true;\n      } else if (\n        slimDOMOptions.headMetaAuthorship &&\n        (lowerIfExists(sn.attributes.name) === 'author' ||\n          lowerIfExists(sn.attributes.name) === 'generator' ||\n          lowerIfExists(sn.attributes.name) === 'framework' ||\n          lowerIfExists(sn.attributes.name) === 'publisher' ||\n          lowerIfExists(sn.attributes.name) === 'progid' ||\n          lowerIfExists(sn.attributes.property).match(/^article:/) ||\n          lowerIfExists(sn.attributes.property).match(/^product:/))\n      ) {\n        return true;\n      } else if (\n        slimDOMOptions.headMetaVerification &&\n        (lowerIfExists(sn.attributes.name) === 'google-site-verification' ||\n          lowerIfExists(sn.attributes.name) === 'yandex-verification' ||\n          lowerIfExists(sn.attributes.name) === 'csrf-token' ||\n          lowerIfExists(sn.attributes.name) === 'p:domain_verify' ||\n          lowerIfExists(sn.attributes.name) === 'verify-v1' ||\n          lowerIfExists(sn.attributes.name) === 'verification' ||\n          lowerIfExists(sn.attributes.name) === 'shopify-checkout-api-token')\n      ) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nexport function serializeNodeWithId(\n  n: Node | INode,\n  options: {\n    doc: Document;\n    map: idNodeMap;\n    blockClass: string | RegExp;\n    blockSelector: string | null;\n    maskTextClass: string | RegExp;\n    maskTextSelector: string | null;\n    skipChild: boolean;\n    inlineStylesheet: boolean;\n    maskInputOptions?: MaskInputOptions;\n    maskTextFn: MaskTextFn | undefined;\n    slimDOMOptions: SlimDOMOptions;\n    recordCanvas?: boolean;\n    preserveWhiteSpace?: boolean;\n    onSerialize?: (n: INode) => unknown;\n    onIframeLoad?: (iframeINode: INode, node: serializedNodeWithId) => unknown;\n    iframeLoadTimeout?: number;\n  },\n): serializedNodeWithId | null {\n  const {\n    doc,\n    map,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    skipChild = false,\n    inlineStylesheet = true,\n    maskInputOptions = {},\n    maskTextFn,\n    slimDOMOptions,\n    recordCanvas = false,\n    onSerialize,\n    onIframeLoad,\n    iframeLoadTimeout = 5000,\n  } = options;\n  let { preserveWhiteSpace = true } = options;\n  const _serializedNode = serializeNode(n, {\n    doc,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    inlineStylesheet,\n    maskInputOptions,\n    maskTextFn,\n    recordCanvas,\n  });\n  if (!_serializedNode) {\n    // TODO: dev only\n    console.warn(n, 'not serialized');\n    return null;\n  }\n\n  let id;\n  // Try to reuse the previous id\n  if ('__sn' in n) {\n    id = n.__sn.id;\n  } else if (\n    slimDOMExcluded(_serializedNode, slimDOMOptions) ||\n    (!preserveWhiteSpace &&\n      _serializedNode.type === NodeType.Text &&\n      !_serializedNode.isStyle &&\n      !_serializedNode.textContent.replace(/^\\s+|\\s+$/gm, '').length)\n  ) {\n    id = IGNORED_NODE;\n  } else {\n    id = genId();\n  }\n  const serializedNode = Object.assign(_serializedNode, { id });\n  (n as INode).__sn = serializedNode;\n  if (id === IGNORED_NODE) {\n    return null; // slimDOM\n  }\n  map[id] = n as INode;\n  if (onSerialize) {\n    onSerialize(n as INode);\n  }\n  let recordChild = !skipChild;\n  if (serializedNode.type === NodeType.Element) {\n    recordChild = recordChild && !serializedNode.needBlock;\n    // this property was not needed in replay side\n    delete serializedNode.needBlock;\n  }\n  if (\n    (serializedNode.type === NodeType.Document ||\n      serializedNode.type === NodeType.Element) &&\n    recordChild\n  ) {\n    if (\n      slimDOMOptions.headWhitespace &&\n      _serializedNode.type === NodeType.Element &&\n      _serializedNode.tagName === 'head'\n      // would impede performance: || getComputedStyle(n)['white-space'] === 'normal'\n    ) {\n      preserveWhiteSpace = false;\n    }\n    const bypassOptions = {\n      doc,\n      map,\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      skipChild,\n      inlineStylesheet,\n      maskInputOptions,\n      maskTextFn,\n      slimDOMOptions,\n      recordCanvas,\n      preserveWhiteSpace,\n      onSerialize,\n      onIframeLoad,\n      iframeLoadTimeout,\n    };\n    for (const childN of Array.from(n.childNodes)) {\n      const serializedChildNode = serializeNodeWithId(childN, bypassOptions);\n      if (serializedChildNode) {\n        serializedNode.childNodes.push(serializedChildNode);\n      }\n    }\n\n    if (isElement(n) && n.shadowRoot) {\n      serializedNode.isShadowHost = true;\n      for (const childN of Array.from(n.shadowRoot.childNodes)) {\n        const serializedChildNode = serializeNodeWithId(childN, bypassOptions);\n        if (serializedChildNode) {\n          serializedChildNode.isShadow = true;\n          serializedNode.childNodes.push(serializedChildNode);\n        }\n      }\n    }\n  }\n\n  if (n.parentNode && isShadowRoot(n.parentNode)) {\n    serializedNode.isShadow = true;\n  }\n\n  if (\n    serializedNode.type === NodeType.Element &&\n    serializedNode.tagName === 'iframe'\n  ) {\n    onceIframeLoaded(\n      n as HTMLIFrameElement,\n      () => {\n        const iframeDoc = (n as HTMLIFrameElement).contentDocument;\n        if (iframeDoc && onIframeLoad) {\n          const serializedIframeNode = serializeNodeWithId(iframeDoc, {\n            doc: iframeDoc,\n            map,\n            blockClass,\n            blockSelector,\n            maskTextClass,\n            maskTextSelector,\n            skipChild: false,\n            inlineStylesheet,\n            maskInputOptions,\n            maskTextFn,\n            slimDOMOptions,\n            recordCanvas,\n            preserveWhiteSpace,\n            onSerialize,\n            onIframeLoad,\n            iframeLoadTimeout,\n          });\n\n          if (serializedIframeNode) {\n            onIframeLoad(n as INode, serializedIframeNode);\n          }\n        }\n      },\n      iframeLoadTimeout,\n    );\n  }\n\n  return serializedNode;\n}\n\nfunction snapshot(\n  n: Document,\n  options?: {\n    blockClass?: string | RegExp;\n    blockSelector?: string | null;\n    maskTextClass?: string | RegExp;\n    maskTextSelector?: string | null;\n    inlineStylesheet?: boolean;\n    maskAllInputs?: boolean | MaskInputOptions;\n    maskTextFn?: MaskTextFn;\n    slimDOM?: boolean | SlimDOMOptions;\n    recordCanvas?: boolean;\n    preserveWhiteSpace?: boolean;\n    onSerialize?: (n: INode) => unknown;\n    onIframeLoad?: (iframeINode: INode, node: serializedNodeWithId) => unknown;\n    iframeLoadTimeout?: number;\n  },\n): [serializedNodeWithId | null, idNodeMap] {\n  const {\n    blockClass = 'rr-block',\n    blockSelector = null,\n    maskTextClass = 'rr-mask',\n    maskTextSelector = null,\n    inlineStylesheet = true,\n    recordCanvas = false,\n    maskAllInputs = false,\n    maskTextFn,\n    slimDOM = false,\n    preserveWhiteSpace,\n    onSerialize,\n    onIframeLoad,\n    iframeLoadTimeout,\n  } = options || {};\n  const idNodeMap: idNodeMap = {};\n  const maskInputOptions: MaskInputOptions =\n    maskAllInputs === true\n      ? {\n          color: true,\n          date: true,\n          'datetime-local': true,\n          email: true,\n          month: true,\n          number: true,\n          range: true,\n          search: true,\n          tel: true,\n          text: true,\n          time: true,\n          url: true,\n          week: true,\n          textarea: true,\n          select: true,\n          password: true,\n        }\n      : maskAllInputs === false\n      ? {\n          password: true,\n        }\n      : maskAllInputs;\n  const slimDOMOptions: SlimDOMOptions =\n    slimDOM === true || slimDOM === 'all'\n      ? // if true: set of sensible options that should not throw away any information\n        {\n          script: true,\n          comment: true,\n          headFavicon: true,\n          headWhitespace: true,\n          headMetaDescKeywords: slimDOM === 'all', // destructive\n          headMetaSocial: true,\n          headMetaRobots: true,\n          headMetaHttpEquiv: true,\n          headMetaAuthorship: true,\n          headMetaVerification: true,\n        }\n      : slimDOM === false\n      ? {}\n      : slimDOM;\n  return [\n    serializeNodeWithId(n, {\n      doc: n,\n      map: idNodeMap,\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      skipChild: false,\n      inlineStylesheet,\n      maskInputOptions,\n      maskTextFn,\n      slimDOMOptions,\n      recordCanvas,\n      preserveWhiteSpace,\n      onSerialize,\n      onIframeLoad,\n      iframeLoadTimeout,\n    }),\n    idNodeMap,\n  ];\n}\n\nexport function visitSnapshot(\n  node: serializedNodeWithId,\n  onVisit: (node: serializedNodeWithId) => unknown,\n) {\n  function walk(current: serializedNodeWithId) {\n    onVisit(current);\n    if (\n      current.type === NodeType.Document ||\n      current.type === NodeType.Element\n    ) {\n      current.childNodes.forEach(walk);\n    }\n  }\n\n  walk(node);\n}\n\nexport function cleanupSnapshot() {\n  // allow a new recording to start numbering nodes from scratch\n  _id = 1;\n}\n\nexport default snapshot;\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * This file is a fork of https://github.com/reworkcss/css/blob/master/lib/parse/index.js\n * I fork it because:\n * 1. The css library was built for node.js which does not have tree-shaking supports.\n * 2. Rewrites into typescript give us a better type interface.\n */\n\n/* tslint:disable no-conditional-assignment interface-name no-shadowed-variable */\n\nexport interface ParserOptions {\n  /** Silently fail on parse errors */\n  silent?: boolean;\n  /**\n   * The path to the file containing css.\n   * Makes errors and source maps more helpful, by letting them know where code comes from.\n   */\n  source?: string;\n}\n\n/**\n * Error thrown during parsing.\n */\nexport interface ParserError {\n  /** The full error message with the source position. */\n  message?: string;\n  /** The error message without position. */\n  reason?: string;\n  /** The value of options.source if passed to css.parse. Otherwise undefined. */\n  filename?: string;\n  line?: number;\n  column?: number;\n  /** The portion of code that couldn't be parsed. */\n  source?: string;\n}\n\nexport interface Loc {\n  line?: number;\n  column?: number;\n}\n\n/**\n * Base AST Tree Node.\n */\nexport interface Node {\n  /** The possible values are the ones listed in the Types section on https://github.com/reworkcss/css page. */\n  type?: string;\n  /** A reference to the parent node, or null if the node has no parent. */\n  parent?: Node;\n  /** Information about the position in the source string that corresponds to the node. */\n  position?: {\n    start?: Loc;\n    end?: Loc;\n    /** The value of options.source if passed to css.parse. Otherwise undefined. */\n    source?: string;\n    /** The full source string passed to css.parse. */\n    content?: string;\n  };\n}\n\nexport interface Rule extends Node {\n  /** The list of selectors of the rule, split on commas. Each selector is trimmed from whitespace and comments. */\n  selectors?: string[];\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\nexport interface Declaration extends Node {\n  /** The property name, trimmed from whitespace and comments. May not be empty. */\n  property?: string;\n  /** The value of the property, trimmed from whitespace and comments. Empty values are allowed. */\n  value?: string;\n}\n\n/**\n * A rule-level or declaration-level comment. Comments inside selectors, properties and values etc. are lost.\n */\nexport interface Comment extends Node {\n  comment?: string;\n}\n\n/**\n * The @charset at-rule.\n */\nexport interface Charset extends Node {\n  /** The part following @charset. */\n  charset?: string;\n}\n\n/**\n * The @custom-media at-rule\n */\nexport interface CustomMedia extends Node {\n  /** The ---prefixed name. */\n  name?: string;\n  /** The part following the name. */\n  media?: string;\n}\n\n/**\n * The @document at-rule.\n */\nexport interface Document extends Node {\n  /** The part following @document. */\n  document?: string;\n  /** The vendor prefix in @document, or undefined if there is none. */\n  vendor?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/**\n * The @font-face at-rule.\n */\nexport interface FontFace extends Node {\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\n/**\n * The @host at-rule.\n */\nexport interface Host extends Node {\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/**\n * The @import at-rule.\n */\nexport interface Import extends Node {\n  /** The part following @import. */\n  import?: string;\n}\n\n/**\n * The @keyframes at-rule.\n */\nexport interface KeyFrames extends Node {\n  /** The name of the keyframes rule. */\n  name?: string;\n  /** The vendor prefix in @keyframes, or undefined if there is none. */\n  vendor?: string;\n  /** Array of nodes with the types keyframe and comment. */\n  keyframes?: Array<KeyFrame | Comment>;\n}\n\nexport interface KeyFrame extends Node {\n  /** The list of \"selectors\" of the keyframe rule, split on commas. Each “selector” is trimmed from whitespace. */\n  values?: string[];\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\n/**\n * The @media at-rule.\n */\nexport interface Media extends Node {\n  /** The part following @media. */\n  media?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/**\n * The @namespace at-rule.\n */\nexport interface Namespace extends Node {\n  /** The part following @namespace. */\n  namespace?: string;\n}\n\n/**\n * The @page at-rule.\n */\nexport interface Page extends Node {\n  /** The list of selectors of the rule, split on commas. Each selector is trimmed from whitespace and comments. */\n  selectors?: string[];\n  /** Array of nodes with the types declaration and comment. */\n  declarations?: Array<Declaration | Comment>;\n}\n\n/**\n * The @supports at-rule.\n */\nexport interface Supports extends Node {\n  /** The part following @supports. */\n  supports?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules?: Array<Rule | Comment | AtRule>;\n}\n\n/** All at-rules. */\nexport type AtRule =\n  | Charset\n  | CustomMedia\n  | Document\n  | FontFace\n  | Host\n  | Import\n  | KeyFrames\n  | Media\n  | Namespace\n  | Page\n  | Supports;\n\n/**\n * A collection of rules\n */\nexport interface StyleRules {\n  source?: string;\n  /** Array of nodes with the types rule, comment and any of the at-rule types. */\n  rules: Array<Rule | Comment | AtRule>;\n  /** Array of Errors. Errors collected during parsing when option silent is true. */\n  parsingErrors?: ParserError[];\n}\n\n/**\n * The root node returned by css.parse.\n */\nexport interface Stylesheet extends Node {\n  stylesheet?: StyleRules;\n}\n\n// http://www.w3.org/TR/CSS21/grammar.html\n// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027\nconst commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\n\nexport function parse(css: string, options: ParserOptions = {}) {\n  /**\n   * Positional.\n   */\n\n  let lineno = 1;\n  let column = 1;\n\n  /**\n   * Update lineno and column based on `str`.\n   */\n\n  function updatePosition(str: string) {\n    const lines = str.match(/\\n/g);\n    if (lines) {\n      lineno += lines.length;\n    }\n    let i = str.lastIndexOf('\\n');\n    column = i === -1 ? column + str.length : str.length - i;\n  }\n\n  /**\n   * Mark position and patch `node.position`.\n   */\n\n  function position() {\n    const start = { line: lineno, column };\n    return (\n      node: Rule | Declaration | Comment | AtRule | Stylesheet | KeyFrame,\n    ) => {\n      node.position = new Position(start);\n      whitespace();\n      return node;\n    };\n  }\n\n  /**\n   * Store position information for a node\n   */\n\n  class Position {\n    public content!: string;\n    public start!: Loc;\n    public end!: Loc;\n    public source?: string;\n\n    constructor(start: Loc) {\n      this.start = start;\n      this.end = { line: lineno, column };\n      this.source = options.source;\n    }\n  }\n\n  /**\n   * Non-enumerable source string\n   */\n\n  Position.prototype.content = css;\n\n  const errorsList: ParserError[] = [];\n\n  function error(msg: string) {\n    const err = new Error(\n      options.source + ':' + lineno + ':' + column + ': ' + msg,\n    ) as ParserError;\n    err.reason = msg;\n    err.filename = options.source;\n    err.line = lineno;\n    err.column = column;\n    err.source = css;\n\n    if (options.silent) {\n      errorsList.push(err);\n    } else {\n      throw err;\n    }\n  }\n\n  /**\n   * Parse stylesheet.\n   */\n\n  function stylesheet(): Stylesheet {\n    const rulesList = rules();\n\n    return {\n      type: 'stylesheet',\n      stylesheet: {\n        source: options.source,\n        rules: rulesList,\n        parsingErrors: errorsList,\n      },\n    };\n  }\n\n  /**\n   * Opening brace.\n   */\n\n  function open() {\n    return match(/^{\\s*/);\n  }\n\n  /**\n   * Closing brace.\n   */\n\n  function close() {\n    return match(/^}/);\n  }\n\n  /**\n   * Parse ruleset.\n   */\n\n  function rules() {\n    let node: Rule | void;\n    const rules: Rule[] = [];\n    whitespace();\n    comments(rules);\n    while (css.length && css.charAt(0) !== '}' && (node = atrule() || rule())) {\n      if (node !== false) {\n        rules.push(node);\n        comments(rules);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Match `re` and return captures.\n   */\n\n  function match(re: RegExp) {\n    const m = re.exec(css);\n    if (!m) {\n      return;\n    }\n    const str = m[0];\n    updatePosition(str);\n    css = css.slice(str.length);\n    return m;\n  }\n\n  /**\n   * Parse whitespace.\n   */\n\n  function whitespace() {\n    match(/^\\s*/);\n  }\n\n  /**\n   * Parse comments;\n   */\n\n  function comments(rules: Rule[] = []) {\n    let c: Comment | void;\n    while ((c = comment())) {\n      if (c !== false) {\n        rules.push(c);\n      }\n      c = comment();\n    }\n    return rules;\n  }\n\n  /**\n   * Parse comment.\n   */\n\n  function comment() {\n    const pos = position();\n    if ('/' !== css.charAt(0) || '*' !== css.charAt(1)) {\n      return;\n    }\n\n    let i = 2;\n    while (\n      '' !== css.charAt(i) &&\n      ('*' !== css.charAt(i) || '/' !== css.charAt(i + 1))\n    ) {\n      ++i;\n    }\n    i += 2;\n\n    if ('' === css.charAt(i - 1)) {\n      return error('End of comment missing');\n    }\n\n    const str = css.slice(2, i - 2);\n    column += 2;\n    updatePosition(str);\n    css = css.slice(i);\n    column += 2;\n\n    return pos({\n      type: 'comment',\n      comment: str,\n    });\n  }\n\n  /**\n   * Parse selector.\n   */\n\n  function selector() {\n    const m = match(/^([^{]+)/);\n    if (!m) {\n      return;\n    }\n    /* @fix Remove all comments from selectors\n     * http://ostermiller.org/findcomment.html */\n    return trim(m[0])\n      .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '')\n      .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, (m) => {\n        return m.replace(/,/g, '\\u200C');\n      })\n      .split(/\\s*(?![^(]*\\)),\\s*/)\n      .map((s) => {\n        return s.replace(/\\u200C/g, ',');\n      });\n  }\n\n  /**\n   * Parse declaration.\n   */\n\n  function declaration(): Declaration | void | never {\n    const pos = position();\n\n    // prop\n    let propMatch = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\n    if (!propMatch) {\n      return;\n    }\n    const prop = trim(propMatch[0]);\n\n    // :\n    if (!match(/^:\\s*/)) {\n      return error(`property missing ':'`);\n    }\n\n    // val\n    const val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\n\n    const ret = pos({\n      type: 'declaration',\n      property: prop.replace(commentre, ''),\n      value: val ? trim(val[0]).replace(commentre, '') : '',\n    });\n\n    // ;\n    match(/^[;\\s]*/);\n\n    return ret;\n  }\n\n  /**\n   * Parse declarations.\n   */\n\n  function declarations() {\n    const decls: Array<object> = [];\n\n    if (!open()) {\n      return error(`missing '{'`);\n    }\n    comments(decls);\n\n    // declarations\n    let decl;\n    while ((decl = declaration())) {\n      if ((decl as unknown) !== false) {\n        decls.push(decl);\n        comments(decls);\n      }\n      decl = declaration();\n    }\n\n    if (!close()) {\n      return error(`missing '}'`);\n    }\n    return decls;\n  }\n\n  /**\n   * Parse keyframe.\n   */\n\n  function keyframe() {\n    let m;\n    const vals = [];\n    const pos = position();\n\n    while ((m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/))) {\n      vals.push(m[1]);\n      match(/^,\\s*/);\n    }\n\n    if (!vals.length) {\n      return;\n    }\n\n    return pos({\n      type: 'keyframe',\n      values: vals,\n      declarations: declarations() as Declaration[],\n    });\n  }\n\n  /**\n   * Parse keyframes.\n   */\n\n  function atkeyframes() {\n    const pos = position();\n    let m = match(/^@([-\\w]+)?keyframes\\s*/);\n\n    if (!m) {\n      return;\n    }\n    const vendor = m[1];\n\n    // identifier\n    m = match(/^([-\\w]+)\\s*/);\n    if (!m) {\n      return error('@keyframes missing name');\n    }\n    const name = m[1];\n\n    if (!open()) {\n      return error(`@keyframes missing '{'`);\n    }\n\n    let frame;\n    let frames = comments();\n    while ((frame = keyframe())) {\n      frames.push(frame);\n      frames = frames.concat(comments());\n    }\n\n    if (!close()) {\n      return error(`@keyframes missing '}'`);\n    }\n\n    return pos({\n      type: 'keyframes',\n      name,\n      vendor,\n      keyframes: frames,\n    });\n  }\n\n  /**\n   * Parse supports.\n   */\n\n  function atsupports() {\n    const pos = position();\n    const m = match(/^@supports *([^{]+)/);\n\n    if (!m) {\n      return;\n    }\n    const supports = trim(m[1]);\n\n    if (!open()) {\n      return error(`@supports missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@supports missing '}'`);\n    }\n\n    return pos({\n      type: 'supports',\n      supports,\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse host.\n   */\n\n  function athost() {\n    const pos = position();\n    const m = match(/^@host\\s*/);\n\n    if (!m) {\n      return;\n    }\n\n    if (!open()) {\n      return error(`@host missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@host missing '}'`);\n    }\n\n    return pos({\n      type: 'host',\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse media.\n   */\n\n  function atmedia() {\n    const pos = position();\n    const m = match(/^@media *([^{]+)/);\n\n    if (!m) {\n      return;\n    }\n    const media = trim(m[1]);\n\n    if (!open()) {\n      return error(`@media missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@media missing '}'`);\n    }\n\n    return pos({\n      type: 'media',\n      media,\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse custom-media.\n   */\n\n  function atcustommedia() {\n    const pos = position();\n    const m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\n    if (!m) {\n      return;\n    }\n\n    return pos({\n      type: 'custom-media',\n      name: trim(m[1]),\n      media: trim(m[2]),\n    });\n  }\n\n  /**\n   * Parse paged media.\n   */\n\n  function atpage() {\n    const pos = position();\n    const m = match(/^@page */);\n    if (!m) {\n      return;\n    }\n\n    const sel = selector() || [];\n\n    if (!open()) {\n      return error(`@page missing '{'`);\n    }\n    let decls = comments();\n\n    // declarations\n    let decl;\n    while ((decl = declaration())) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) {\n      return error(`@page missing '}'`);\n    }\n\n    return pos({\n      type: 'page',\n      selectors: sel,\n      declarations: decls,\n    });\n  }\n\n  /**\n   * Parse document.\n   */\n\n  function atdocument() {\n    const pos = position();\n    const m = match(/^@([-\\w]+)?document *([^{]+)/);\n    if (!m) {\n      return;\n    }\n\n    const vendor = trim(m[1]);\n    const doc = trim(m[2]);\n\n    if (!open()) {\n      return error(`@document missing '{'`);\n    }\n\n    const style = comments().concat(rules());\n\n    if (!close()) {\n      return error(`@document missing '}'`);\n    }\n\n    return pos({\n      type: 'document',\n      document: doc,\n      vendor,\n      rules: style,\n    });\n  }\n\n  /**\n   * Parse font-face.\n   */\n\n  function atfontface() {\n    const pos = position();\n    const m = match(/^@font-face\\s*/);\n    if (!m) {\n      return;\n    }\n\n    if (!open()) {\n      return error(`@font-face missing '{'`);\n    }\n    let decls = comments();\n\n    // declarations\n    let decl;\n    while ((decl = declaration())) {\n      decls.push(decl);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) {\n      return error(`@font-face missing '}'`);\n    }\n\n    return pos({\n      type: 'font-face',\n      declarations: decls,\n    });\n  }\n\n  /**\n   * Parse import\n   */\n\n  const atimport = _compileAtrule('import');\n\n  /**\n   * Parse charset\n   */\n\n  const atcharset = _compileAtrule('charset');\n\n  /**\n   * Parse namespace\n   */\n\n  const atnamespace = _compileAtrule('namespace');\n\n  /**\n   * Parse non-block at-rules\n   */\n\n  function _compileAtrule(name: string) {\n    const re = new RegExp('^@' + name + '\\\\s*([^;]+);');\n    return () => {\n      const pos = position();\n      const m = match(re);\n      if (!m) {\n        return;\n      }\n      const ret: Record<string, string> = { type: name };\n      ret[name] = m[1].trim();\n      return pos(ret);\n    };\n  }\n\n  /**\n   * Parse at rule.\n   */\n\n  function atrule() {\n    if (css[0] !== '@') {\n      return;\n    }\n\n    return (\n      atkeyframes() ||\n      atmedia() ||\n      atcustommedia() ||\n      atsupports() ||\n      atimport() ||\n      atcharset() ||\n      atnamespace() ||\n      atdocument() ||\n      atpage() ||\n      athost() ||\n      atfontface()\n    );\n  }\n\n  /**\n   * Parse rule.\n   */\n\n  function rule() {\n    const pos = position();\n    const sel = selector();\n\n    if (!sel) {\n      return error('selector missing');\n    }\n    comments();\n\n    return pos({\n      type: 'rule',\n      selectors: sel,\n      declarations: declarations() as Declaration[],\n    });\n  }\n\n  return addParent(stylesheet());\n}\n\n/**\n * Trim `str`.\n */\n\nfunction trim(str: string) {\n  return str ? str.replace(/^\\s+|\\s+$/g, '') : '';\n}\n\n/**\n * Adds non-enumerable parent node reference to each node.\n */\n\nfunction addParent(obj: Stylesheet, parent?: Stylesheet) {\n  const isNode = obj && typeof obj.type === 'string';\n  const childParent = isNode ? obj : parent;\n\n  for (const k of Object.keys(obj)) {\n    const value = obj[k as keyof Stylesheet];\n    if (Array.isArray(value)) {\n      value.forEach((v) => {\n        addParent(v, childParent);\n      });\n    } else if (value && typeof value === 'object') {\n      addParent((value as unknown) as Stylesheet, childParent);\n    }\n  }\n\n  if (isNode) {\n    Object.defineProperty(obj, 'parent', {\n      configurable: true,\n      writable: true,\n      enumerable: false,\n      value: parent || null,\n    });\n  }\n\n  return obj;\n}\n","import { parse } from './css';\nimport {\n  serializedNodeWithId,\n  NodeType,\n  tagMap,\n  elementNode,\n  idNodeMap,\n  INode,\n} from './types';\nimport { isElement } from './utils';\n\nconst tagMap: tagMap = {\n  script: 'noscript',\n  // camel case svg element tag names\n  altglyph: 'altGlyph',\n  altglyphdef: 'altGlyphDef',\n  altglyphitem: 'altGlyphItem',\n  animatecolor: 'animateColor',\n  animatemotion: 'animateMotion',\n  animatetransform: 'animateTransform',\n  clippath: 'clipPath',\n  feblend: 'feBlend',\n  fecolormatrix: 'feColorMatrix',\n  fecomponenttransfer: 'feComponentTransfer',\n  fecomposite: 'feComposite',\n  feconvolvematrix: 'feConvolveMatrix',\n  fediffuselighting: 'feDiffuseLighting',\n  fedisplacementmap: 'feDisplacementMap',\n  fedistantlight: 'feDistantLight',\n  fedropshadow: 'feDropShadow',\n  feflood: 'feFlood',\n  fefunca: 'feFuncA',\n  fefuncb: 'feFuncB',\n  fefuncg: 'feFuncG',\n  fefuncr: 'feFuncR',\n  fegaussianblur: 'feGaussianBlur',\n  feimage: 'feImage',\n  femerge: 'feMerge',\n  femergenode: 'feMergeNode',\n  femorphology: 'feMorphology',\n  feoffset: 'feOffset',\n  fepointlight: 'fePointLight',\n  fespecularlighting: 'feSpecularLighting',\n  fespotlight: 'feSpotLight',\n  fetile: 'feTile',\n  feturbulence: 'feTurbulence',\n  foreignobject: 'foreignObject',\n  glyphref: 'glyphRef',\n  lineargradient: 'linearGradient',\n  radialgradient: 'radialGradient',\n};\nfunction getTagName(n: elementNode): string {\n  let tagName = tagMap[n.tagName] ? tagMap[n.tagName] : n.tagName;\n  if (tagName === 'link' && n.attributes._cssText) {\n    tagName = 'style';\n  }\n  return tagName;\n}\n\n// based on https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#escaping\nfunction escapeRegExp(string: string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nconst HOVER_SELECTOR = /([^\\\\]):hover/;\nconst HOVER_SELECTOR_GLOBAL = new RegExp(HOVER_SELECTOR, 'g');\nexport function addHoverClass(cssText: string): string {\n  const ast = parse(cssText, {\n    silent: true,\n  });\n\n  if (!ast.stylesheet) {\n    return cssText;\n  }\n\n  const selectors: string[] = [];\n  ast.stylesheet.rules.forEach((rule) => {\n    if ('selectors' in rule) {\n      (rule.selectors || []).forEach((selector: string) => {\n        if (HOVER_SELECTOR.test(selector)) {\n          selectors.push(selector);\n        }\n      });\n    }\n  });\n\n  if (selectors.length === 0) return cssText;\n\n  const selectorMatcher = new RegExp(\n    selectors\n      .filter((selector, index) => selectors.indexOf(selector) === index)\n      .sort((a, b) => b.length - a.length)\n      .map((selector) => {\n        return escapeRegExp(selector);\n      })\n      .join('|'),\n    'g',\n  );\n\n  return cssText.replace(selectorMatcher, (selector) => {\n    const newSelector = selector.replace(HOVER_SELECTOR_GLOBAL, '$1.\\\\:hover');\n    return `${selector}, ${newSelector}`;\n  });\n}\n\nfunction buildNode(\n  n: serializedNodeWithId,\n  options: {\n    doc: Document;\n    hackCss: boolean;\n  },\n): Node | null {\n  const { doc, hackCss } = options;\n  switch (n.type) {\n    case NodeType.Document:\n      return doc.implementation.createDocument(null, '', null);\n    case NodeType.DocumentType:\n      return doc.implementation.createDocumentType(\n        n.name || 'html',\n        n.publicId,\n        n.systemId,\n      );\n    case NodeType.Element:\n      const tagName = getTagName(n);\n      let node: Element;\n      if (n.isSVG) {\n        node = doc.createElementNS('http://www.w3.org/2000/svg', tagName);\n      } else {\n        node = doc.createElement(tagName);\n      }\n      for (const name in n.attributes) {\n        if (!n.attributes.hasOwnProperty(name)) {\n          continue;\n        }\n        let value = n.attributes[name];\n        value =\n          typeof value === 'boolean' || typeof value === 'number' ? '' : value;\n        // attribute names start with rr_ are internal attributes added by rrweb\n        if (!name.startsWith('rr_')) {\n          const isTextarea = tagName === 'textarea' && name === 'value';\n          const isRemoteOrDynamicCss =\n            tagName === 'style' && name === '_cssText';\n          if (isRemoteOrDynamicCss && hackCss) {\n            value = addHoverClass(value);\n          }\n          if (isTextarea || isRemoteOrDynamicCss) {\n            const child = doc.createTextNode(value);\n            // https://github.com/rrweb-io/rrweb/issues/112\n            for (const c of Array.from(node.childNodes)) {\n              if (c.nodeType === node.TEXT_NODE) {\n                node.removeChild(c);\n              }\n            }\n            node.appendChild(child);\n            continue;\n          }\n          if (tagName === 'iframe' && name === 'src') {\n            continue;\n          }\n          try {\n            if (n.isSVG && name === 'xlink:href') {\n              node.setAttributeNS('http://www.w3.org/1999/xlink', name, value);\n            } else if (\n              name === 'onload' ||\n              name === 'onclick' ||\n              name.substring(0, 7) === 'onmouse'\n            ) {\n              // Rename some of the more common atttributes from https://www.w3schools.com/tags/ref_eventattributes.asp\n              // as setting them triggers a console.error (which shows up despite the try/catch)\n              // Assumption: these attributes are not used to css\n              node.setAttribute('_' + name, value);\n            } else {\n              node.setAttribute(name, value);\n            }\n          } catch (error) {\n            // skip invalid attribute\n          }\n        } else {\n          // handle internal attributes\n          if (tagName === 'canvas' && name === 'rr_dataURL') {\n            const image = document.createElement('img');\n            image.src = value;\n            image.onload = () => {\n              const ctx = (node as HTMLCanvasElement).getContext('2d');\n              if (ctx) {\n                ctx.drawImage(image, 0, 0, image.width, image.height);\n              }\n            };\n          }\n          if (name === 'rr_width') {\n            (node as HTMLElement).style.width = value;\n          }\n          if (name === 'rr_height') {\n            (node as HTMLElement).style.height = value;\n          }\n          if (name === 'rr_mediaState') {\n            switch (value) {\n              case 'played':\n                (node as HTMLMediaElement).play();\n              case 'paused':\n                (node as HTMLMediaElement).pause();\n                break;\n              default:\n            }\n          }\n        }\n      }\n      if (n.isShadowHost) {\n        /**\n         * Since node is newly rebuilt, it should be a normal element\n         * without shadowRoot.\n         * But if there are some weird situations that has defined\n         * custom element in the scope before we rebuild node, it may\n         * register the shadowRoot earlier.\n         * The logic in the 'else' block is just a try-my-best solution\n         * for the corner case, please let we know if it is wrong and\n         * we can remove it.\n         */\n        if (!node.shadowRoot) {\n          node.attachShadow({ mode: 'open' });\n        } else {\n          while (node.shadowRoot.firstChild) {\n            node.shadowRoot.removeChild(node.shadowRoot.firstChild);\n          }\n        }\n      }\n      return node;\n    case NodeType.Text:\n      return doc.createTextNode(\n        n.isStyle && hackCss ? addHoverClass(n.textContent) : n.textContent,\n      );\n    case NodeType.CDATA:\n      return doc.createCDATASection(n.textContent);\n    case NodeType.Comment:\n      return doc.createComment(n.textContent);\n    default:\n      return null;\n  }\n}\n\nexport function buildNodeWithSN(\n  n: serializedNodeWithId,\n  options: {\n    doc: Document;\n    map: idNodeMap;\n    skipChild?: boolean;\n    hackCss: boolean;\n    afterAppend?: (n: INode) => unknown;\n  },\n): INode | null {\n  const { doc, map, skipChild = false, hackCss = true, afterAppend } = options;\n  let node = buildNode(n, { doc, hackCss });\n  if (!node) {\n    return null;\n  }\n  if (n.rootId) {\n    console.assert(\n      ((map[n.rootId] as unknown) as Document) === doc,\n      'Target document should has the same root id.',\n    );\n  }\n  // use target document as root document\n  if (n.type === NodeType.Document) {\n    // close before open to make sure document was closed\n    doc.close();\n    doc.open();\n    node = doc;\n  }\n\n  (node as INode).__sn = n;\n  map[n.id] = node as INode;\n\n  if (\n    (n.type === NodeType.Document || n.type === NodeType.Element) &&\n    !skipChild\n  ) {\n    for (const childN of n.childNodes) {\n      const childNode = buildNodeWithSN(childN, {\n        doc,\n        map,\n        skipChild: false,\n        hackCss,\n        afterAppend,\n      });\n      if (!childNode) {\n        console.warn('Failed to rebuild', childN);\n        continue;\n      }\n\n      if (childN.isShadow && isElement(node) && node.shadowRoot) {\n        node.shadowRoot.appendChild(childNode);\n      } else {\n        node.appendChild(childNode);\n      }\n      if (afterAppend) {\n        afterAppend(childNode);\n      }\n    }\n  }\n\n  return node as INode;\n}\n\nfunction visit(idNodeMap: idNodeMap, onVisit: (node: INode) => void) {\n  function walk(node: INode) {\n    onVisit(node);\n  }\n\n  for (const key in idNodeMap) {\n    if (idNodeMap[key]) {\n      walk(idNodeMap[key]);\n    }\n  }\n}\n\nfunction handleScroll(node: INode) {\n  const n = node.__sn;\n  if (n.type !== NodeType.Element) {\n    return;\n  }\n  const el = (node as Node) as HTMLElement;\n  for (const name in n.attributes) {\n    if (!(n.attributes.hasOwnProperty(name) && name.startsWith('rr_'))) {\n      continue;\n    }\n    const value = n.attributes[name];\n    if (name === 'rr_scrollLeft') {\n      el.scrollLeft = value as number;\n    }\n    if (name === 'rr_scrollTop') {\n      el.scrollTop = value as number;\n    }\n  }\n}\n\nfunction rebuild(\n  n: serializedNodeWithId,\n  options: {\n    doc: Document;\n    onVisit?: (node: INode) => unknown;\n    hackCss?: boolean;\n    afterAppend?: (n: INode) => unknown;\n  },\n): [Node | null, idNodeMap] {\n  const { doc, onVisit, hackCss = true, afterAppend } = options;\n  const idNodeMap: idNodeMap = {};\n  const node = buildNodeWithSN(n, {\n    doc,\n    map: idNodeMap,\n    skipChild: false,\n    hackCss,\n    afterAppend,\n  });\n  visit(idNodeMap, (visitedNode) => {\n    if (onVisit) {\n      onVisit(visitedNode);\n    }\n    handleScroll(visitedNode);\n  });\n  return [node, idNodeMap];\n}\n\nexport default rebuild;\n","import snapshot, {\n  serializeNodeWithId,\n  transformAttribute,\n  visitSnapshot,\n  cleanupSnapshot,\n  needMaskingText,\n  IGNORED_NODE,\n} from './snapshot';\nimport rebuild, { buildNodeWithSN, addHoverClass } from './rebuild';\nexport * from './types';\nexport * from './utils';\n\nexport {\n  snapshot,\n  serializeNodeWithId,\n  rebuild,\n  buildNodeWithSN,\n  addHoverClass,\n  transformAttribute,\n  visitSnapshot,\n  cleanupSnapshot,\n  needMaskingText,\n  IGNORED_NODE,\n};\n","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\n\nvar iterableToArray = require(\"./iterableToArray.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import {\n  serializedNodeWithId,\n  idNodeMap,\n  INode,\n  MaskInputOptions,\n  SlimDOMOptions,\n} from './snapshot';\nimport { PackFn, UnpackFn } from './packer/base';\nimport { FontFaceDescriptors } from 'css-font-loading-module';\nimport { IframeManager } from './record/iframe-manager';\nimport { ShadowDomManager } from './record/shadow-dom-manager';\n\nexport enum EventType {\n  DomContentLoaded,\n  Load,\n  FullSnapshot,\n  IncrementalSnapshot,\n  Meta,\n  Custom,\n}\n\nexport type domContentLoadedEvent = {\n  type: EventType.DomContentLoaded;\n  data: {};\n};\n\nexport type loadedEvent = {\n  type: EventType.Load;\n  data: {};\n};\n\nexport type fullSnapshotEvent = {\n  type: EventType.FullSnapshot;\n  data: {\n    node: serializedNodeWithId;\n    initialOffset: {\n      top: number;\n      left: number;\n    };\n  };\n};\n\nexport type incrementalSnapshotEvent = {\n  type: EventType.IncrementalSnapshot;\n  data: incrementalData;\n};\n\nexport type metaEvent = {\n  type: EventType.Meta;\n  data: {\n    href: string;\n    width: number;\n    height: number;\n  };\n};\n\nexport type logEvent = {\n  type: EventType.IncrementalSnapshot;\n  data: incrementalData;\n};\n\nexport type customEvent<T = unknown> = {\n  type: EventType.Custom;\n  data: {\n    tag: string;\n    payload: T;\n  };\n};\n\nexport type styleSheetEvent = {};\n\nexport enum IncrementalSource {\n  Mutation,\n  MouseMove,\n  MouseInteraction,\n  Scroll,\n  ViewportResize,\n  Input,\n  TouchMove,\n  MediaInteraction,\n  StyleSheetRule,\n  CanvasMutation,\n  Font,\n  Log,\n  Drag,\n}\n\nexport type mutationData = {\n  source: IncrementalSource.Mutation;\n} & mutationCallbackParam;\n\nexport type mousemoveData = {\n  source:\n  | IncrementalSource.MouseMove\n  | IncrementalSource.TouchMove\n  | IncrementalSource.Drag;\n  positions: mousePosition[];\n};\n\nexport type mouseInteractionData = {\n  source: IncrementalSource.MouseInteraction;\n} & mouseInteractionParam;\n\nexport type scrollData = {\n  source: IncrementalSource.Scroll;\n} & scrollPosition;\n\nexport type viewportResizeData = {\n  source: IncrementalSource.ViewportResize;\n} & viewportResizeDimension;\n\nexport type inputData = {\n  source: IncrementalSource.Input;\n  id: number;\n} & inputValue;\n\nexport type mediaInteractionData = {\n  source: IncrementalSource.MediaInteraction;\n} & mediaInteractionParam;\n\nexport type styleSheetRuleData = {\n  source: IncrementalSource.StyleSheetRule;\n} & styleSheetRuleParam;\n\nexport type canvasMutationData = {\n  source: IncrementalSource.CanvasMutation;\n} & canvasMutationParam;\n\nexport type fontData = {\n  source: IncrementalSource.Font;\n} & fontParam;\n\nexport type logData = {\n  source: IncrementalSource.Log;\n} & LogParam;\n\nexport type incrementalData =\n  | mutationData\n  | mousemoveData\n  | mouseInteractionData\n  | scrollData\n  | viewportResizeData\n  | inputData\n  | mediaInteractionData\n  | styleSheetRuleData\n  | canvasMutationData\n  | fontData\n  | logData;\n\nexport type event =\n  | domContentLoadedEvent\n  | loadedEvent\n  | fullSnapshotEvent\n  | incrementalSnapshotEvent\n  | metaEvent\n  | logEvent\n  | customEvent;\n\nexport type eventWithTime = event & {\n  timestamp: number;\n  delay?: number;\n};\n\nexport type blockClass = string | RegExp;\n\nexport type maskTextClass = string | RegExp;\n\nexport type SamplingStrategy = Partial<{\n  /**\n   * false means not to record mouse/touch move events\n   * number is the throttle threshold of recording mouse/touch move\n   */\n  mousemove: boolean | number;\n  /**\n   * number is the throttle threshold of mouse/touch move callback\n   */\n  mousemoveCallback: number;\n  /**\n   * false means not to record mouse interaction events\n   * can also specify record some kinds of mouse interactions\n   */\n  mouseInteraction: boolean | Record<string, boolean | undefined>;\n  /**\n   * number is the throttle threshold of recording scroll\n   */\n  scroll: number;\n  /**\n   * 'all' will record all the input events\n   * 'last' will only record the last input value while input a sequence of chars\n   */\n  input: 'all' | 'last';\n}>;\n\nexport type recordOptions<T> = {\n  emit?: (e: T, isCheckout?: boolean) => void;\n  checkoutEveryNth?: number;\n  checkoutEveryNms?: number;\n  blockClass?: blockClass;\n  blockSelector?: string;\n  ignoreClass?: string;\n  maskTextClass?: maskTextClass;\n  maskTextSelector?: string;\n  maskAllInputs?: boolean;\n  maskInputOptions?: MaskInputOptions;\n  maskInputFn?: MaskInputFn;\n  maskTextFn?: MaskTextFn;\n  slimDOMOptions?: SlimDOMOptions | 'all' | true;\n  inlineStylesheet?: boolean;\n  hooks?: hooksParam;\n  packFn?: PackFn;\n  sampling?: SamplingStrategy;\n  recordCanvas?: boolean;\n  collectFonts?: boolean;\n  // departed, please use sampling options\n  mousemoveWait?: number;\n  recordLog?: boolean | LogRecordOptions;\n};\n\nexport type observerParam = {\n  mutationCb: mutationCallBack;\n  mousemoveCb: mousemoveCallBack;\n  mouseInteractionCb: mouseInteractionCallBack;\n  scrollCb: scrollCallback;\n  viewportResizeCb: viewportResizeCallback;\n  inputCb: inputCallback;\n  mediaInteractionCb: mediaInteractionCallback;\n  blockClass: blockClass;\n  blockSelector: string | null;\n  ignoreClass: string;\n  maskTextClass: maskTextClass;\n  maskTextSelector: string | null;\n  maskInputOptions: MaskInputOptions;\n  maskInputFn?: MaskInputFn;\n  maskTextFn?: MaskTextFn;\n  inlineStylesheet: boolean;\n  styleSheetRuleCb: styleSheetRuleCallback;\n  canvasMutationCb: canvasMutationCallback;\n  fontCb: fontCallback;\n  logCb: logCallback;\n  logOptions: LogRecordOptions;\n  sampling: SamplingStrategy;\n  recordCanvas: boolean;\n  collectFonts: boolean;\n  slimDOMOptions: SlimDOMOptions;\n  doc: Document;\n  mirror: Mirror;\n  iframeManager: IframeManager;\n  shadowDomManager: ShadowDomManager;\n};\n\nexport type hooksParam = {\n  mutation?: mutationCallBack;\n  mousemove?: mousemoveCallBack;\n  mouseInteraction?: mouseInteractionCallBack;\n  scroll?: scrollCallback;\n  viewportResize?: viewportResizeCallback;\n  input?: inputCallback;\n  mediaInteaction?: mediaInteractionCallback;\n  styleSheetRule?: styleSheetRuleCallback;\n  canvasMutation?: canvasMutationCallback;\n  font?: fontCallback;\n  log?: logCallback;\n};\n\n// https://dom.spec.whatwg.org/#interface-mutationrecord\nexport type mutationRecord = {\n  type: string;\n  target: Node;\n  oldValue: string | null;\n  addedNodes: NodeList;\n  removedNodes: NodeList;\n  attributeName: string | null;\n};\n\nexport type textCursor = {\n  node: Node;\n  value: string | null;\n};\nexport type textMutation = {\n  id: number;\n  value: string | null;\n};\n\nexport type attributeCursor = {\n  node: Node;\n  attributes: {\n    [key: string]: string | null;\n  };\n};\nexport type attributeMutation = {\n  id: number;\n  attributes: {\n    [key: string]: string | null;\n  };\n};\n\nexport type removedNodeMutation = {\n  parentId: number;\n  id: number;\n  isShadow?: boolean;\n};\n\nexport type addedNodeMutation = {\n  parentId: number;\n  // Newly recorded mutations will not have previousId any more, just for compatibility\n  previousId?: number | null;\n  nextId: number | null;\n  node: serializedNodeWithId;\n};\n\nexport type mutationCallbackParam = {\n  texts: textMutation[];\n  attributes: attributeMutation[];\n  removes: removedNodeMutation[];\n  adds: addedNodeMutation[];\n  isAttachIframe?: true;\n};\n\nexport type mutationCallBack = (m: mutationCallbackParam) => void;\n\nexport type mousemoveCallBack = (\n  p: mousePosition[],\n  source:\n    | IncrementalSource.MouseMove\n    | IncrementalSource.TouchMove\n    | IncrementalSource.Drag,\n) => void;\n\nexport type mousePosition = {\n  x: number;\n  y: number;\n  id: number;\n  timeOffset: number;\n};\n\nexport enum MouseInteractions {\n  MouseUp,\n  MouseDown,\n  Click,\n  ContextMenu,\n  DblClick,\n  Focus,\n  Blur,\n  TouchStart,\n  TouchMove_Departed, // we will start a separate observer for touch move event\n  TouchEnd,\n}\n\ntype mouseInteractionParam = {\n  type: MouseInteractions;\n  id: number;\n  x: number;\n  y: number;\n};\n\nexport type mouseInteractionCallBack = (d: mouseInteractionParam) => void;\n\nexport type scrollPosition = {\n  id: number;\n  x: number;\n  y: number;\n};\n\nexport type scrollCallback = (p: scrollPosition) => void;\n\nexport type styleSheetAddRule = {\n  rule: string;\n  index?: number;\n};\n\nexport type styleSheetDeleteRule = {\n  index: number;\n};\n\nexport type styleSheetRuleParam = {\n  id: number;\n  removes?: styleSheetDeleteRule[];\n  adds?: styleSheetAddRule[];\n};\n\nexport type styleSheetRuleCallback = (s: styleSheetRuleParam) => void;\n\nexport type canvasMutationCallback = (p: canvasMutationParam) => void;\n\nexport type canvasMutationParam = {\n  id: number;\n  property: string;\n  args: Array<unknown>;\n  setter?: true;\n};\n\nexport type fontParam = {\n  family: string;\n  fontSource: string;\n  buffer: boolean;\n  descriptors?: FontFaceDescriptors;\n};\n\nexport type LogLevel =\n  | 'assert'\n  | 'clear'\n  | 'count'\n  | 'countReset'\n  | 'debug'\n  | 'dir'\n  | 'dirxml'\n  | 'error'\n  | 'group'\n  | 'groupCollapsed'\n  | 'groupEnd'\n  | 'info'\n  | 'log'\n  | 'table'\n  | 'time'\n  | 'timeEnd'\n  | 'timeLog'\n  | 'trace'\n  | 'warn';\n\n/* fork from interface Console */\n// all kinds of console functions\nexport type Logger = {\n  assert?: typeof console.assert;\n  clear?: typeof console.clear;\n  count?: typeof console.count;\n  countReset?: typeof console.countReset;\n  debug?: typeof console.debug;\n  dir?: typeof console.dir;\n  dirxml?: typeof console.dirxml;\n  error?: typeof console.error;\n  group?: typeof console.group;\n  groupCollapsed?: typeof console.groupCollapsed;\n  groupEnd?: () => void;\n  info?: typeof console.info;\n  log?: typeof console.log;\n  table?: typeof console.table;\n  time?: typeof console.time;\n  timeEnd?: typeof console.timeEnd;\n  timeLog?: typeof console.timeLog;\n  trace?: typeof console.trace;\n  warn?: typeof console.warn;\n};\n\n/**\n * define an interface to replay log records\n * (data: logData) => void> function to display the log data\n */\nexport type ReplayLogger = Partial<Record<LogLevel, (data: logData) => void>>;\n\nexport type LogParam = {\n  level: LogLevel;\n  trace: string[];\n  payload: string[];\n};\n\nexport type fontCallback = (p: fontParam) => void;\n\nexport type logCallback = (p: LogParam) => void;\n\nexport type viewportResizeDimension = {\n  width: number;\n  height: number;\n};\n\nexport type viewportResizeCallback = (d: viewportResizeDimension) => void;\n\nexport type inputValue = {\n  text: string;\n  isChecked: boolean;\n};\n\nexport type inputCallback = (v: inputValue & { id: number }) => void;\n\nexport const enum MediaInteractions {\n  Play,\n  Pause,\n}\n\nexport type mediaInteractionParam = {\n  type: MediaInteractions;\n  id: number;\n};\n\nexport type mediaInteractionCallback = (p: mediaInteractionParam) => void;\n\nexport type DocumentDimension = {\n  x: number;\n  y: number;\n  // scale value relative to its parent iframe\n  relativeScale: number;\n  // scale value relative to the root iframe\n  absoluteScale: number;\n};\n\nexport type Mirror = {\n  map: idNodeMap;\n  getId: (n: INode) => number;\n  getNode: (id: number) => INode | null;\n  removeNodeFromMap: (n: INode) => void;\n  has: (id: number) => boolean;\n  reset: () => void;\n};\n\nexport type throttleOptions = {\n  leading?: boolean;\n  trailing?: boolean;\n};\n\nexport type listenerHandler = () => void;\nexport type hookResetter = () => void;\n\nexport type playerConfig = {\n  speed: number;\n  maxSpeed: number;\n  root: Element;\n  loadTimeout: number;\n  skipInactive: boolean;\n  showWarning: boolean;\n  showDebug: boolean;\n  blockClass: string;\n  liveMode: boolean;\n  insertStyleRules: string[];\n  triggerFocus: boolean;\n  UNSAFE_replayCanvas: boolean;\n  pauseAnimation?: boolean;\n  mouseTail:\n  | boolean\n  | {\n    duration?: number;\n    lineCap?: string;\n    lineWidth?: number;\n    strokeStyle?: string;\n  };\n  unpackFn?: UnpackFn;\n  logConfig: LogReplayConfig;\n};\n\nexport type LogReplayConfig = {\n  level?: LogLevel[] | undefined;\n  replayLogger: ReplayLogger | undefined;\n};\n\nexport type playerMetaData = {\n  startTime: number;\n  endTime: number;\n  totalTime: number;\n};\n\nexport type missingNode = {\n  node: Node;\n  mutation: addedNodeMutation;\n};\nexport type missingNodeMap = {\n  [id: number]: missingNode;\n};\n\nexport type actionWithDelay = {\n  doAction: () => void;\n  delay: number;\n};\n\nexport type Handler = (event?: unknown) => void;\n\nexport type Emitter = {\n  on(type: string, handler: Handler): void;\n  emit(type: string, event?: unknown): void;\n  off(type: string, handler: Handler): void;\n};\n\nexport type Arguments<T> = T extends (...payload: infer U) => unknown\n  ? U\n  : unknown;\n\nexport enum ReplayerEvents {\n  Start = 'start',\n  Pause = 'pause',\n  Resume = 'resume',\n  Resize = 'resize',\n  Finish = 'finish',\n  FullsnapshotRebuilded = 'fullsnapshot-rebuilded',\n  LoadStylesheetStart = 'load-stylesheet-start',\n  LoadStylesheetEnd = 'load-stylesheet-end',\n  SkipStart = 'skip-start',\n  SkipEnd = 'skip-end',\n  MouseInteraction = 'mouse-interaction',\n  EventCast = 'event-cast',\n  CustomEvent = 'custom-event',\n  Flush = 'flush',\n  StateChange = 'state-change',\n  PlayBack = 'play-back',\n}\n\nexport type MaskInputFn = (text: string) => string;\n\nexport type MaskTextFn = (text: string) => string;\n\n// store the state that would be changed during the process(unmount from dom and mount again)\nexport type ElementState = {\n  // [scrollLeft,scrollTop]\n  scroll?: [number, number];\n};\n\nexport type StringifyOptions = {\n  // limit of string length\n  stringLengthLimit?: number;\n  /**\n   * limit of number of keys in an object\n   * if an object contains more keys than this limit, we would call its toString function directly\n   */\n  numOfKeysLimit: number;\n};\n\nexport type LogRecordOptions = {\n  level?: LogLevel[] | undefined;\n  lengthThreshold?: number;\n  stringifyOptions?: StringifyOptions;\n  logger?: Logger;\n};\n","import {\n  Mirror,\n  throttleOptions,\n  listenerHandler,\n  hookResetter,\n  blockClass,\n  eventWithTime,\n  EventType,\n  IncrementalSource,\n  addedNodeMutation,\n  removedNodeMutation,\n  textMutation,\n  attributeMutation,\n  mutationData,\n  scrollData,\n  inputData,\n  DocumentDimension,\n} from './types';\nimport {\n  INode,\n  IGNORED_NODE,\n  serializedNodeWithId,\n  NodeType,\n  isShadowRoot,\n} from './snapshot';\n\nexport function on(\n  type: string,\n  fn: EventListenerOrEventListenerObject,\n  target: Document | Window = document,\n): listenerHandler {\n  const options = { capture: true, passive: true };\n  target.addEventListener(type, fn, options);\n  return () => target.removeEventListener(type, fn, options);\n}\n\nexport function createMirror(): Mirror {\n  return {\n    map: {},\n    getId(n) {\n      // if n is not a serialized INode, use -1 as its id.\n      if (!n.__sn) {\n        return -1;\n      }\n      return n.__sn.id;\n    },\n    getNode(id) {\n      return this.map[id] || null;\n    },\n    // TODO: use a weakmap to get rid of manually memory management\n    removeNodeFromMap(n) {\n      const id = n.__sn && n.__sn.id;\n      delete this.map[id];\n      if (n.childNodes) {\n        n.childNodes.forEach((child) =>\n          this.removeNodeFromMap((child as Node) as INode),\n        );\n      }\n    },\n    has(id) {\n      return this.map.hasOwnProperty(id);\n    },\n    reset() {\n      this.map = {};\n    },\n  };\n}\n\n// https://github.com/rrweb-io/rrweb/pull/407\nconst DEPARTED_MIRROR_ACCESS_WARNING =\n  'Please stop import mirror directly. Instead of that,' +\n  '\\r\\n' +\n  'now you can use replayer.getMirror() to access the mirror instance of a replayer,' +\n  '\\r\\n' +\n  'or you can use record.mirror to access the mirror instance during recording.';\nexport let _mirror: Mirror = {\n  map: {},\n  getId() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n    return -1;\n  },\n  getNode() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n    return null;\n  },\n  removeNodeFromMap() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n  },\n  has() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n    return false;\n  },\n  reset() {\n    console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n  },\n};\nif (typeof window !== 'undefined' && window.Proxy && window.Reflect) {\n  _mirror = new Proxy(_mirror, {\n    get(target, prop, receiver) {\n      if (prop === 'map') {\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\n      }\n      return Reflect.get(target, prop, receiver);\n    },\n  });\n}\n\n// copy from underscore and modified\nexport function throttle<T>(\n  func: (arg: T) => void,\n  wait: number,\n  options: throttleOptions = {},\n) {\n  let timeout: number | null = null;\n  let previous = 0;\n  // tslint:disable-next-line: only-arrow-functions\n  return function (arg: T) {\n    let now = Date.now();\n    if (!previous && options.leading === false) {\n      previous = now;\n    }\n    let remaining = wait - (now - previous);\n    let context = this;\n    let args = arguments as any;\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        window.clearTimeout(timeout);\n        timeout = null;\n      }\n      previous = now;\n      func.apply(context, args);\n    } else if (!timeout && options.trailing !== false) {\n      timeout = window.setTimeout(() => {\n        previous = options.leading === false ? 0 : Date.now();\n        timeout = null;\n        func.apply(context, args);\n      }, remaining);\n    }\n  };\n}\n\nexport function hookSetter<T>(\n  target: T,\n  key: string | number | symbol,\n  d: PropertyDescriptor,\n  isRevoked?: boolean,\n  win = window,\n): hookResetter {\n  const original = win.Object.getOwnPropertyDescriptor(target, key);\n  win.Object.defineProperty(\n    target,\n    key,\n    isRevoked\n      ? d\n      : {\n        set(value) {\n          // put hooked setter into event loop to avoid of set latency\n          setTimeout(() => {\n            d.set!.call(this, value);\n          }, 0);\n          if (original && original.set) {\n            original.set.call(this, value);\n          }\n        },\n      },\n  );\n  return () => hookSetter(target, key, original || {}, true);\n}\n\n// copy from https://github.com/getsentry/sentry-javascript/blob/b2109071975af8bf0316d3b5b38f519bdaf5dc15/packages/utils/src/object.ts\nexport function patch(\n  // tslint:disable-next-line:no-any\n  source: { [key: string]: any },\n  name: string,\n  // tslint:disable-next-line:no-any\n  replacement: (...args: any[]) => any,\n): () => void {\n  try {\n    if (!(name in source)) {\n      return () => { };\n    }\n\n    const original = source[name] as () => unknown;\n    const wrapped = replacement(original);\n\n    // Make sure it's a function first, as we need to attach an empty prototype for `defineProperties` to work\n    // otherwise it'll throw \"TypeError: Object.defineProperties called on non-object\"\n    // tslint:disable-next-line:strict-type-predicates\n    if (typeof wrapped === 'function') {\n      wrapped.prototype = wrapped.prototype || {};\n      Object.defineProperties(wrapped, {\n        __rrweb_original__: {\n          enumerable: false,\n          value: original,\n        },\n      });\n    }\n\n    source[name] = wrapped;\n\n    return () => {\n      source[name] = original;\n    };\n  } catch {\n    return () => { };\n    // This can throw if multiple fill happens on a global object like XMLHttpRequest\n    // Fixes https://github.com/getsentry/sentry-javascript/issues/2043\n  }\n}\n\nexport function getWindowHeight(): number {\n  return (\n    window.innerHeight ||\n    (document.documentElement && document.documentElement.clientHeight) ||\n    (document.body && document.body.clientHeight)\n  );\n}\n\nexport function getWindowWidth(): number {\n  return (\n    window.innerWidth ||\n    (document.documentElement && document.documentElement.clientWidth) ||\n    (document.body && document.body.clientWidth)\n  );\n}\n\nexport function isBlocked(node: Node | null, blockClass: blockClass): boolean {\n  if (!node) {\n    return false;\n  }\n  if (node.nodeType === node.ELEMENT_NODE) {\n    let needBlock = false;\n    if (typeof blockClass === 'string') {\n      needBlock = (node as HTMLElement).classList.contains(blockClass);\n    } else {\n      (node as HTMLElement).classList.forEach((className) => {\n        if (blockClass.test(className)) {\n          needBlock = true;\n        }\n      });\n    }\n    return needBlock || isBlocked(node.parentNode, blockClass);\n  }\n  if (node.nodeType === node.TEXT_NODE) {\n    // check parent node since text node do not have class name\n    return isBlocked(node.parentNode, blockClass);\n  }\n  return isBlocked(node.parentNode, blockClass);\n}\n\nexport function isIgnored(n: Node | INode): boolean {\n  if ('__sn' in n) {\n    return (n as INode).__sn.id === IGNORED_NODE;\n  }\n  // The main part of the slimDOM check happens in\n  // rrweb-snapshot::serializeNodeWithId\n  return false;\n}\n\nexport function isAncestorRemoved(target: INode, mirror: Mirror): boolean {\n  if (isShadowRoot(target)) {\n    return false;\n  }\n  const id = mirror.getId(target);\n  if (!mirror.has(id)) {\n    return true;\n  }\n  if (\n    target.parentNode &&\n    target.parentNode.nodeType === target.DOCUMENT_NODE\n  ) {\n    return false;\n  }\n  // if the root is not document, it means the node is not in the DOM tree anymore\n  if (!target.parentNode) {\n    return true;\n  }\n  return isAncestorRemoved((target.parentNode as unknown) as INode, mirror);\n}\n\nexport function isTouchEvent(\n  event: MouseEvent | TouchEvent,\n): event is TouchEvent {\n  return Boolean((event as TouchEvent).changedTouches);\n}\n\nexport function polyfill(win = window) {\n  if ('NodeList' in win && !win.NodeList.prototype.forEach) {\n    win.NodeList.prototype.forEach = (Array.prototype\n      .forEach as unknown) as NodeList['forEach'];\n  }\n\n  if ('DOMTokenList' in win && !win.DOMTokenList.prototype.forEach) {\n    win.DOMTokenList.prototype.forEach = (Array.prototype\n      .forEach as unknown) as DOMTokenList['forEach'];\n  }\n\n  // https://github.com/Financial-Times/polyfill-service/pull/183\n  if (!Node.prototype.contains) {\n    Node.prototype.contains = function contains(node) {\n      if (!(0 in arguments)) {\n        throw new TypeError('1 argument is required');\n      }\n\n      do {\n        if (this === node) {\n          return true;\n        }\n        // tslint:disable-next-line: no-conditional-assignment\n      } while ((node = node && node.parentNode));\n\n      return false;\n    };\n  }\n}\n\nexport function needCastInSyncMode(event: eventWithTime): boolean {\n  switch (event.type) {\n    case EventType.DomContentLoaded:\n    case EventType.Load:\n    case EventType.Custom:\n      return false;\n    case EventType.FullSnapshot:\n    case EventType.Meta:\n      return true;\n    default:\n      break;\n  }\n\n  switch (event.data.source) {\n    case IncrementalSource.MouseMove:\n    case IncrementalSource.MouseInteraction:\n    case IncrementalSource.TouchMove:\n    case IncrementalSource.MediaInteraction:\n      return false;\n    case IncrementalSource.ViewportResize:\n    case IncrementalSource.StyleSheetRule:\n    case IncrementalSource.Scroll:\n    case IncrementalSource.Input:\n      return true;\n    default:\n      break;\n  }\n\n  return true;\n}\n\nexport type TreeNode = {\n  id: number;\n  mutation: addedNodeMutation;\n  parent?: TreeNode;\n  children: Record<number, TreeNode>;\n  texts: textMutation[];\n  attributes: attributeMutation[];\n};\nexport class TreeIndex {\n  public tree!: Record<number, TreeNode>;\n\n  private removeNodeMutations!: removedNodeMutation[];\n  private textMutations!: textMutation[];\n  private attributeMutations!: attributeMutation[];\n  private indexes!: Map<number, TreeNode>;\n  private removeIdSet!: Set<number>;\n  private scrollMap!: Map<number, scrollData>;\n  private inputMap!: Map<number, inputData>;\n\n  constructor() {\n    this.reset();\n  }\n\n  public add(mutation: addedNodeMutation) {\n    const parentTreeNode = this.indexes.get(mutation.parentId);\n    const treeNode: TreeNode = {\n      id: mutation.node.id,\n      mutation,\n      children: [],\n      texts: [],\n      attributes: [],\n    };\n    if (!parentTreeNode) {\n      this.tree[treeNode.id] = treeNode;\n    } else {\n      treeNode.parent = parentTreeNode;\n      parentTreeNode.children[treeNode.id] = treeNode;\n    }\n    this.indexes.set(treeNode.id, treeNode);\n  }\n\n  public remove(mutation: removedNodeMutation, mirror: Mirror) {\n    const parentTreeNode = this.indexes.get(mutation.parentId);\n    const treeNode = this.indexes.get(mutation.id);\n\n    const deepRemoveFromMirror = (id: number) => {\n      this.removeIdSet.add(id);\n      const node = mirror.getNode(id);\n      node?.childNodes.forEach((childNode) => {\n        if ('__sn' in childNode) {\n          deepRemoveFromMirror(((childNode as unknown) as INode).__sn.id);\n        }\n      });\n    };\n    const deepRemoveFromTreeIndex = (node: TreeNode) => {\n      this.removeIdSet.add(node.id);\n      Object.values(node.children).forEach((n) => deepRemoveFromTreeIndex(n));\n      const _treeNode = this.indexes.get(node.id);\n      if (_treeNode) {\n        const _parentTreeNode = _treeNode.parent;\n        if (_parentTreeNode) {\n          delete _treeNode.parent;\n          delete _parentTreeNode.children[_treeNode.id];\n          this.indexes.delete(mutation.id);\n        }\n      }\n    };\n\n    if (!treeNode) {\n      this.removeNodeMutations.push(mutation);\n      deepRemoveFromMirror(mutation.id);\n    } else if (!parentTreeNode) {\n      delete this.tree[treeNode.id];\n      this.indexes.delete(treeNode.id);\n      deepRemoveFromTreeIndex(treeNode);\n    } else {\n      delete treeNode.parent;\n      delete parentTreeNode.children[treeNode.id];\n      this.indexes.delete(mutation.id);\n      deepRemoveFromTreeIndex(treeNode);\n    }\n  }\n\n  public text(mutation: textMutation) {\n    const treeNode = this.indexes.get(mutation.id);\n    if (treeNode) {\n      treeNode.texts.push(mutation);\n    } else {\n      this.textMutations.push(mutation);\n    }\n  }\n\n  public attribute(mutation: attributeMutation) {\n    const treeNode = this.indexes.get(mutation.id);\n    if (treeNode) {\n      treeNode.attributes.push(mutation);\n    } else {\n      this.attributeMutations.push(mutation);\n    }\n  }\n\n  public scroll(d: scrollData) {\n    this.scrollMap.set(d.id, d);\n  }\n\n  public input(d: inputData) {\n    this.inputMap.set(d.id, d);\n  }\n\n  public flush(): {\n    mutationData: mutationData;\n    scrollMap: TreeIndex['scrollMap'];\n    inputMap: TreeIndex['inputMap'];\n  } {\n    const {\n      tree,\n      removeNodeMutations,\n      textMutations,\n      attributeMutations,\n    } = this;\n\n    const batchMutationData: mutationData = {\n      source: IncrementalSource.Mutation,\n      removes: removeNodeMutations,\n      texts: textMutations,\n      attributes: attributeMutations,\n      adds: [],\n    };\n\n    const walk = (treeNode: TreeNode, removed: boolean) => {\n      if (removed) {\n        this.removeIdSet.add(treeNode.id);\n      }\n      batchMutationData.texts = batchMutationData.texts\n        .concat(removed ? [] : treeNode.texts)\n        .filter((m) => !this.removeIdSet.has(m.id));\n      batchMutationData.attributes = batchMutationData.attributes\n        .concat(removed ? [] : treeNode.attributes)\n        .filter((m) => !this.removeIdSet.has(m.id));\n      if (\n        !this.removeIdSet.has(treeNode.id) &&\n        !this.removeIdSet.has(treeNode.mutation.parentId) &&\n        !removed\n      ) {\n        batchMutationData.adds.push(treeNode.mutation);\n        if (treeNode.children) {\n          Object.values(treeNode.children).forEach((n) => walk(n, false));\n        }\n      } else {\n        Object.values(treeNode.children).forEach((n) => walk(n, true));\n      }\n    };\n\n    Object.values(tree).forEach((n) => walk(n, false));\n\n    for (const id of this.scrollMap.keys()) {\n      if (this.removeIdSet.has(id)) {\n        this.scrollMap.delete(id);\n      }\n    }\n    for (const id of this.inputMap.keys()) {\n      if (this.removeIdSet.has(id)) {\n        this.inputMap.delete(id);\n      }\n    }\n\n    const scrollMap = new Map(this.scrollMap);\n    const inputMap = new Map(this.inputMap);\n\n    this.reset();\n\n    return {\n      mutationData: batchMutationData,\n      scrollMap,\n      inputMap,\n    };\n  }\n\n  private reset() {\n    this.tree = [];\n    this.indexes = new Map();\n    this.removeNodeMutations = [];\n    this.textMutations = [];\n    this.attributeMutations = [];\n    this.removeIdSet = new Set();\n    this.scrollMap = new Map();\n    this.inputMap = new Map();\n  }\n}\n\ntype ResolveTree = {\n  value: addedNodeMutation;\n  children: ResolveTree[];\n  parent: ResolveTree | null;\n};\n\nexport function queueToResolveTrees(queue: addedNodeMutation[]): ResolveTree[] {\n  const queueNodeMap: Record<number, ResolveTree> = {};\n  const putIntoMap = (\n    m: addedNodeMutation,\n    parent: ResolveTree | null,\n  ): ResolveTree => {\n    const nodeInTree: ResolveTree = {\n      value: m,\n      parent,\n      children: [],\n    };\n    queueNodeMap[m.node.id] = nodeInTree;\n    return nodeInTree;\n  };\n\n  const queueNodeTrees: ResolveTree[] = [];\n  for (const mutation of queue) {\n    const { nextId, parentId } = mutation;\n    if (nextId && nextId in queueNodeMap) {\n      const nextInTree = queueNodeMap[nextId];\n      if (nextInTree.parent) {\n        const idx = nextInTree.parent.children.indexOf(nextInTree);\n        nextInTree.parent.children.splice(\n          idx,\n          0,\n          putIntoMap(mutation, nextInTree.parent),\n        );\n      } else {\n        const idx = queueNodeTrees.indexOf(nextInTree);\n        queueNodeTrees.splice(idx, 0, putIntoMap(mutation, null));\n      }\n      continue;\n    }\n    if (parentId in queueNodeMap) {\n      const parentInTree = queueNodeMap[parentId];\n      parentInTree.children.push(putIntoMap(mutation, parentInTree));\n      continue;\n    }\n    queueNodeTrees.push(putIntoMap(mutation, null));\n  }\n\n  return queueNodeTrees;\n}\n\nexport function iterateResolveTree(\n  tree: ResolveTree,\n  cb: (mutation: addedNodeMutation) => unknown,\n) {\n  cb(tree.value);\n  /**\n   * The resolve tree was designed to reflect the DOM layout,\n   * but we need append next sibling first, so we do a reverse\n   * loop here.\n   */\n  for (let i = tree.children.length - 1; i >= 0; i--) {\n    iterateResolveTree(tree.children[i], cb);\n  }\n}\n\ntype HTMLIFrameINode = HTMLIFrameElement & {\n  __sn: serializedNodeWithId;\n};\nexport type AppendedIframe = {\n  mutationInQueue: addedNodeMutation;\n  builtNode: HTMLIFrameINode;\n};\n\nexport function isIframeINode(\n  node: INode | ShadowRoot,\n): node is HTMLIFrameINode {\n  if ('__sn' in node) {\n    return (\n      node.__sn.type === NodeType.Element && node.__sn.tagName === 'iframe'\n    );\n  }\n  // node can be document fragment when using the virtual parent feature\n  return false;\n}\n\nexport function getBaseDimension(\n  node: Node,\n  rootIframe: Node,\n): DocumentDimension {\n  const frameElement = node.ownerDocument?.defaultView?.frameElement;\n  if (!frameElement || frameElement === rootIframe) {\n    return {\n      x: 0,\n      y: 0,\n      relativeScale: 1,\n      absoluteScale: 1,\n    };\n  }\n\n  const frameDimension = frameElement.getBoundingClientRect();\n  const frameBaseDimension = getBaseDimension(frameElement, rootIframe);\n  // the iframe element may have a scale transform\n  const relativeScale = frameDimension.height / frameElement.clientHeight;\n  return {\n    x:\n      frameDimension.x * frameBaseDimension.relativeScale +\n      frameBaseDimension.x,\n    y:\n      frameDimension.y * frameBaseDimension.relativeScale +\n      frameBaseDimension.y,\n    relativeScale,\n    absoluteScale: frameBaseDimension.absoluteScale * relativeScale,\n  };\n}\n\nexport function hasShadowRoot<T extends Node>(\n  n: T,\n): n is T & { shadowRoot: ShadowRoot } {\n  return Boolean(((n as unknown) as Element)?.shadowRoot);\n}\n","// @ts-nocheck\nimport {\n  INode,\n  serializeNodeWithId,\n  transformAttribute,\n  MaskInputOptions,\n  SlimDOMOptions,\n  IGNORED_NODE,\n  isShadowRoot,\n  needMaskingText,\n} from '../snapshot';\nimport {\n  mutationRecord,\n  blockClass,\n  maskTextClass,\n  mutationCallBack,\n  textCursor,\n  attributeCursor,\n  removedNodeMutation,\n  addedNodeMutation,\n  MaskTextFn,\n  Mirror,\n} from '../types';\nimport {\n  isBlocked,\n  isAncestorRemoved,\n  isIgnored,\n  isIframeINode,\n  hasShadowRoot,\n} from '../utils';\nimport { IframeManager } from './iframe-manager';\nimport { ShadowDomManager } from './shadow-dom-manager';\n\ntype DoubleLinkedListNode = {\n  previous: DoubleLinkedListNode | null;\n  next: DoubleLinkedListNode | null;\n  value: NodeInLinkedList;\n};\ntype NodeInLinkedList = Node & {\n  __ln: DoubleLinkedListNode;\n};\n\nfunction isNodeInLinkedList(n: Node | NodeInLinkedList): n is NodeInLinkedList {\n  return '__ln' in n;\n}\nclass DoubleLinkedList {\n  public length = 0;\n  public head: DoubleLinkedListNode | null = null;\n\n  public get(position: number) {\n    if (position >= this.length) {\n      throw new Error('Position outside of list range');\n    }\n\n    let current = this.head;\n    for (let index = 0; index < position; index++) {\n      current = current?.next || null;\n    }\n    return current;\n  }\n\n  public addNode(n: Node) {\n    const node: DoubleLinkedListNode = {\n      value: n as NodeInLinkedList,\n      previous: null,\n      next: null,\n    };\n    (n as NodeInLinkedList).__ln = node;\n    if (n.previousSibling && isNodeInLinkedList(n.previousSibling)) {\n      const current = n.previousSibling.__ln.next;\n      node.next = current;\n      node.previous = n.previousSibling.__ln;\n      n.previousSibling.__ln.next = node;\n      if (current) {\n        current.previous = node;\n      }\n    } else if (\n      n.nextSibling &&\n      isNodeInLinkedList(n.nextSibling) &&\n      n.nextSibling.__ln.previous\n    ) {\n      const current = n.nextSibling.__ln.previous;\n      node.previous = current;\n      node.next = n.nextSibling.__ln;\n      n.nextSibling.__ln.previous = node;\n      if (current) {\n        current.next = node;\n      }\n    } else {\n      if (this.head) {\n        this.head.previous = node;\n      }\n      node.next = this.head;\n      this.head = node;\n    }\n    this.length++;\n  }\n\n  public removeNode(n: NodeInLinkedList) {\n    const current = n.__ln;\n    if (!this.head) {\n      return;\n    }\n\n    if (!current.previous) {\n      this.head = current.next;\n      if (this.head) {\n        this.head.previous = null;\n      }\n    } else {\n      current.previous.next = current.next;\n      if (current.next) {\n        current.next.previous = current.previous;\n      }\n    }\n    if (n.__ln) {\n      delete n.__ln;\n    }\n    this.length--;\n  }\n}\n\nconst moveKey = (id: number, parentId: number) => `${id}@${parentId}`;\nfunction isINode(n: Node | INode): n is INode {\n  return '__sn' in n;\n}\n\n/**\n * controls behaviour of a MutationObserver\n */\nexport default class MutationBuffer {\n  private frozen: boolean = false;\n  private locked: boolean = false;\n\n  private texts: textCursor[] = [];\n  private attributes: attributeCursor[] = [];\n  private removes: removedNodeMutation[] = [];\n  private mapRemoves: Node[] = [];\n\n  private movedMap: Record<string, true> = {};\n\n  /**\n   * the browser MutationObserver emits multiple mutations after\n   * a delay for performance reasons, making tracing added nodes hard\n   * in our `processMutations` callback function.\n   * For example, if we append an element el_1 into body, and then append\n   * another element el_2 into el_1, these two mutations may be passed to the\n   * callback function together when the two operations were done.\n   * Generally we need to trace child nodes of newly added nodes, but in this\n   * case if we count el_2 as el_1's child node in the first mutation record,\n   * then we will count el_2 again in the second mutation record which was\n   * duplicated.\n   * To avoid of duplicate counting added nodes, we use a Set to store\n   * added nodes and its child nodes during iterate mutation records. Then\n   * collect added nodes from the Set which have no duplicate copy. But\n   * this also causes newly added nodes will not be serialized with id ASAP,\n   * which means all the id related calculation should be lazy too.\n   */\n  private addedSet = new Set<Node>();\n  private movedSet = new Set<Node>();\n  private droppedSet = new Set<Node>();\n\n  private emissionCallback: mutationCallBack;\n  private blockClass: blockClass;\n  private blockSelector: string | null;\n  private maskTextClass: maskTextClass;\n  private maskTextSelector: string | null;\n  private inlineStylesheet: boolean;\n  private maskInputOptions: MaskInputOptions;\n  private maskTextFn: MaskTextFn | undefined;\n  private recordCanvas: boolean;\n  private slimDOMOptions: SlimDOMOptions;\n  private doc: Document;\n\n  private mirror: Mirror;\n  private iframeManager: IframeManager;\n  private shadowDomManager: ShadowDomManager;\n\n  public init(\n    cb: mutationCallBack,\n    blockClass: blockClass,\n    blockSelector: string | null,\n    maskTextClass: maskTextClass,\n    maskTextSelector: string | null,\n    inlineStylesheet: boolean,\n    maskInputOptions: MaskInputOptions,\n    maskTextFn: MaskTextFn | undefined,\n    recordCanvas: boolean,\n    slimDOMOptions: SlimDOMOptions,\n    doc: Document,\n    mirror: Mirror,\n    iframeManager: IframeManager,\n    shadowDomManager: ShadowDomManager,\n  ) {\n    this.blockClass = blockClass;\n    this.blockSelector = blockSelector;\n    this.maskTextClass = maskTextClass;\n    this.maskTextSelector = maskTextSelector;\n    this.inlineStylesheet = inlineStylesheet;\n    this.maskInputOptions = maskInputOptions;\n    this.maskTextFn = maskTextFn;\n    this.recordCanvas = recordCanvas;\n    this.slimDOMOptions = slimDOMOptions;\n    this.emissionCallback = cb;\n    this.doc = doc;\n    this.mirror = mirror;\n    this.iframeManager = iframeManager;\n    this.shadowDomManager = shadowDomManager;\n  }\n\n  public freeze() {\n    this.frozen = true;\n  }\n\n  public unfreeze() {\n    this.frozen = false;\n    this.emit();\n  }\n\n  public isFrozen() {\n    return this.frozen;\n  }\n\n  public lock() {\n    this.locked = true;\n  }\n\n  public unlock() {\n    this.locked = false;\n    this.emit();\n  }\n\n  public processMutations = (mutations: mutationRecord[]) => {\n    mutations.forEach(this.processMutation);\n    this.emit();\n  };\n\n  public emit = () => {\n    if (this.frozen || this.locked) {\n      return;\n    }\n\n    // delay any modification of the mirror until this function\n    // so that the mirror for takeFullSnapshot doesn't get mutated while it's event is being processed\n\n    const adds: addedNodeMutation[] = [];\n\n    /**\n     * Sometimes child node may be pushed before its newly added\n     * parent, so we init a queue to store these nodes.\n     */\n    const addList = new DoubleLinkedList();\n    const getNextId = (n: Node): number | null => {\n      let ns: Node | null = n;\n      let nextId: number | null = IGNORED_NODE; // slimDOM: ignored\n      while (nextId === IGNORED_NODE) {\n        ns = ns && ns.nextSibling;\n        nextId = ns && this.mirror.getId((ns as unknown) as INode);\n      }\n      if (nextId === -1 && isBlocked(n.nextSibling, this.blockClass)) {\n        nextId = null;\n      }\n      return nextId;\n    };\n    const pushAdd = (n: Node) => {\n      const shadowHost: Element | null = n.getRootNode\n        ? (n.getRootNode() as ShadowRoot)?.host\n        : null;\n      const notInDoc = !this.doc.contains(n) && !this.doc.contains(shadowHost);\n      if (!n.parentNode || notInDoc) {\n        return;\n      }\n      const parentId = isShadowRoot(n.parentNode)\n        ? this.mirror.getId((shadowHost as unknown) as INode)\n        : this.mirror.getId((n.parentNode as Node) as INode);\n      const nextId = getNextId(n);\n      if (parentId === -1 || nextId === -1) {\n        return addList.addNode(n);\n      }\n      let sn = serializeNodeWithId(n, {\n        doc: this.doc,\n        map: this.mirror.map,\n        blockClass: this.blockClass,\n        blockSelector: this.blockSelector,\n        maskTextClass: this.maskTextClass,\n        maskTextSelector: this.maskTextSelector,\n        skipChild: true,\n        inlineStylesheet: this.inlineStylesheet,\n        maskInputOptions: this.maskInputOptions,\n        maskTextFn: this.maskTextFn,\n        slimDOMOptions: this.slimDOMOptions,\n        recordCanvas: this.recordCanvas,\n        onSerialize: (currentN) => {\n          if (isIframeINode(currentN)) {\n            this.iframeManager.addIframe(currentN);\n          }\n          if (hasShadowRoot(n)) {\n            this.shadowDomManager.addShadowRoot(n.shadowRoot, document);\n          }\n        },\n        onIframeLoad: (iframe, childSn) => {\n          this.iframeManager.attachIframe(iframe, childSn);\n        },\n      });\n      if (sn) {\n        adds.push({\n          parentId,\n          nextId,\n          node: sn,\n        });\n      }\n    };\n\n    while (this.mapRemoves.length) {\n      this.mirror.removeNodeFromMap(this.mapRemoves.shift() as INode);\n    }\n\n    for (const n of this.movedSet) {\n      if (\n        isParentRemoved(this.removes, n, this.mirror) &&\n        !this.movedSet.has(n.parentNode!)\n      ) {\n        continue;\n      }\n      pushAdd(n);\n    }\n\n    for (const n of this.addedSet) {\n      if (\n        !isAncestorInSet(this.droppedSet, n) &&\n        !isParentRemoved(this.removes, n, this.mirror)\n      ) {\n        pushAdd(n);\n      } else if (isAncestorInSet(this.movedSet, n)) {\n        pushAdd(n);\n      } else {\n        this.droppedSet.add(n);\n      }\n    }\n\n    let candidate: DoubleLinkedListNode | null = null;\n    while (addList.length) {\n      let node: DoubleLinkedListNode | null = null;\n      if (candidate) {\n        const parentId = this.mirror.getId(\n          (candidate.value.parentNode as Node) as INode,\n        );\n        const nextId = getNextId(candidate.value);\n        if (parentId !== -1 && nextId !== -1) {\n          node = candidate;\n        }\n      }\n      if (!node) {\n        for (let index = addList.length - 1; index >= 0; index--) {\n          const _node = addList.get(index)!;\n          const parentId = this.mirror.getId(\n            (_node.value.parentNode as Node) as INode,\n          );\n          const nextId = getNextId(_node.value);\n          if (parentId !== -1 && nextId !== -1) {\n            node = _node;\n            break;\n          }\n        }\n      }\n      if (!node) {\n        /**\n         * If all nodes in queue could not find a serialized parent,\n         * it may be a bug or corner case. We need to escape the\n         * dead while loop at once.\n         */\n        while (addList.head) {\n          addList.removeNode(addList.head.value);\n        }\n        break;\n      }\n      candidate = node.previous;\n      addList.removeNode(node.value);\n      pushAdd(node.value);\n    }\n\n    const payload = {\n      texts: this.texts\n        .map((text) => ({\n          id: this.mirror.getId(text.node as INode),\n          value: text.value,\n        }))\n        // text mutation's id was not in the mirror map means the target node has been removed\n        .filter((text) => this.mirror.has(text.id)),\n      attributes: this.attributes\n        .map((attribute) => ({\n          id: this.mirror.getId(attribute.node as INode),\n          attributes: attribute.attributes,\n        }))\n        // attribute mutation's id was not in the mirror map means the target node has been removed\n        .filter((attribute) => this.mirror.has(attribute.id)),\n      removes: this.removes,\n      adds,\n    };\n    // payload may be empty if the mutations happened in some blocked elements\n    if (\n      !payload.texts.length &&\n      !payload.attributes.length &&\n      !payload.removes.length &&\n      !payload.adds.length\n    ) {\n      return;\n    }\n\n    // reset\n    this.texts = [];\n    this.attributes = [];\n    this.removes = [];\n    this.addedSet = new Set<Node>();\n    this.movedSet = new Set<Node>();\n    this.droppedSet = new Set<Node>();\n    this.movedMap = {};\n\n    this.emissionCallback(payload);\n  };\n\n  private processMutation = (m: mutationRecord) => {\n    // console.log({ m });\n    if (isIgnored(m.target)) {\n      return;\n    }\n    switch (m.type) {\n      case 'characterData': {\n        const value = m.target.textContent;\n        if (!isBlocked(m.target, this.blockClass) && value !== m.oldValue) {\n          this.texts.push({\n            value:\n              needMaskingText(\n                m.target,\n                this.maskTextClass,\n                this.maskTextSelector,\n              ) && value\n                ? this.maskTextFn\n                  ? this.maskTextFn(value)\n                  : value.replace(/[\\S]/g, '*')\n                : value,\n            node: m.target,\n          });\n        }\n        break;\n      }\n      case 'attributes': {\n        const value = (m.target as HTMLElement).getAttribute(m.attributeName!);\n        if (isBlocked(m.target, this.blockClass) || value === m.oldValue) {\n          return;\n        }\n        let item: attributeCursor | undefined = this.attributes.find(\n          (a) => a.node === m.target,\n        );\n        if (!item) {\n          item = {\n            node: m.target,\n            attributes: {},\n          };\n          this.attributes.push(item);\n        }\n        // overwrite attribute if the mutations was triggered in same time\n        item.attributes[m.attributeName!] = transformAttribute(\n          this.doc,\n          (m.target as HTMLElement).tagName,\n          m.attributeName!,\n          value!,\n        );\n        break;\n      }\n      case 'childList': {\n        m.addedNodes.forEach((n) => this.genAdds(n, m.target));\n        m.removedNodes.forEach((n) => {\n          const nodeId = this.mirror.getId(n as INode);\n          const parentId = isShadowRoot(m.target)\n            ? this.mirror.getId((m.target.host as unknown) as INode)\n            : this.mirror.getId(m.target as INode);\n          if (\n            isBlocked(n, this.blockClass) ||\n            isBlocked(m.target, this.blockClass) ||\n            isIgnored(n)\n          ) {\n            return;\n          }\n          // removed node has not been serialized yet, just remove it from the Set\n          if (this.addedSet.has(n)) {\n            deepDelete(this.addedSet, n);\n            this.droppedSet.add(n);\n          } else if (this.addedSet.has(m.target) && nodeId === -1) {\n            /**\n             * If target was newly added and removed child node was\n             * not serialized, it means the child node has been removed\n             * before callback fired, so we can ignore it because\n             * newly added node will be serialized without child nodes.\n             * TODO: verify this\n             */\n          } else if (isAncestorRemoved(m.target as INode, this.mirror)) {\n            /**\n             * If parent id was not in the mirror map any more, it\n             * means the parent node has already been removed. So\n             * the node is also removed which we do not need to track\n             * and replay.\n             */\n          } else if (\n            this.movedSet.has(n) &&\n            this.movedMap[moveKey(nodeId, parentId)]\n          ) {\n            deepDelete(this.movedSet, n);\n          } else {\n            this.removes.push({\n              parentId,\n              id: nodeId,\n              isShadow: isShadowRoot(m.target) ? true : undefined,\n            });\n          }\n          this.mapRemoves.push(n);\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  };\n\n  private genAdds = (n: Node | INode, target?: Node | INode) => {\n    if (isBlocked(n, this.blockClass)) {\n      return;\n    }\n    if (target && isBlocked(target, this.blockClass)) {\n      return;\n    }\n    if (isINode(n)) {\n      if (isIgnored(n)) {\n        return;\n      }\n      this.movedSet.add(n);\n      let targetId: number | null = null;\n      if (target && isINode(target)) {\n        targetId = target.__sn.id;\n      }\n      if (targetId) {\n        this.movedMap[moveKey(n.__sn.id, targetId)] = true;\n      }\n    } else {\n      this.addedSet.add(n);\n      this.droppedSet.delete(n);\n    }\n    n.childNodes.forEach((childN) => this.genAdds(childN));\n  };\n}\n\n/**\n * Some utils to handle the mutation observer DOM records.\n * It should be more clear to extend the native data structure\n * like Set and Map, but currently Typescript does not support\n * that.\n */\nfunction deepDelete(addsSet: Set<Node>, n: Node) {\n  addsSet.delete(n);\n  n.childNodes.forEach((childN) => deepDelete(addsSet, childN));\n}\n\nfunction isParentRemoved(\n  removes: removedNodeMutation[],\n  n: Node,\n  mirror: Mirror,\n): boolean {\n  const { parentNode } = n;\n  if (!parentNode) {\n    return false;\n  }\n  const parentId = mirror.getId((parentNode as Node) as INode);\n  if (removes.some((r) => r.id === parentId)) {\n    return true;\n  }\n  return isParentRemoved(removes, parentNode, mirror);\n}\n\nfunction isAncestorInSet(set: Set<Node>, n: Node): boolean {\n  const { parentNode } = n;\n  if (!parentNode) {\n    return false;\n  }\n  if (set.has(parentNode)) {\n    return true;\n  }\n  return isAncestorInSet(set, parentNode);\n}\n","// tslint:disable:no-any no-bitwise forin\n/**\n * this file is used to serialize log message to string\n *\n */\n\nimport { StringifyOptions } from '../types';\n\n/**\n * transfer the node path in Event to string\n * @param node the first node in a node path array\n */\nfunction pathToSelector(node: HTMLElement): string | '' {\n  if (!node || !node.outerHTML) {\n    return '';\n  }\n\n  let path = '';\n  while (node.parentElement) {\n    let name = node.localName;\n    if (!name) {\n      break;\n    }\n    name = name.toLowerCase();\n    let parent = node.parentElement;\n\n    let domSiblings = [];\n\n    if (parent.children && parent.children.length > 0) {\n      // tslint:disable-next-line:prefer-for-of\n      for (let i = 0; i < parent.children.length; i++) {\n        let sibling = parent.children[i];\n        if (sibling.localName && sibling.localName.toLowerCase) {\n          if (sibling.localName.toLowerCase() === name) {\n            domSiblings.push(sibling);\n          }\n        }\n      }\n    }\n\n    if (domSiblings.length > 1) {\n      name += ':eq(' + domSiblings.indexOf(node) + ')';\n    }\n    path = name + (path ? '>' + path : '');\n    node = parent;\n  }\n\n  return path;\n}\n\n/**\n * stringify any js object\n * @param obj the object to stringify\n */\nexport function stringify(\n  obj: any,\n  stringifyOptions?: StringifyOptions,\n): string {\n  const options: StringifyOptions = {\n    numOfKeysLimit: 50,\n  };\n  Object.assign(options, stringifyOptions);\n  const stack: any[] = [];\n  const keys: any[] = [];\n  return JSON.stringify(obj, function (key, value) {\n    /**\n     * forked from https://github.com/moll/json-stringify-safe/blob/master/stringify.js\n     * to deCycle the object\n     */\n    if (stack.length > 0) {\n      const thisPos = stack.indexOf(this);\n      ~thisPos ? stack.splice(thisPos + 1) : stack.push(this);\n      ~thisPos ? keys.splice(thisPos, Infinity, key) : keys.push(key);\n      if (~stack.indexOf(value)) {\n        if (stack[0] === value) {\n          value = '[Circular ~]';\n        } else {\n          value =\n            '[Circular ~.' +\n            keys.slice(0, stack.indexOf(value)).join('.') +\n            ']';\n        }\n      }\n    } else {\n      stack.push(value);\n    }\n    /* END of the FORK */\n\n    if (value === null || value === undefined) {\n      return value;\n    }\n    if (shouldToString(value)) {\n      return toString(value);\n    }\n    if (value instanceof Event) {\n      const eventResult: any = {};\n      for (const eventKey in value) {\n        const eventValue = (value as any)[eventKey];\n        if (Array.isArray(eventValue)) {\n          eventResult[eventKey] = pathToSelector(\n            eventValue.length ? eventValue[0] : null,\n          );\n        } else {\n          eventResult[eventKey] = eventValue;\n        }\n      }\n      return eventResult;\n    } else if (value instanceof Node) {\n      if (value instanceof HTMLElement) {\n        return value ? value.outerHTML : '';\n      }\n      return value.nodeName;\n    }\n    return value;\n  });\n\n  /**\n   * whether we should call toString function of this object\n   */\n  function shouldToString(_obj: object): boolean {\n    if (\n      typeof _obj === 'object' &&\n      Object.keys(_obj).length > options.numOfKeysLimit\n    ) {\n      return true;\n    }\n    if (typeof _obj === 'function') {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * limit the toString() result according to option\n   */\n  function toString(_obj: object): string {\n    let str = _obj.toString();\n    if (options.stringLengthLimit && str.length > options.stringLengthLimit) {\n      str = `${str.slice(0, options.stringLengthLimit)}...`;\n    }\n    return str;\n  }\n}\n","/**\n * Class StackFrame is a fork of https://github.com/stacktracejs/stackframe/blob/master/stackframe.js\n * I fork it because:\n * 1. There are some build issues when importing this package.\n * 2. Rewrites into typescript give us a better type interface.\n * 3. StackFrame contains some functions we don't need.\n */\nexport class StackFrame {\n  private fileName: string;\n  private functionName: string;\n  private lineNumber?: number;\n  private columnNumber?: number;\n\n  constructor(obj: {\n    fileName?: string;\n    functionName?: string;\n    lineNumber?: number;\n    columnNumber?: number;\n  }) {\n    this.fileName = obj.fileName || '';\n    this.functionName = obj.functionName || '';\n    this.lineNumber = obj.lineNumber;\n    this.columnNumber = obj.columnNumber;\n  }\n\n  toString() {\n    const lineNumber = this.lineNumber || '';\n    const columnNumber = this.columnNumber || '';\n    if (this.functionName) {\n      return (\n        this.functionName +\n        ' (' +\n        this.fileName +\n        ':' +\n        lineNumber +\n        ':' +\n        columnNumber +\n        ')'\n      );\n    }\n    return this.fileName + ':' + lineNumber + ':' + columnNumber;\n  }\n}\n\n/**\n * ErrorStackParser is a fork of https://github.com/stacktracejs/error-stack-parser/blob/master/error-stack-parser.js\n * I fork it because:\n * 1. There are some build issues when importing this package.\n * 2. Rewrites into typescript give us a better type interface.\n */\nconst FIREFOX_SAFARI_STACK_REGEXP = /(^|@)\\S+:\\d+/;\nconst CHROME_IE_STACK_REGEXP = /^\\s*at .*(\\S+:\\d+|\\(native\\))/m;\nconst SAFARI_NATIVE_CODE_REGEXP = /^(eval@)?(\\[native code])?$/;\nexport const ErrorStackParser = {\n  /**\n   * Given an Error object, extract the most information from it.\n   *\n   * @param {Error} error object\n   * @return {Array} of StackFrames\n   */\n  parse: function (error: Error): StackFrame[] {\n    if (\n      // @ts-ignore\n      typeof error.stacktrace !== 'undefined' ||\n      // @ts-ignore\n      typeof error['opera#sourceloc'] !== 'undefined'\n    ) {\n      return this.parseOpera(\n        error as {\n          stacktrace?: string;\n          message: string;\n          stack?: string;\n        },\n      );\n    } else if (error.stack && error.stack.match(CHROME_IE_STACK_REGEXP)) {\n      return this.parseV8OrIE(error as { stack: string });\n    } else if (error.stack) {\n      return this.parseFFOrSafari(error as { stack: string });\n    } else {\n      throw new Error('Cannot parse given Error object');\n    }\n  },\n  // Separate line and column numbers from a string of the form: (URI:Line:Column)\n  extractLocation: function (urlLike: string) {\n    // Fail-fast but return locations like \"(native)\"\n    if (urlLike.indexOf(':') === -1) {\n      return [urlLike];\n    }\n\n    const regExp = /(.+?)(?::(\\d+))?(?::(\\d+))?$/;\n    const parts = regExp.exec(urlLike.replace(/[()]/g, ''));\n    if (!parts) throw new Error(`Cannot parse given url: ${urlLike}`);\n    return [parts[1], parts[2] || undefined, parts[3] || undefined];\n  },\n  parseV8OrIE: function (error: { stack: string }) {\n    const filtered = error.stack.split('\\n').filter(function (line) {\n      return !!line.match(CHROME_IE_STACK_REGEXP);\n    }, this);\n\n    return filtered.map(function (line) {\n      if (line.indexOf('(eval ') > -1) {\n        // Throw away eval information until we implement stacktrace.js/stackframe#8\n        line = line\n          .replace(/eval code/g, 'eval')\n          .replace(/(\\(eval at [^()]*)|(\\),.*$)/g, '');\n      }\n      let sanitizedLine = line.replace(/^\\s+/, '').replace(/\\(eval code/g, '(');\n\n      // capture and preseve the parenthesized location \"(/foo/my bar.js:12:87)\" in\n      // case it has spaces in it, as the string is split on \\s+ later on\n      const location = sanitizedLine.match(/ (\\((.+):(\\d+):(\\d+)\\)$)/);\n\n      // remove the parenthesized location from the line, if it was matched\n      sanitizedLine = location\n        ? sanitizedLine.replace(location[0], '')\n        : sanitizedLine;\n\n      const tokens = sanitizedLine.split(/\\s+/).slice(1);\n      // if a location was matched, pass it to extractLocation() otherwise pop the last token\n      const locationParts = this.extractLocation(\n        location ? location[1] : tokens.pop(),\n      );\n      const functionName = tokens.join(' ') || undefined;\n      const fileName =\n        ['eval', '<anonymous>'].indexOf(locationParts[0]) > -1\n          ? undefined\n          : locationParts[0];\n\n      return new StackFrame({\n        functionName,\n        fileName,\n        lineNumber: locationParts[1],\n        columnNumber: locationParts[2],\n      });\n    }, this);\n  },\n  parseFFOrSafari: function (error: { stack: string }) {\n    const filtered = error.stack.split('\\n').filter(function (line) {\n      return !line.match(SAFARI_NATIVE_CODE_REGEXP);\n    }, this);\n\n    return filtered.map(function (line) {\n      // Throw away eval information until we implement stacktrace.js/stackframe#8\n      if (line.indexOf(' > eval') > -1) {\n        line = line.replace(\n          / line (\\d+)(?: > eval line \\d+)* > eval:\\d+:\\d+/g,\n          ':$1',\n        );\n      }\n\n      if (line.indexOf('@') === -1 && line.indexOf(':') === -1) {\n        // Safari eval frames only have function names and nothing else\n        return new StackFrame({\n          functionName: line,\n        });\n      } else {\n        const functionNameRegex = /((.*\".+\"[^@]*)?[^@]*)(?:@)/;\n        const matches = line.match(functionNameRegex);\n        const functionName = matches && matches[1] ? matches[1] : undefined;\n        const locationParts = this.extractLocation(\n          line.replace(functionNameRegex, ''),\n        );\n\n        return new StackFrame({\n          functionName,\n          fileName: locationParts[0],\n          lineNumber: locationParts[1],\n          columnNumber: locationParts[2],\n        });\n      }\n    }, this);\n  },\n  parseOpera: function (e: {\n    stacktrace?: string;\n    message: string;\n    stack?: string;\n  }): StackFrame[] {\n    if (\n      !e.stacktrace ||\n      (e.message.indexOf('\\n') > -1 &&\n        e.message.split('\\n').length > e.stacktrace.split('\\n').length)\n    ) {\n      return this.parseOpera9(e as { message: string });\n    } else if (!e.stack) {\n      return this.parseOpera10(e as { stacktrace: string });\n    } else {\n      return this.parseOpera11(e as { stack: string });\n    }\n  },\n  parseOpera9: function (e: { message: string }) {\n    const lineRE = /Line (\\d+).*script (?:in )?(\\S+)/i;\n    const lines = e.message.split('\\n');\n    const result = [];\n\n    for (let i = 2, len = lines.length; i < len; i += 2) {\n      const match = lineRE.exec(lines[i]);\n      if (match) {\n        result.push(\n          new StackFrame({\n            fileName: match[2],\n            lineNumber: parseFloat(match[1]),\n          }),\n        );\n      }\n    }\n\n    return result;\n  },\n  parseOpera10: function (e: { stacktrace: string }) {\n    const lineRE = /Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;\n    const lines = e.stacktrace.split('\\n');\n    const result = [];\n\n    for (let i = 0, len = lines.length; i < len; i += 2) {\n      const match = lineRE.exec(lines[i]);\n      if (match) {\n        result.push(\n          new StackFrame({\n            functionName: match[3] || undefined,\n            fileName: match[2],\n            lineNumber: parseFloat(match[1]),\n          }),\n        );\n      }\n    }\n\n    return result;\n  },\n  // Opera 10.65+ Error.stack very similar to FF/Safari\n  parseOpera11: function (error: { stack: string }) {\n    const filtered = error.stack.split('\\n').filter(function (line) {\n      return (\n        !!line.match(FIREFOX_SAFARI_STACK_REGEXP) &&\n        !line.match(/^Error created at/)\n      );\n    }, this);\n\n    return filtered.map(function (line: string) {\n      const tokens = line.split('@');\n      const locationParts = this.extractLocation(tokens.pop());\n      const functionCall = tokens.shift() || '';\n      const functionName =\n        functionCall\n          .replace(/<anonymous function(: (\\w+))?>/, '$2')\n          .replace(/\\([^)]*\\)/g, '') || undefined;\n      return new StackFrame({\n        functionName,\n        fileName: locationParts[0],\n        lineNumber: locationParts[1],\n        columnNumber: locationParts[2],\n      });\n    }, this);\n  },\n};\n","// @ts-nocheck\nimport { INode, MaskInputOptions, SlimDOMOptions } from '../snapshot';\nimport { FontFaceDescriptors, FontFaceSet } from 'css-font-loading-module';\nimport {\n  throttle,\n  on,\n  hookSetter,\n  getWindowHeight,\n  getWindowWidth,\n  isBlocked,\n  isTouchEvent,\n  patch,\n} from '../utils';\nimport {\n  mutationCallBack,\n  observerParam,\n  mousemoveCallBack,\n  mousePosition,\n  mouseInteractionCallBack,\n  MouseInteractions,\n  listenerHandler,\n  scrollCallback,\n  styleSheetRuleCallback,\n  viewportResizeCallback,\n  inputValue,\n  inputCallback,\n  hookResetter,\n  blockClass,\n  maskTextClass,\n  IncrementalSource,\n  hooksParam,\n  Arguments,\n  mediaInteractionCallback,\n  MediaInteractions,\n  SamplingStrategy,\n  canvasMutationCallback,\n  fontCallback,\n  fontParam,\n  MaskInputFn,\n  MaskTextFn,\n  logCallback,\n  LogRecordOptions,\n  Logger,\n  LogLevel,\n  Mirror,\n} from '../types';\nimport MutationBuffer from './mutation';\nimport { stringify } from './stringify';\nimport { IframeManager } from './iframe-manager';\nimport { ShadowDomManager } from './shadow-dom-manager';\nimport { StackFrame, ErrorStackParser } from './error-stack-parser';\n\ntype WindowWithStoredMutationObserver = Window & {\n  __rrMutationObserver?: MutationObserver;\n};\ntype WindowWithAngularZone = Window & {\n  Zone?: {\n    __symbol__?: (key: string) => string;\n  };\n};\n\nexport const mutationBuffers: MutationBuffer[] = [];\n\nexport function initMutationObserver(\n  cb: mutationCallBack,\n  doc: Document,\n  blockClass: blockClass,\n  blockSelector: string | null,\n  maskTextClass: maskTextClass,\n  maskTextSelector: string | null,\n  inlineStylesheet: boolean,\n  maskInputOptions: MaskInputOptions,\n  maskTextFn: MaskTextFn | undefined,\n  recordCanvas: boolean,\n  slimDOMOptions: SlimDOMOptions,\n  mirror: Mirror,\n  iframeManager: IframeManager,\n  shadowDomManager: ShadowDomManager,\n  rootEl: Node,\n): MutationObserver {\n  const mutationBuffer = new MutationBuffer();\n  mutationBuffers.push(mutationBuffer);\n  // see mutation.ts for details\n  mutationBuffer.init(\n    cb,\n    blockClass,\n    blockSelector,\n    maskTextClass,\n    maskTextSelector,\n    inlineStylesheet,\n    maskInputOptions,\n    maskTextFn,\n    recordCanvas,\n    slimDOMOptions,\n    doc,\n    mirror,\n    iframeManager,\n    shadowDomManager,\n  );\n  let mutationObserverCtor =\n    window.MutationObserver ||\n    /**\n     * Some websites may disable MutationObserver by removing it from the window object.\n     * If someone is using rrweb to build a browser extention or things like it, they\n     * could not change the website's code but can have an opportunity to inject some\n     * code before the website executing its JS logic.\n     * Then they can do this to store the native MutationObserver:\n     * window.__rrMutationObserver = MutationObserver\n     */\n    (window as WindowWithStoredMutationObserver).__rrMutationObserver;\n  const angularZoneSymbol = (window as WindowWithAngularZone)?.Zone?.__symbol__?.(\n    'MutationObserver',\n  );\n  if (\n    angularZoneSymbol &&\n    ((window as unknown) as Record<string, typeof MutationObserver>)[\n    angularZoneSymbol\n    ]\n  ) {\n    mutationObserverCtor = ((window as unknown) as Record<\n      string,\n      typeof MutationObserver\n    >)[angularZoneSymbol];\n  }\n  const observer = new mutationObserverCtor(\n    mutationBuffer.processMutations.bind(mutationBuffer),\n  );\n  observer.observe(rootEl, {\n    attributes: true,\n    attributeOldValue: true,\n    characterData: true,\n    characterDataOldValue: true,\n    childList: true,\n    subtree: true,\n  });\n  return observer;\n}\n\nfunction initMoveObserver(\n  cb: mousemoveCallBack,\n  sampling: SamplingStrategy,\n  doc: Document,\n  mirror: Mirror,\n): listenerHandler {\n  if (sampling.mousemove === false) {\n    return () => { };\n  }\n\n  const threshold =\n    typeof sampling.mousemove === 'number' ? sampling.mousemove : 50;\n  const callbackThreshold =\n    typeof sampling.mousemoveCallback === 'number'\n      ? sampling.mousemoveCallback\n      : 500;\n\n  let positions: mousePosition[] = [];\n  let timeBaseline: number | null;\n  const wrappedCb = throttle(\n    (\n      source:\n        | IncrementalSource.MouseMove\n        | IncrementalSource.TouchMove\n        | IncrementalSource.Drag,\n    ) => {\n      const totalOffset = Date.now() - timeBaseline!;\n      cb(\n        positions.map((p) => {\n          p.timeOffset -= totalOffset;\n          return p;\n        }),\n        source,\n      );\n      positions = [];\n      timeBaseline = null;\n    },\n    callbackThreshold,\n  );\n  const updatePosition = throttle<MouseEvent | TouchEvent | DragEvent>(\n    (evt) => {\n      const { target } = evt;\n      const { clientX, clientY } = isTouchEvent(evt)\n        ? evt.changedTouches[0]\n        : evt;\n      if (!timeBaseline) {\n        timeBaseline = Date.now();\n      }\n      positions.push({\n        x: clientX,\n        y: clientY,\n        id: mirror.getId(target as INode),\n        timeOffset: Date.now() - timeBaseline,\n      });\n      wrappedCb(\n        evt instanceof MouseEvent\n          ? IncrementalSource.MouseMove\n          : evt instanceof DragEvent\n            ? IncrementalSource.Drag\n            : IncrementalSource.TouchMove,\n      );\n    },\n    threshold,\n    {\n      trailing: false,\n    },\n  );\n  const handlers = [\n    on('mousemove', updatePosition, doc),\n    on('touchmove', updatePosition, doc),\n    on('drag', updatePosition, doc),\n  ];\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initMouseInteractionObserver(\n  cb: mouseInteractionCallBack,\n  doc: Document,\n  mirror: Mirror,\n  blockClass: blockClass,\n  sampling: SamplingStrategy,\n): listenerHandler {\n  if (sampling.mouseInteraction === false) {\n    return () => { };\n  }\n  const disableMap: Record<string, boolean | undefined> =\n    sampling.mouseInteraction === true ||\n      sampling.mouseInteraction === undefined\n      ? {}\n      : sampling.mouseInteraction;\n\n  const handlers: listenerHandler[] = [];\n  const getHandler = (eventKey: keyof typeof MouseInteractions) => {\n    return (event: MouseEvent | TouchEvent) => {\n      if (isBlocked(event.target as Node, blockClass)) {\n        return;\n      }\n      const e = isTouchEvent(event) ? event.changedTouches[0] : event;\n      if (!e) {\n        return;\n      }\n      const id = mirror.getId(event.target as INode);\n      const { clientX, clientY } = e;\n      cb({\n        type: MouseInteractions[eventKey],\n        id,\n        x: clientX,\n        y: clientY,\n      });\n    };\n  };\n  Object.keys(MouseInteractions)\n    .filter(\n      (key) =>\n        Number.isNaN(Number(key)) &&\n        !key.endsWith('_Departed') &&\n        disableMap[key] !== false,\n    )\n    .forEach((eventKey: keyof typeof MouseInteractions) => {\n      const eventName = eventKey.toLowerCase();\n      const handler = getHandler(eventKey);\n      handlers.push(on(eventName, handler, doc));\n    });\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initScrollObserver(\n  cb: scrollCallback,\n  doc: Document,\n  mirror: Mirror,\n  blockClass: blockClass,\n  sampling: SamplingStrategy,\n): listenerHandler {\n  const updatePosition = throttle<UIEvent>((evt) => {\n    if (!evt.target || isBlocked(evt.target as Node, blockClass)) {\n      return;\n    }\n    const id = mirror.getId(evt.target as INode);\n    if (evt.target === doc) {\n      const scrollEl = (doc.scrollingElement || doc.documentElement)!;\n      cb({\n        id,\n        x: scrollEl.scrollLeft,\n        y: scrollEl.scrollTop,\n      });\n    } else {\n      cb({\n        id,\n        x: (evt.target as HTMLElement).scrollLeft,\n        y: (evt.target as HTMLElement).scrollTop,\n      });\n    }\n  }, sampling.scroll || 100);\n  return on('scroll', updatePosition);\n}\n\nfunction initViewportResizeObserver(\n  cb: viewportResizeCallback,\n): listenerHandler {\n  let lastH = -1;\n  let lastW = -1;\n  const updateDimension = throttle(() => {\n    const height = getWindowHeight();\n    const width = getWindowWidth();\n    if (lastH !== height || lastW !== width) {\n      cb({\n        width: Number(width),\n        height: Number(height),\n      });\n      lastH = height;\n      lastW = width;\n    }\n  }, 200);\n  return on('resize', updateDimension, window);\n}\n\nexport const INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nconst lastInputValueMap: WeakMap<EventTarget, inputValue> = new WeakMap();\nfunction initInputObserver(\n  cb: inputCallback,\n  doc: Document,\n  mirror: Mirror,\n  blockClass: blockClass,\n  ignoreClass: string,\n  maskInputOptions: MaskInputOptions,\n  maskInputFn: MaskInputFn | undefined,\n  sampling: SamplingStrategy,\n): listenerHandler {\n  function eventHandler(event: Event) {\n    const { target } = event;\n    if (\n      !target ||\n      !(target as Element).tagName ||\n      INPUT_TAGS.indexOf((target as Element).tagName) < 0 ||\n      isBlocked(target as Node, blockClass)\n    ) {\n      return;\n    }\n    const type: string | undefined = (target as HTMLInputElement).type;\n    if (\n      type === 'password' ||\n      (target as HTMLElement).classList.contains(ignoreClass)\n    ) {\n      return;\n    }\n    let text = (target as HTMLInputElement).value;\n    let isChecked = false;\n    if (type === 'radio' || type === 'checkbox') {\n      isChecked = (target as HTMLInputElement).checked;\n    } else if (\n      maskInputOptions[\n      (target as Element).tagName.toLowerCase() as keyof MaskInputOptions\n      ] ||\n      maskInputOptions[type as keyof MaskInputOptions]\n    ) {\n      if (maskInputFn) {\n        text = maskInputFn(text);\n      } else {\n        text = '*'.repeat(text.length);\n      }\n    }\n    cbWithDedup(target, { text, isChecked });\n    // if a radio was checked\n    // the other radios with the same name attribute will be unchecked.\n    const name: string | undefined = (target as HTMLInputElement).name;\n    if (type === 'radio' && name && isChecked) {\n      doc\n        .querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`)\n        .forEach((el) => {\n          if (el !== target) {\n            cbWithDedup(el, {\n              text: (el as HTMLInputElement).value,\n              isChecked: !isChecked,\n            });\n          }\n        });\n    }\n  }\n  function cbWithDedup(target: EventTarget, v: inputValue) {\n    const lastInputValue = lastInputValueMap.get(target);\n    if (\n      !lastInputValue ||\n      lastInputValue.text !== v.text ||\n      lastInputValue.isChecked !== v.isChecked\n    ) {\n      lastInputValueMap.set(target, v);\n      const id = mirror.getId(target as INode);\n      cb({\n        ...v,\n        id,\n      });\n    }\n  }\n  const events = sampling.input === 'last' ? ['change'] : ['input', 'change'];\n  const handlers: Array<\n    listenerHandler | hookResetter\n  > = events.map((eventName) => on(eventName, eventHandler, doc));\n  const propertyDescriptor = Object.getOwnPropertyDescriptor(\n    HTMLInputElement.prototype,\n    'value',\n  );\n  const hookProperties: Array<[HTMLElement, string]> = [\n    [HTMLInputElement.prototype, 'value'],\n    [HTMLInputElement.prototype, 'checked'],\n    [HTMLSelectElement.prototype, 'value'],\n    [HTMLTextAreaElement.prototype, 'value'],\n    // Some UI library use selectedIndex to set select value\n    [HTMLSelectElement.prototype, 'selectedIndex'],\n  ];\n  if (propertyDescriptor && propertyDescriptor.set) {\n    handlers.push(\n      ...hookProperties.map((p) =>\n        hookSetter<HTMLElement>(p[0], p[1], {\n          set() {\n            // mock to a normal event\n            eventHandler({ target: this } as Event);\n          },\n        }),\n      ),\n    );\n  }\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initStyleSheetObserver(\n  cb: styleSheetRuleCallback,\n  mirror: Mirror,\n): listenerHandler {\n  const insertRule = CSSStyleSheet.prototype.insertRule;\n  CSSStyleSheet.prototype.insertRule = function (rule: string, index?: number) {\n    const id = mirror.getId(this.ownerNode as INode);\n    if (id !== -1) {\n      cb({\n        id,\n        adds: [{ rule, index }],\n      });\n    }\n    return insertRule.apply(this, arguments);\n  };\n\n  const deleteRule = CSSStyleSheet.prototype.deleteRule;\n  CSSStyleSheet.prototype.deleteRule = function (index: number) {\n    const id = mirror.getId(this.ownerNode as INode);\n    if (id !== -1) {\n      cb({\n        id,\n        removes: [{ index }],\n      });\n    }\n    return deleteRule.apply(this, arguments);\n  };\n\n  return () => {\n    CSSStyleSheet.prototype.insertRule = insertRule;\n    CSSStyleSheet.prototype.deleteRule = deleteRule;\n  };\n}\n\nfunction initMediaInteractionObserver(\n  mediaInteractionCb: mediaInteractionCallback,\n  blockClass: blockClass,\n  mirror: Mirror,\n): listenerHandler {\n  const handler = (type: 'play' | 'pause') => (event: Event) => {\n    const { target } = event;\n    if (!target || isBlocked(target as Node, blockClass)) {\n      return;\n    }\n    mediaInteractionCb({\n      type: type === 'play' ? MediaInteractions.Play : MediaInteractions.Pause,\n      id: mirror.getId(target as INode),\n    });\n  };\n  const handlers = [on('play', handler('play')), on('pause', handler('pause'))];\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initCanvasMutationObserver(\n  cb: canvasMutationCallback,\n  blockClass: blockClass,\n  mirror: Mirror,\n): listenerHandler {\n  const props = Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype);\n  const handlers: listenerHandler[] = [];\n  for (const prop of props) {\n    try {\n      if (\n        typeof CanvasRenderingContext2D.prototype[\n        prop as keyof CanvasRenderingContext2D\n        ] !== 'function'\n      ) {\n        continue;\n      }\n      const restoreHandler = patch(\n        CanvasRenderingContext2D.prototype,\n        prop,\n        function (original) {\n          return function (\n            this: CanvasRenderingContext2D,\n            ...args: Array<unknown>\n          ) {\n            if (!isBlocked(this.canvas, blockClass)) {\n              setTimeout(() => {\n                const recordArgs = [...args];\n                if (prop === 'drawImage') {\n                  if (\n                    recordArgs[0] &&\n                    recordArgs[0] instanceof HTMLCanvasElement\n                  ) {\n                    recordArgs[0] = recordArgs[0].toDataURL();\n                  }\n                }\n                cb({\n                  id: mirror.getId((this.canvas as unknown) as INode),\n                  property: prop,\n                  args: recordArgs,\n                });\n              }, 0);\n            }\n            return original.apply(this, args);\n          };\n        },\n      );\n      handlers.push(restoreHandler);\n    } catch {\n      const hookHandler = hookSetter<CanvasRenderingContext2D>(\n        CanvasRenderingContext2D.prototype,\n        prop,\n        {\n          set(v) {\n            cb({\n              id: mirror.getId((this.canvas as unknown) as INode),\n              property: prop,\n              args: [v],\n              setter: true,\n            });\n          },\n        },\n      );\n      handlers.push(hookHandler);\n    }\n  }\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initFontObserver(cb: fontCallback): listenerHandler {\n  const handlers: listenerHandler[] = [];\n\n  const fontMap = new WeakMap<FontFace, fontParam>();\n\n  const originalFontFace = FontFace;\n  // tslint:disable-next-line: no-any\n  (window as any).FontFace = function FontFace(\n    family: string,\n    source: string | ArrayBufferView,\n    descriptors?: FontFaceDescriptors,\n  ) {\n    const fontFace = new originalFontFace(family, source, descriptors);\n    fontMap.set(fontFace, {\n      family,\n      buffer: typeof source !== 'string',\n      descriptors,\n      fontSource:\n        typeof source === 'string'\n          ? source\n          : // tslint:disable-next-line: no-any\n          JSON.stringify(Array.from(new Uint8Array(source as any))),\n    });\n    return fontFace;\n  };\n\n  const restoreHandler = patch(document.fonts, 'add', function (original) {\n    return function (this: FontFaceSet, fontFace: FontFace) {\n      setTimeout(() => {\n        const p = fontMap.get(fontFace);\n        if (p) {\n          cb(p);\n          fontMap.delete(fontFace);\n        }\n      }, 0);\n      return original.apply(this, [fontFace]);\n    };\n  });\n\n  handlers.push(() => {\n    // tslint:disable-next-line: no-any\n    (window as any).FonFace = originalFontFace;\n  });\n  handlers.push(restoreHandler);\n\n  return () => {\n    handlers.forEach((h) => h());\n  };\n}\n\nfunction initLogObserver(\n  cb: logCallback,\n  logOptions: LogRecordOptions,\n): listenerHandler {\n  const logger = logOptions.logger;\n  if (!logger) {\n    return () => { };\n  }\n  let logCount = 0;\n  const cancelHandlers: listenerHandler[] = [];\n  // add listener to thrown errors\n  if (logOptions.level!.includes('error')) {\n    if (window) {\n      const originalOnError = window.onerror;\n      window.onerror = (\n        msg: Event | string,\n        file: string,\n        line: number,\n        col: number,\n        error: Error,\n      ) => {\n        if (originalOnError) {\n          originalOnError.apply(this, [msg, file, line, col, error]);\n        }\n        const trace: string[] = ErrorStackParser.parse(\n          error,\n        ).map((stackFrame: StackFrame) => stackFrame.toString());\n        const payload = [stringify(msg, logOptions.stringifyOptions)];\n        cb({\n          level: 'error',\n          trace,\n          payload,\n        });\n      };\n      cancelHandlers.push(() => {\n        window.onerror = originalOnError;\n      });\n    }\n  }\n  for (const levelType of logOptions.level!) {\n    cancelHandlers.push(replace(logger, levelType));\n  }\n  return () => {\n    cancelHandlers.forEach((h) => h());\n  };\n\n  /**\n   * replace the original console function and record logs\n   * @param logger the logger object such as Console\n   * @param level the name of log function to be replaced\n   */\n  function replace(_logger: Logger, level: LogLevel) {\n    if (!_logger[level]) {\n      return () => { };\n    }\n    // replace the logger.{level}. return a restore function\n    return patch(_logger, level, (original) => {\n      return (...args: unknown[]) => {\n        original.apply(this, args);\n        try {\n          const trace = ErrorStackParser.parse(new Error())\n            .map((stackFrame: StackFrame) => stackFrame.toString())\n            .splice(1); // splice(1) to omit the hijacked log function\n          const payload = args.map((s) =>\n            stringify(s, logOptions.stringifyOptions),\n          );\n          logCount++;\n          if (logCount < logOptions.lengthThreshold!) {\n            cb({\n              level,\n              trace,\n              payload,\n            });\n          } else if (logCount === logOptions.lengthThreshold) {\n            // notify the user\n            cb({\n              level: 'warn',\n              trace: [],\n              payload: [\n                stringify('The number of log records reached the threshold.'),\n              ],\n            });\n          }\n        } catch (error) {\n          original('rrweb logger error:', error, ...args);\n        }\n      };\n    });\n  }\n}\n\nfunction mergeHooks(o: observerParam, hooks: hooksParam) {\n  const {\n    mutationCb,\n    mousemoveCb,\n    mouseInteractionCb,\n    scrollCb,\n    viewportResizeCb,\n    inputCb,\n    mediaInteractionCb,\n    styleSheetRuleCb,\n    canvasMutationCb,\n    fontCb,\n    logCb,\n  } = o;\n  o.mutationCb = (...p: Arguments<mutationCallBack>) => {\n    if (hooks.mutation) {\n      hooks.mutation(...p);\n    }\n    mutationCb(...p);\n  };\n  o.mousemoveCb = (...p: Arguments<mousemoveCallBack>) => {\n    if (hooks.mousemove) {\n      hooks.mousemove(...p);\n    }\n    mousemoveCb(...p);\n  };\n  o.mouseInteractionCb = (...p: Arguments<mouseInteractionCallBack>) => {\n    if (hooks.mouseInteraction) {\n      hooks.mouseInteraction(...p);\n    }\n    mouseInteractionCb(...p);\n  };\n  o.scrollCb = (...p: Arguments<scrollCallback>) => {\n    if (hooks.scroll) {\n      hooks.scroll(...p);\n    }\n    scrollCb(...p);\n  };\n  o.viewportResizeCb = (...p: Arguments<viewportResizeCallback>) => {\n    if (hooks.viewportResize) {\n      hooks.viewportResize(...p);\n    }\n    viewportResizeCb(...p);\n  };\n  o.inputCb = (...p: Arguments<inputCallback>) => {\n    if (hooks.input) {\n      hooks.input(...p);\n    }\n    inputCb(...p);\n  };\n  o.mediaInteractionCb = (...p: Arguments<mediaInteractionCallback>) => {\n    if (hooks.mediaInteaction) {\n      hooks.mediaInteaction(...p);\n    }\n    mediaInteractionCb(...p);\n  };\n  o.styleSheetRuleCb = (...p: Arguments<styleSheetRuleCallback>) => {\n    if (hooks.styleSheetRule) {\n      hooks.styleSheetRule(...p);\n    }\n    styleSheetRuleCb(...p);\n  };\n  o.canvasMutationCb = (...p: Arguments<canvasMutationCallback>) => {\n    if (hooks.canvasMutation) {\n      hooks.canvasMutation(...p);\n    }\n    canvasMutationCb(...p);\n  };\n  o.fontCb = (...p: Arguments<fontCallback>) => {\n    if (hooks.font) {\n      hooks.font(...p);\n    }\n    fontCb(...p);\n  };\n  o.logCb = (...p: Arguments<logCallback>) => {\n    if (hooks.log) {\n      hooks.log(...p);\n    }\n    logCb(...p);\n  };\n}\n\nexport function initObservers(\n  o: observerParam,\n  hooks: hooksParam = {},\n): listenerHandler {\n  mergeHooks(o, hooks);\n  const mutationObserver = initMutationObserver(\n    o.mutationCb,\n    o.doc,\n    o.blockClass,\n    o.blockSelector,\n    o.maskTextClass,\n    o.maskTextSelector,\n    o.inlineStylesheet,\n    o.maskInputOptions,\n    o.maskTextFn,\n    o.recordCanvas,\n    o.slimDOMOptions,\n    o.mirror,\n    o.iframeManager,\n    o.shadowDomManager,\n    o.doc,\n  );\n  const mousemoveHandler = initMoveObserver(\n    o.mousemoveCb,\n    o.sampling,\n    o.doc,\n    o.mirror,\n  );\n  const mouseInteractionHandler = initMouseInteractionObserver(\n    o.mouseInteractionCb,\n    o.doc,\n    o.mirror,\n    o.blockClass,\n    o.sampling,\n  );\n  const scrollHandler = initScrollObserver(\n    o.scrollCb,\n    o.doc,\n    o.mirror,\n    o.blockClass,\n    o.sampling,\n  );\n  const viewportResizeHandler = initViewportResizeObserver(o.viewportResizeCb);\n  const inputHandler = initInputObserver(\n    o.inputCb,\n    o.doc,\n    o.mirror,\n    o.blockClass,\n    o.ignoreClass,\n    o.maskInputOptions,\n    o.maskInputFn,\n    o.sampling,\n  );\n  const mediaInteractionHandler = initMediaInteractionObserver(\n    o.mediaInteractionCb,\n    o.blockClass,\n    o.mirror,\n  );\n  const styleSheetObserver = initStyleSheetObserver(\n    o.styleSheetRuleCb,\n    o.mirror,\n  );\n  const canvasMutationObserver = o.recordCanvas\n    ? initCanvasMutationObserver(o.canvasMutationCb, o.blockClass, o.mirror)\n    : () => { };\n  const fontObserver = o.collectFonts ? initFontObserver(o.fontCb) : () => { };\n  const logObserver = o.logOptions\n    ? initLogObserver(o.logCb, o.logOptions)\n    : () => { };\n\n  return () => {\n    mutationObserver.disconnect();\n    mousemoveHandler();\n    mouseInteractionHandler();\n    scrollHandler();\n    viewportResizeHandler();\n    inputHandler();\n    mediaInteractionHandler();\n    styleSheetObserver();\n    canvasMutationObserver();\n    fontObserver();\n    logObserver();\n  };\n}\n","import { serializedNodeWithId, INode } from '../snapshot';\nimport { mutationCallBack } from '../types';\n\nexport class IframeManager {\n  private iframes: WeakMap<HTMLIFrameElement, true> = new WeakMap();\n  private mutationCb: mutationCallBack;\n  private loadListener?: (iframeEl: HTMLIFrameElement) => unknown;\n\n  constructor(options: { mutationCb: mutationCallBack }) {\n    this.mutationCb = options.mutationCb;\n  }\n\n  public addIframe(iframeEl: HTMLIFrameElement) {\n    this.iframes.set(iframeEl, true);\n  }\n\n  public addLoadListener(cb: (iframeEl: HTMLIFrameElement) => unknown) {\n    this.loadListener = cb;\n  }\n\n  public attachIframe(iframeEl: INode, childSn: serializedNodeWithId) {\n    this.mutationCb({\n      adds: [\n        {\n          parentId: iframeEl.__sn.id,\n          nextId: null,\n          node: childSn,\n        },\n      ],\n      removes: [],\n      texts: [],\n      attributes: [],\n      isAttachIframe: true,\n    });\n    this.loadListener?.((iframeEl as unknown) as HTMLIFrameElement);\n  }\n}\n","import {\n  mutationCallBack,\n  blockClass,\n  maskTextClass,\n  MaskTextFn,\n  Mirror,\n} from '../types';\nimport { MaskInputOptions, SlimDOMOptions } from '../snapshot';\nimport { IframeManager } from './iframe-manager';\nimport { initMutationObserver } from './observer';\n\ntype BypassOptions = {\n  blockClass: blockClass;\n  blockSelector: string | null;\n  maskTextClass: maskTextClass;\n  maskTextSelector: string | null;\n  inlineStylesheet: boolean;\n  maskInputOptions: MaskInputOptions;\n  maskTextFn: MaskTextFn | undefined;\n  recordCanvas: boolean;\n  slimDOMOptions: SlimDOMOptions;\n  iframeManager: IframeManager;\n};\n\nexport class ShadowDomManager {\n  private mutationCb: mutationCallBack;\n  private bypassOptions: BypassOptions;\n  private mirror: Mirror;\n\n  constructor(options: {\n    mutationCb: mutationCallBack;\n    bypassOptions: BypassOptions;\n    mirror: Mirror;\n  }) {\n    this.mutationCb = options.mutationCb;\n    this.bypassOptions = options.bypassOptions;\n    this.mirror = options.mirror;\n  }\n\n  public addShadowRoot(shadowRoot: ShadowRoot, doc: Document) {\n    initMutationObserver(\n      this.mutationCb,\n      doc,\n      this.bypassOptions.blockClass,\n      this.bypassOptions.blockSelector,\n      this.bypassOptions.maskTextClass,\n      this.bypassOptions.maskTextSelector,\n      this.bypassOptions.inlineStylesheet,\n      this.bypassOptions.maskInputOptions,\n      this.bypassOptions.maskTextFn,\n      this.bypassOptions.recordCanvas,\n      this.bypassOptions.slimDOMOptions,\n      this.mirror,\n      this.bypassOptions.iframeManager,\n      this,\n      shadowRoot,\n    );\n  }\n}\n","import { snapshot, MaskInputOptions, SlimDOMOptions } from '../snapshot';\nimport { initObservers, mutationBuffers } from './observer';\nimport {\n  on,\n  getWindowWidth,\n  getWindowHeight,\n  polyfill,\n  isIframeINode,\n  hasShadowRoot,\n  createMirror,\n} from '../utils';\nimport {\n  EventType,\n  event,\n  eventWithTime,\n  recordOptions,\n  IncrementalSource,\n  listenerHandler,\n  LogRecordOptions,\n  mutationCallbackParam,\n} from '../types';\nimport { IframeManager } from './iframe-manager';\nimport { ShadowDomManager } from './shadow-dom-manager';\n\nfunction wrapEvent(e: event): eventWithTime {\n  return {\n    ...e,\n    timestamp: Date.now(),\n  };\n}\n\nlet wrappedEmit!: (e: eventWithTime, isCheckout?: boolean) => void;\n\nlet takeFullSnapshot!: (isCheckout?: boolean) => void;\n\nconst mirror = createMirror();\nfunction record<T = eventWithTime>(\n  options: recordOptions<T> = {},\n): listenerHandler | undefined {\n  const {\n    emit,\n    checkoutEveryNms,\n    checkoutEveryNth,\n    blockClass = 'rr-block',\n    blockSelector = null,\n    ignoreClass = 'rr-ignore',\n    maskTextClass = 'rr-mask',\n    maskTextSelector = null,\n    inlineStylesheet = true,\n    maskAllInputs,\n    maskInputOptions: _maskInputOptions,\n    slimDOMOptions: _slimDOMOptions,\n    maskInputFn,\n    maskTextFn,\n    hooks,\n    packFn,\n    sampling = {},\n    mousemoveWait,\n    recordCanvas = false,\n    collectFonts = false,\n    recordLog = false,\n  } = options;\n  // runtime checks for user options\n  if (!emit) {\n    throw new Error('emit function is required');\n  }\n  // move departed options to new options\n  if (mousemoveWait !== undefined && sampling.mousemove === undefined) {\n    sampling.mousemove = mousemoveWait;\n  }\n\n  const maskInputOptions: MaskInputOptions =\n    maskAllInputs === true\n      ? {\n          color: true,\n          date: true,\n          'datetime-local': true,\n          email: true,\n          month: true,\n          number: true,\n          range: true,\n          search: true,\n          tel: true,\n          text: true,\n          time: true,\n          url: true,\n          week: true,\n          textarea: true,\n          select: true,\n        }\n      : _maskInputOptions !== undefined\n      ? _maskInputOptions\n      : {};\n\n  const slimDOMOptions: SlimDOMOptions =\n    _slimDOMOptions === true || _slimDOMOptions === 'all'\n      ? {\n          script: true,\n          comment: true,\n          headFavicon: true,\n          headWhitespace: true,\n          headMetaSocial: true,\n          headMetaRobots: true,\n          headMetaHttpEquiv: true,\n          headMetaVerification: true,\n          // the following are off for slimDOMOptions === true,\n          // as they destroy some (hidden) info:\n          headMetaAuthorship: _slimDOMOptions === 'all',\n          headMetaDescKeywords: _slimDOMOptions === 'all',\n        }\n      : _slimDOMOptions\n      ? _slimDOMOptions\n      : {};\n  const defaultLogOptions: LogRecordOptions = {\n    level: [\n      'assert',\n      'clear',\n      'count',\n      'countReset',\n      'debug',\n      'dir',\n      'dirxml',\n      // 'error',\n      'group',\n      'groupCollapsed',\n      'groupEnd',\n      'info',\n      'log',\n      'table',\n      'time',\n      'timeEnd',\n      'timeLog',\n      'trace',\n      'warn',\n    ],\n    lengthThreshold: 1000,\n    logger: console,\n  };\n\n  const logOptions: LogRecordOptions = recordLog\n    ? recordLog === true\n      ? defaultLogOptions\n      : Object.assign({}, defaultLogOptions, recordLog)\n    : {};\n\n  polyfill();\n\n  let lastFullSnapshotEvent: eventWithTime;\n  let incrementalSnapshotCount = 0;\n  wrappedEmit = (e: eventWithTime, isCheckout?: boolean) => {\n    if (\n      mutationBuffers[0]?.isFrozen() &&\n      e.type !== EventType.FullSnapshot &&\n      !(\n        e.type === EventType.IncrementalSnapshot &&\n        e.data.source === IncrementalSource.Mutation\n      )\n    ) {\n      // we've got a user initiated event so first we need to apply\n      // all DOM changes that have been buffering during paused state\n      mutationBuffers.forEach((buf) => buf.unfreeze());\n    }\n\n    emit(((packFn ? packFn(e) : e) as unknown) as T, isCheckout);\n    if (e.type === EventType.FullSnapshot) {\n      lastFullSnapshotEvent = e;\n      incrementalSnapshotCount = 0;\n    } else if (e.type === EventType.IncrementalSnapshot) {\n      // attch iframe should be considered as full snapshot\n      if (\n        e.data.source === IncrementalSource.Mutation &&\n        e.data.isAttachIframe\n      ) {\n        return;\n      }\n\n      incrementalSnapshotCount++;\n      const exceedCount =\n        checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\n      const exceedTime =\n        checkoutEveryNms &&\n        e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\n      if (exceedCount || exceedTime) {\n        takeFullSnapshot(true);\n      }\n    }\n  };\n\n  const wrappedMutationEmit = (m: mutationCallbackParam) => {\n    wrappedEmit(\n      wrapEvent({\n        type: EventType.IncrementalSnapshot,\n        data: {\n          source: IncrementalSource.Mutation,\n          ...m,\n        },\n      }),\n    );\n  };\n\n  const iframeManager = new IframeManager({\n    mutationCb: wrappedMutationEmit,\n  });\n\n  const shadowDomManager = new ShadowDomManager({\n    mutationCb: wrappedMutationEmit,\n    bypassOptions: {\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      inlineStylesheet,\n      maskInputOptions,\n      maskTextFn,\n      recordCanvas,\n      slimDOMOptions,\n      iframeManager,\n    },\n    mirror,\n  });\n\n  takeFullSnapshot = (isCheckout = false) => {\n    wrappedEmit(\n      wrapEvent({\n        type: EventType.Meta,\n        data: {\n          href: window.location.href,\n          width: getWindowWidth(),\n          height: getWindowHeight(),\n        },\n      }),\n      isCheckout,\n    );\n\n    mutationBuffers.forEach((buf) => buf.lock()); // don't allow any mirror modifications during snapshotting\n    const [node, idNodeMap] = snapshot(document, {\n      blockClass,\n      blockSelector,\n      maskTextClass,\n      maskTextSelector,\n      inlineStylesheet,\n      maskAllInputs: maskInputOptions,\n      maskTextFn,\n      slimDOM: slimDOMOptions,\n      recordCanvas,\n      onSerialize: (n) => {\n        if (isIframeINode(n)) {\n          iframeManager.addIframe(n);\n        }\n        if (hasShadowRoot(n)) {\n          shadowDomManager.addShadowRoot(n.shadowRoot, document);\n        }\n      },\n      onIframeLoad: (iframe, childSn) => {\n        iframeManager.attachIframe(iframe, childSn);\n      },\n    });\n\n    if (!node) {\n      return console.warn('Failed to snapshot the document');\n    }\n\n    mirror.map = idNodeMap;\n    wrappedEmit(\n      wrapEvent({\n        type: EventType.FullSnapshot,\n        data: {\n          node,\n          initialOffset: {\n            left:\n              window.pageXOffset !== undefined\n                ? window.pageXOffset\n                : document?.documentElement.scrollLeft ||\n                  document?.body?.parentElement?.scrollLeft ||\n                  document?.body.scrollLeft ||\n                  0,\n            top:\n              window.pageYOffset !== undefined\n                ? window.pageYOffset\n                : document?.documentElement.scrollTop ||\n                  document?.body?.parentElement?.scrollTop ||\n                  document?.body.scrollTop ||\n                  0,\n          },\n        },\n      }),\n    );\n    mutationBuffers.forEach((buf) => buf.unlock()); // generate & emit any mutations that happened during snapshotting, as can now apply against the newly built mirror\n  };\n\n  try {\n    const handlers: listenerHandler[] = [];\n    handlers.push(\n      on('DOMContentLoaded', () => {\n        wrappedEmit(\n          wrapEvent({\n            type: EventType.DomContentLoaded,\n            data: {},\n          }),\n        );\n      }),\n    );\n\n    const observe = (doc: Document) => {\n      return initObservers(\n        {\n          mutationCb: wrappedMutationEmit,\n          mousemoveCb: (positions, source) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source,\n                  positions,\n                },\n              }),\n            ),\n          mouseInteractionCb: (d) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.MouseInteraction,\n                  ...d,\n                },\n              }),\n            ),\n          scrollCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Scroll,\n                  ...p,\n                },\n              }),\n            ),\n          viewportResizeCb: (d) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.ViewportResize,\n                  ...d,\n                },\n              }),\n            ),\n          inputCb: (v) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Input,\n                  ...v,\n                },\n              }),\n            ),\n          mediaInteractionCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.MediaInteraction,\n                  ...p,\n                },\n              }),\n            ),\n          styleSheetRuleCb: (r) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.StyleSheetRule,\n                  ...r,\n                },\n              }),\n            ),\n          canvasMutationCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.CanvasMutation,\n                  ...p,\n                },\n              }),\n            ),\n          fontCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Font,\n                  ...p,\n                },\n              }),\n            ),\n          logCb: (p) =>\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.IncrementalSnapshot,\n                data: {\n                  source: IncrementalSource.Log,\n                  ...p,\n                },\n              }),\n            ),\n          blockClass,\n          ignoreClass,\n          maskTextClass,\n          maskTextSelector,\n          maskInputOptions,\n          inlineStylesheet,\n          sampling,\n          recordCanvas,\n          collectFonts,\n          doc,\n          maskInputFn,\n          maskTextFn,\n          logOptions,\n          blockSelector,\n          slimDOMOptions,\n          mirror,\n          iframeManager,\n          shadowDomManager,\n        },\n        hooks,\n      );\n    };\n\n    iframeManager.addLoadListener((iframeEl) => {\n      handlers.push(observe(iframeEl.contentDocument!));\n    });\n\n    const init = () => {\n      takeFullSnapshot();\n      handlers.push(observe(document));\n    };\n    if (\n      document.readyState === 'interactive' ||\n      document.readyState === 'complete'\n    ) {\n      init();\n    } else {\n      handlers.push(\n        on(\n          'load',\n          () => {\n            wrappedEmit(\n              wrapEvent({\n                type: EventType.Load,\n                data: {},\n              }),\n            );\n            init();\n          },\n          window,\n        ),\n      );\n    }\n    return () => {\n      handlers.forEach((h) => h());\n    };\n  } catch (error) {\n    // TODO: handle internal error\n    console.warn(error);\n  }\n}\n\nrecord.addCustomEvent = <T>(tag: string, payload: T) => {\n  if (!wrappedEmit) {\n    throw new Error('please add custom event after start recording');\n  }\n  wrappedEmit(\n    wrapEvent({\n      type: EventType.Custom,\n      data: {\n        tag,\n        payload,\n      },\n    }),\n  );\n};\n\nrecord.freezePage = () => {\n  mutationBuffers.forEach((buf) => buf.freeze());\n};\n\nrecord.takeFullSnapshot = (isCheckout?: boolean) => {\n  if (!takeFullSnapshot) {\n    throw new Error('please take full snapshot after start recording');\n  }\n  takeFullSnapshot(isCheckout);\n};\n\nrecord.mirror = mirror;\n\nexport default record;\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && st.f && !st.l))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if (d[1] & 32)\n        err(6, 'invalid zlib data: preset dictionaries not supported');\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                err(6, 'invalid gzip data');\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            err(8);\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this_1.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this_1.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this_1.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this_1.ondata(err, dat, final);\n                    _this_1.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_3 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295;\n        if (z) {\n            e = b4(data, e - 12);\n            if (b4(data, e) != 0x6064B50) {\n                cbd(err(13, 0, 1), null);\n                return tAll;\n            }\n            c = lft = b4(data, e + 32);\n            o = b4(data, e + 48);\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    if (sc < 320000) {\n                        try {\n                            cbl(null, inflateSync(infl, new u8(su)));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            err(13);\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","import { eventWithTime } from '../types';\n\nexport type PackFn = (event: eventWithTime) => string;\nexport type UnpackFn = (raw: string) => eventWithTime;\n\nexport type eventWithTimeAndPacker = eventWithTime & {\n  v: string;\n};\n\nexport const MARK = 'v1';\n","// @ts-nocheck\n\nimport { strFromU8, strToU8, zlibSync } from 'fflate';\nimport { PackFn, MARK, eventWithTimeAndPacker } from './base';\n\nexport const pack: PackFn = (event) => {\n  const _e: eventWithTimeAndPacker = {\n    ...event,\n    v: MARK,\n  };\n  return strFromU8(zlibSync(strToU8(JSON.stringify(_e))), true);\n};\n","import { strFromU8, strToU8, unzlibSync } from 'fflate';\nimport { UnpackFn, eventWithTimeAndPacker, MARK } from './base';\nimport { eventWithTime } from '../types';\n\nexport const unpack: UnpackFn = (raw: string) => {\n  if (typeof raw !== 'string') {\n    return raw;\n  }\n  try {\n    const e: eventWithTime = JSON.parse(raw);\n    if (e.timestamp) {\n      return e;\n    }\n  } catch (error) {\n    // ignore and continue\n  }\n  try {\n    const e: eventWithTimeAndPacker = JSON.parse(\n      strFromU8(unzlibSync(strToU8(raw, true)))\n    );\n    if (e.v === MARK) {\n      return e;\n    }\n    throw new Error(\n      `These events were packed with packer ${e.v} which is incompatible with current packer ${MARK}.`,\n    );\n  } catch (error) {\n    console.error(error);\n    throw new Error('Unknown data format.');\n  }\n};\n","export { pack } from './pack';\nexport { unpack } from './unpack';\n","import { AskLevel } from \"../types/types\"\nimport { config } from \"../config/config\"\nimport { W } from \"../constants\"\nimport record from \"../rrweb/record\"\nimport { pack } from \"../rrweb/packer\"\nimport { eventWithTime } from \"../rrweb/types\"\nimport { warn } from \"../utils/console\"\n\n/**\n * Error Trap\n */\n\nexport default class ErrorTrace {\n  private static instance: ErrorTrace | null = null\n  private eventsMatrix: Array<Array<eventWithTime>> = [[]]\n\n  private constructor() {\n    this.globalErrorTrace()\n    this.networkErrorTrace()\n    this.promiseErrorTrace()\n    this.iframeErrorTrace()\n    record({\n      ...config.recordOptions,\n      emit: (event, isCheckout) => {\n        if (isCheckout) {\n          this.eventsMatrix.push([]);\n        }\n        const lastEvents = this.eventsMatrix[this.eventsMatrix.length - 1];\n        lastEvents.push(event);\n      },\n      recordLog: false,\n      checkoutEveryNth: 10,\n      packFn: pack,\n    })\n  }\n\n  public static getInstance(): ErrorTrace {\n    if (!this.instance) {\n      this.instance = new ErrorTrace()\n    }\n    return this.instance\n  }\n\n  /**\n   * Globally catch synchronous or asynchronous errors\n   * 捕获异常的能力比try-catch稍微强点，无论是异步还是非异步，onerror都能捕获到运行时错误，返回true就不回报红\n   * 当时当<img src=\"\" />这种情况是捕获不到的\n   * 使用未使用的变量\n   */\n  private globalErrorTrace(): void {\n    W.onerror = (\n      event: Event | string,\n      source?: string,\n      lineno?: number,\n      colno?: number,\n      error?: Error\n    ) => {\n\n      warn({\n        source,\n        lineno,\n        colno,\n        error,\n      })\n\n      const len = this.eventsMatrix.length;\n\n      if (config.errEventRoute && len >= 2) {\n        const events = this.eventsMatrix[len - 2].concat(this.eventsMatrix[len - 1]);\n        config.reportData?.fetch(\n          AskLevel.IDLE,\n          JSON.stringify({ events }),\n          config.errEventRoute\n        )\n      }\n\n      if (config.errLogRoute) {\n        config.reportData?.fetch(\n          AskLevel.IDLE,\n          JSON.stringify({\n            source,\n            lineno,\n            colno,\n            error: JSON.stringify({\n              message: error?.message,\n              stack: error?.stack,\n              name: error?.name,\n            }),\n          }),\n          config.errLogRoute\n        )\n      }\n      return true\n    }\n  }\n  /**\n   * Catch network errors\n   * 图片加载失败等\n   */\n  private networkErrorTrace(): void {\n    W.addEventListener(\n      \"error\",\n      (e: ErrorEvent) => {\n        if (e.target !== W) {\n          warn(e.target)\n        }\n      },\n      true\n    )\n  }\n\n  /**\n   * Catching Promise errors\n   */\n  private promiseErrorTrace(): void {\n    window.addEventListener(\"unhandledrejection\", (e) => {\n      e.preventDefault()\n      warn(e.reason)\n      return true\n    })\n  }\n\n  private iframeErrorTrace(): void {\n    const frames = W.frames\n    for (let i = 0; i < frames.length; i++) {\n      frames[i].addEventListener(\n        \"error\",\n        (e: ErrorEvent) => {\n          warn(e)\n        },\n        true\n      )\n      frames[i].addEventListener(\n        \"unhandledrejection\",\n        (e) => {\n          warn(e)\n        },\n        true\n      )\n    }\n  }\n}\n","import { AskLevel, ReportDataAchieve } from \"../types/types\"\nimport { W, WN } from \"../constants\"\nimport { config } from \"../config/config\"\n\nexport interface ReportDataOptions {\n  logDomain: string | undefined,\n}\n\n/**\n * Log collection\n * 日志收集\n */\nexport default class ReportData implements ReportDataAchieve {\n  /**\n   * Log report, error report\n   * If the level is urgent, use http request directly, otherwise use navigator.sendBeacon\n   * 日志上报、错误上报\n   * 如果level很紧急，直接使用http请求，否者使用navigator.sendBeacon\n   * @param level\n   * @param body \n   * @param uri \n   */\n  public fetch(level: AskLevel, body: string, uri: string): void {\n    uri = config.fetchDomain + uri\n\n    switch (level) {\n      case AskLevel.URGENT: {\n        if (!!W.fetch) {\n          fetch(uri, { body, method: \"POST\", keepalive: true })\n        } else {\n          let xhr: XMLHttpRequest | null = new XMLHttpRequest()\n          xhr.open(\"post\", uri, true)\n          xhr.setRequestHeader(\"Content-Type\", \"application/json\")\n          xhr.send(body)\n          xhr.onload = () => xhr = null // 防止内存泄漏\n        }\n        return\n      }\n      default:\n        if (!!WN.sendBeacon) {\n          navigator.sendBeacon(uri, body)\n        } else {\n          let image: HTMLImageElement | null = new Image()\n          image.src = `${uri}?body=${body}`\n          image.onload = () => image = null // 防止内存泄漏\n        }\n    }\n  }\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = require(\"regenerator-runtime\");\n","import { W, WP } from \"../constants\"\n\n/**\n * Determine whether the browser supports getEntriesByType\n * @returns \n */\nexport const isPerformanceSupported = (): boolean => {\n  return WP && !!WP.getEntriesByType && !!WP.now && !!WP.mark\n}\n\n/**\n * bytes to kb\n * @param {number} bytes\n */\nexport const bytes2kb = (bytes: number) => {\n  return parseFloat((bytes / Math.pow(1024, 2)).toFixed(2))\n}\n\n/**\n * Keep two decimal places\n * @param {number} num\n * @returns \n */\nexport const roundByTwo = (num: number) => {\n  return parseFloat(num.toFixed(2))\n}\n\n/**\n * PushTask to requestIdleCallback\n * Efficient use of each frame for data collection\n * @param {() => void} callback\n */\nexport const pushTask = (callback: () => void) => {\n  if (\"requestIdleCallback\" in W) {\n    (W as any).requestIdleCallback(callback, { timeout: 3000 })\n  } else {\n    callback()\n  }\n}","import { bytes2kb } from \"../utils/helper\"\nimport { WN } from \"../constants\"\nimport type { StorageOpt } from \"../types/types\"\n\n/**\n  * Record local cache information\n*/\n\nexport const recordingStorage = async (): Promise<StorageOpt> => {\n  if (!WN.storage) return { usageDetails: {} }\n\n  const { quota, usage, usageDetails } = await WN.storage.estimate() as StorageOpt\n  let res = {\n    quota: bytes2kb(quota || 0),\n    usage: bytes2kb(usage || 0),\n    usageDetails,\n  }\n  if (res.usageDetails) {\n    Object.keys(res.usageDetails || {}).forEach(key => res.usageDetails[key] = bytes2kb(res.usageDetails[key]))\n  }\n  return res\n}","module.exports = {\n  \"name\": \"mini-pm\",\n  \"version\": \"1.0.8\",\n  \"description\": \"一款mini性能优化监控平台\",\n  \"source\": \"src/index.ts\",\n  \"main\": \"dist/mini-pm.js\",\n  \"exports\": \"./dist/mini-pm.modern.js\",\n  \"module\": \"dist/mini-pm.module.js\",\n  \"types\": \"dist/typings/index.d.ts\",\n  \"unpkg\": \"dist/mini-pm.umd.js\",\n  \"files\": [\n    \"dist\"\n  ],\n  \"scripts\": {\n    \"build\": \"node ./scripts/build.js\",\n    \"dev\": \"microbundle watch\",\n    \"example\": \"parcel serve ./examples/index.html -p 12345\",\n    \"api:init\": \"api-extractor init\",\n    \"api:run\": \"api-extractor run --local --verbose\",\n    \"api:doc\": \"typedoc --out docs src\",\n    \"publish\": \"node ./scripts/publish.js\",\n    \"test\": \"node ./scripts/sonar.js\",\n    \"precommit\": \"node ./scripts/precommit.js\"\n  },\n  \"devDependencies\": {\n    \"@babel/core\": \"^7.14.0\",\n    \"@babel/plugin-transform-runtime\": \"^7.13.15\",\n    \"@microsoft/api-extractor\": \"^7.15.2\",\n    \"@types/css-font-loading-module\": \"^0.0.4\",\n    \"chalk\": \"^4.1.1\",\n    \"git-webhook-handler\": \"^1.0.6\",\n    \"husky\": \"^6.0.0\",\n    \"microbundle\": \"^0.13.0\",\n    \"mvdir\": \"^1.0.21\",\n    \"ora\": \"^5.4.1\",\n    \"parcel-bundler\": \"^1.12.5\",\n    \"rimraf\": \"^3.0.2\",\n    \"scripty\": \"^2.0.0\",\n    \"shelljs\": \"^0.8.4\",\n    \"typedoc\": \"^0.20.36\",\n    \"typescript\": \"4.2\",\n    \"yargs\": \"^17.0.1\"\n  },\n  \"dependencies\": {\n    \"fflate\": \"^0.7.0\",\n    \"performance\": \"^1.4.0\",\n    \"src\": \"^1.1.2\",\n    \"types\": \"^0.1.1\"\n  },\n  \"husky\": {\n    \"husky\": {\n      \"pre-commit\": \"npm run precommit\"\n    }\n  }\n}\n;","import { WN } from \"../constants\"\nimport type { EffectiveType, NavigatorOpt } from \"../types/types\"\nimport { pushTask } from \"../utils/helper\"\n\nexport let effectiveType: EffectiveType = \"4g\"\nexport let saveData: boolean = false\n\n/**\n   * Get user's browser information, internet speed and other information\n   * Calculating network speed formula\n   * T1 = DNS + New Connection(TCP) + RTT(One-time transmission)\n   * T2 = New Connection(TCP) + RTT(One-time transmission)\n   * T3 = RTT(One-time transmission)\n   * bandwidth = (100k-50k)/(t5-t4)\n   * @return {NavigatorOpt}\n   */\nexport const recordClientNavigator = async (): Promise<NavigatorOpt> => {\n  return new Promise(resolve => {\n    let res = {} as NavigatorOpt\n    if (\"connection\" in WN) {\n      res.connection = {\n        downlink: WN.connection.downlink,\n        effectiveType: WN.connection.effectiveType,\n        rtt: WN.connection.rtt,\n        saveData: WN.connection.saveData,\n      }\n      saveData = res.connection.saveData || saveData\n      effectiveType = res.connection.effectiveType || effectiveType\n    }\n    // Doppler Velocity\n    if (\"fetch\" in window) {\n      pushTask(async () => {\n        let times = []\n        const sizes = [0, 0, 0, 50, 100]\n\n        times.push(+ new Date())\n\n        for (let size of sizes) {\n          await fetch(`http://performance-monitoring.zhourengui.top/performance-monitoring/doppler-velocity?size=${size}`)\n          times.push(+ new Date())\n        }\n\n        res.connection.bandwidth = `${((sizes[4] - sizes[3]) / ((times[5] - times[4]) / 1000)).toFixed(2)} k/s`\n        resolve(res)\n      })\n    }\n\n    res.userAgent = WN.userAgent\n  })\n}","import { WP } from \"../constants\"\nimport { isPerformanceSupported } from \"../utils/helper\"\nimport type { TimingOpt } from \"../types/types\"\n/**\n  * Navigation Timing API provides performance metrics for HTML documents.\n  * w3c.github.io/navigation-timing/\n  * developers.google.com/web/fundamentals/performance/navigation-and-resource-timing\n  */\nexport const recordTiming = async (): Promise<TimingOpt> => {\n  let res = {} as TimingOpt\n  if (isPerformanceSupported()) {\n    // There is an open issue to type correctly getEntriesByType\n    // github.com/microsoft/TypeScript/issues/33866\n    const n = WP.getEntriesByType(\"navigation\")[0] as any\n    if (n) {\n      const responseEnd = n.responseEnd\n      const responseStart = n.responseStart\n      const requestStart = n.requestStart\n      res = {\n        // fetchStart marks when the browser starts to fetch a resource\n        // responseEnd is when the last byte of the response arrives\n        fetchTime: responseEnd - n.fetchStart,\n        // Service worker time plus response time\n        workerTime: responseEnd - n.workerStart,\n        // Request plus response time (network only)\n        networkTime: responseEnd - requestStart,\n        // Response time only (download)\n        downloadTime: responseEnd - responseStart,\n        // Time to First Byte (TTFB)\n        timeToFirstByte: responseStart - requestStart,\n        // HTTP header size\n        headerSize: n.decodedBodySize - n.transferSize || 0,\n        // DNS Lookup Time\n        dnsLookupTime: n.domainLookupStart - n.domainLookupEnd,\n        // TCP time\n        tcpTime: n.connectStart - n.connectEnd || 0,\n        // First paint\n        firstPaintTime: responseEnd - responseStart || 0,\n        // Dom Parse Time\n        domParseTime: n.domComplete - n.domInteractive,\n        // Dom Render Time\n        domRenderTime: n.domContentLoadedEventEnd - n.domContentLoadedEventStart || 0,\n        // onload time\n        onloadTime: n.loadEventEnd - n.loadEventStart\n      }\n    }\n  }\n\n  return res\n}","import { WN } from \"../constants\"\nimport { effectiveType, saveData } from \"../performance/record-client-navigator\"\nimport { EffectiveType, NavigatorInformation } from \"../types/types\"\n\nexport const isLowEndDevice = (): boolean => {\n  return WN.deviceMemory <= 4 || WN.hardwareConcurrency <= 4\n}\n\nexport const isLowEndExperience = (\n  effectiveType: EffectiveType,\n  saveData: boolean\n): boolean => {\n  if ([\"slow-2g\", \"2g\", \"3g\"].includes(effectiveType)) {\n    return true\n  }\n\n  return isLowEndDevice() || saveData\n}\n\n/**\n * 信息来源于 window.navigator:\n * 1. Device Memory 设备内存\n * 2. Hardware Concurency 并发数\n * 3. Status of the service worker:\n *     - controlled: a service worker is controlling the page\n *     - supported: the browser supports service worker\n *     - unsupported: the user's browser does not support service worker\n */\nexport const getNavigatorInformation = (): NavigatorInformation | undefined => {\n  if (WN) {\n    return {\n      deviceMemory: WN.deviceMemory || 0,\n      hardwareConcurrency: WN.hardwareConcurrency || 0,\n      serviceWorkerStatus:\n        'serviceWorker' in WN\n          ? WN.serviceWorker?.controller\n            ? \"controlled\"\n            : \"supported\"\n          : \"unsupported\",\n      isLowEndDevice: isLowEndDevice(),\n      isLowEndExperience: isLowEndExperience(effectiveType, saveData)\n    }\n  }\n}","import { NavigatorOpt, TimingOpt, VitalsScore } from \"../types/types\";\n\n/**\n * https://web.dev/vitals/\n * https://web.dev/cls/\n */\nconst fcpScore = [1000, 2500];\nconst lcpScore = [2500, 4000];\nconst fidcore = [100, 300];\nconst clsScore = [0.1, 0.25];\nconst tbtScore = [300, 600];\n\nexport const webVitalsScore: Record<string, number[]> = {\n  fp: fcpScore,\n  fcp: fcpScore,\n  lcp: lcpScore,\n  lcpFinal: lcpScore,\n  fid: fidcore,\n  fidVitals: fidcore,\n  cls: clsScore,\n  clsFinal: clsScore,\n  tbt: tbtScore,\n  tbt5S: tbtScore,\n  tbt10S: tbtScore,\n  tbtFinal: tbtScore,\n};\n\nexport const getVitalsScore = (\n  measureName: string,\n  value: number\n): VitalsScore => {\n  if (!webVitalsScore[measureName]) {\n    return null\n  }\n\n  if (value <= webVitalsScore[measureName][0]) {\n    return \"good\"\n  }\n\n  return value <= webVitalsScore[measureName][1] ? \"needsImprovement\" : \"poor\"\n}","import { config } from \"../config/config\"\nimport { D } from \"../constants\"\nimport { NavigatorOpt, TimingOpt } from \"../types/types\"\nimport { pushTask } from \"./helper\"\nimport { getNavigatorInformation } from \"./navigator-information\"\nimport { getVitalsScore } from \"./vitals-score\"\n\n/**\n * Sends the User timing measure to analyticsTracker\n * Do not report specific data when the page is hidden\n * @param {string} measureName\n * @param {number} duration\n * @param {object} eventProperties\n */\nexport const reportPerformance = (\n  data: TimingOpt | number | NavigatorOpt | any,\n  measureName: string,\n  eventProperties?: object\n): void => {\n  pushTask(() => {\n    if (D.visibilityState === \"hidden\" && !measureName.includes(\"Final\") || !config.analyticsTracker) return\n    config.analyticsTracker({\n      metricName: measureName,\n      data,\n      eventProperties,\n      navigatorInformation: getNavigatorInformation(),\n      vitalsScore: getVitalsScore(measureName, data as number)\n    })\n  })\n}","import { config } from \"../config/config\"\nimport { roundByTwo } from \"./helper\"\nimport { reportPerformance } from \"./report-performance\"\n\n/**\n * Sends the metric to an external tracking service\n * 将指标发送到外部跟踪服务\n * @param {string} measureName \n * @param {{[key: string]: any}} metric \n * @param {object} customProperties \n */\nexport const logData = (\n  measureName: string,\n  metric: { [key: string]: any },\n  customProperties?: object\n): void => {\n  Object.keys(metric).forEach((key) => {\n    if (typeof metric[key] === 'number') {\n      metric[key] = roundByTwo(metric[key]);\n    }\n  });\n  reportPerformance(metric, measureName, customProperties);\n};\n\n/**\n * Dispatches the metric duration into internal logs\n * and the external time tracking service.\n * @param {string} measureName\n * @param {number} duration\n * @param {object} customProperties\n */\nexport const logMetric = (\n  measureName: string,\n  duration: number,\n  customProperties?: object\n) => {\n  const duration2decimal = roundByTwo(duration)\n  if (duration2decimal <= (config.maxTime as number)) {\n    reportPerformance(duration, measureName, customProperties)\n  }\n}","import { ResourceTime } from \"../types/types\";\n\n// first-pait\nexport const fp = {\n  value: 0\n}\n\n// first-contentful-paint\nexport const fcp = {\n  value: 0\n}\n\n// block-time\nexport const tbt = {\n  value: 0\n}\n\n// largest-contentful-paint\nexport const lcp = {\n  value: 0\n}\n\n// resource-time\nexport const rt: { value: ResourceTime } = {\n  value: {\n    beacon: 0,\n    css: 0,\n    fetch: 0,\n    img: 0,\n    other: 0,\n    script: 0,\n    total: 0,\n    xmlhttprequest: 0,\n  },\n};\n\n// cumulative-layout-shift\nexport const cls = {\n  value: 0\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logMetric } from \"../utils/log\"\nimport { fcp, fp, lcp } from \"../utils/metrics\"\nimport { disconnectPO } from \"./performance-observer\"\n\n/**\n * FirstPaintObserverCallback\n * @returns \n */\nexport const initFirstPaint = (\n  callback: () => void\n) => (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n    if (entry.name === \"first-paint\") {\n      fp.value = entry.startTime\n      logMetric(\"fp\", entry.startTime)\n    } else if (entry.name === \"first-contentful-paint\") {\n      fcp.value = entry.startTime\n      logMetric(\"fcp\", entry.startTime)\n      callback()\n      disconnectPO(\"paint\")\n    }\n  }\n}\n\n/**\n * LargestContentfulPaintObserverCallback\n * @param {Array<PerformanceEntryEncapsulation>} entries \n */\nexport const initLargestContentfulPaint = (entries: Array<PerformanceEntryEncapsulation>) => {\n  const lastEntry = entries.pop()\n  if (lastEntry) {\n    lcp.value = lastEntry.renderTime || lastEntry.startTime\n  }\n}\n\n/**\n * ElementTimingObserverCallback\n * @param {Array<PerformanceEntryEncapsulation>} entries\n */\nexport const initElementTiming = (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n    if (entry.identifier) {\n      logMetric(entry.identifier, entry.startTime, {\n        performanceEntry: entry\n      })\n    }\n  }\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logMetric } from \"../utils/log\"\nimport { tbt, fcp } from \"../utils/metrics\"\n\n/**\n * LongtaskObserverCallback\n * https://developer.mozilla.org/zh-CN/docs/Web/API/Long_Tasks_API\n * The definition of a long task is a task longer than 50ms\n * 长任务的定义是超过50ms的任务\n * @param {Array<PerformanceEntryEncapsulation>} entries\n * @returns \n */\nexport const initLongtask = (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n    const blockingTime = entry.startTime - 50\n    if (entry.name !== \"self\" && entry.startTime < fcp.value) return\n    if (blockingTime > 0) {\n      tbt.value += entry.startTime\n      logMetric(\"longtask\", entry.startTime)\n    }\n  }\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logData, logMetric } from \"../utils/log\"\nimport { tbt, cls, lcp, rt } from \"../utils/metrics\"\nimport { disconnectPO, performanceObserverInstance } from \"./performance-observer\"\n\n/**\n * FirstInputObserverCallback\n * Take the last entry\n * @param {Array<PerformanceEntryEncapsulation>} entries\n */\nexport const initFirstInput = (entries: Array<PerformanceEntryEncapsulation>) => {\n  const lastEntry = entries.pop()\n  if (lastEntry) {\n    // Core Web Vitals FID logic\n    // Delayed operation of measurement input events\n    // 测量输入事件的延迟操作\n    logMetric(\n      \"fidVitals\",\n      lastEntry.processingStart - lastEntry.startTime,\n      {\n        performanceEntry: lastEntry\n      }\n    )\n\n    // Measure the duration of processing the first input event\n    // 测量处理第一个输入事件的持续时间\n    logMetric(\n      \"fid\",\n      lastEntry.duration,\n      {\n        performanceEntry: lastEntry\n      }\n    )\n  }\n\n  // Destroy the registered callback for FID to avoid memory leaks caused by too many observers\n  // 销毁对FID的注册回调 避免过多的观察者造成内存泄露\n  disconnectPO(\"first-input\")\n\n  // lcp log\n  logMetric(\"lcp\", lcp.value)\n\n  // Force any pending records to be dispatched\n  // 强制分派所有待处理的记录\n  if (\n    performanceObserverInstance[\"layout-shift\"] &&\n    typeof performanceObserverInstance[\"layout-shift\"].takeRecords === \"function\"\n  ) {\n    performanceObserverInstance[\"layout-shift\"].takeRecords()\n  }\n\n  // cls log\n  logMetric(\"cls\", cls.value)\n\n  // bt log\n  logMetric(\"bt\", tbt.value)\n\n  // TBT with 5 second delay after FID\n  setTimeout(() => {\n    logMetric(\"bt5S\", tbt.value)\n  }, 5000)\n\n  // TBT with 10 second delay after FID\n  // 10S overall data consumption after FID is activated\n  setTimeout(() => {\n    logMetric(\"bt10S\", tbt.value)\n    logData(\"dataConsumption\", rt.value)\n  }, 10000)\n}","import { PerformanceEntryEncapsulation } from \"../types/types\"\nimport { logData } from \"../utils/log\"\nimport { rt } from \"../utils/metrics\"\n\n/**\n * ResouceTimingObserverCallback\n * @param {Array<PerformanceEntryEncapsulation>} entries\n * @returns \n */\nexport const initResouceTiming = (entries: Array<PerformanceEntryEncapsulation>) => {\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i]\n\n    logData(\"resourceTiming\", entry)\n\n    if (entry.decodedBodySize && entry.initiatorType) {\n      const bodySize = entry.decodedBodySize / 1000\n      rt.value[entry.initiatorType] += bodySize\n      rt.value.total += bodySize\n    }\n  }\n}","import { PerformanceEntryEncapsulation } from \"../types/types\";\nimport { cls } from \"../utils/metrics\";\n\n/**\n * https://web.dev/cls/\n * https://requestmetrics.com/web-performance/cumulative-layout-shift\n * \n * Cumulative Layout Shift (CLS), \n * sometimes known as jank, \n * is a measurement of how much elements move due to late-rendered content.\n * You can think of it as a measurement of layout instability. \n * It has become a common problem for many websites due to third-party scripts and tag management and its one of the new Core Web Vital metrics.\n * \n * LayoutShiftObserverCallback\n * Detects new layout shift occurrences and updates the\n * Only count layout shifts without recent user input.\n * 检测新的布局偏移情况并更新\n * 仅在没有最近用户输入的情况下计算布局转移。\n * \n * What is a good CLS score?\n * To provide a good user experience, sites should strive to have a CLS score of 0.1 or less. To ensure you're hitting this target for most of your users, a good threshold to measure is the 75th percentile of page loads, segmented across mobile and desktop devices.\n * 为了提供良好的用户体验，网站应努力使CLS得分不超过0.1。为确保您达到大多数用户的这一目标，衡量移动设备和台式机设备的页面加载量的第75个百分位数是一个很好的衡量标准。\n * @param {Array<PerformanceEntryEncapsulation>} entries\n * @returns\n */\nexport const initLayoutShift = (entries: Array<PerformanceEntryEncapsulation>) => {\n  const lastEntry = entries.pop()\n  if (lastEntry && !lastEntry.hadRecentInput && lastEntry.value) {\n    cls.value += lastEntry.value\n  }\n}","import { PerformanceEntryEncapsulation, PerformanceObserverEventType, PerformanceObservers } from \"../types/types\"\nimport { name } from \"../../package.json\"\nimport { C } from \"../constants\"\nimport { initElementTiming, initFirstPaint, initLargestContentfulPaint } from \"./paint\"\nimport { initLongtask } from \"./longtask\"\nimport { initFirstInput } from \"./first-input\"\nimport { config } from \"../config/config\"\nimport { initResouceTiming } from \"./resource\"\nimport { initLayoutShift } from \"./layout-shift\"\nimport { logMetric } from \"../utils/log\"\nimport { tbt, cls, lcp } from \"../utils/metrics\"\n\nexport const performanceObserverInstance: PerformanceObservers = {}\n\n/**\n * PerformanceObserver asynchronous subscription\n * PerformanceObserver异步订阅\n * @param {PerformanceObserverEventType} eventType 监听的事件类型 Types of events monitored\n * @param {(entries: Array<PerformanceEntryEncapsulation>) => void} callback 监听的回调 Listened callback\n */\nconst asyncSubscripePO = (\n  eventType: PerformanceObserverEventType,\n  callback: (entries: Array<PerformanceEntryEncapsulation>) => void\n): PerformanceObserver | null => {\n  try {\n    const Observer = new PerformanceObserver(\n      (entries) =>\n        callback(\n          entries.getEntries() as Array<PerformanceEntryEncapsulation>\n        )\n    )\n    Observer.observe({ type: eventType, buffered: true })\n    return Observer\n  } catch (error) {\n    C.warn(\"PerformanceMonitoring obsever🌲:\", `${name}: ${error}`);\n  }\n  return null\n}\n\n/**\n * Cancel the monitoring of PerformanceObserver\n * 取消PerformanceObserver的监听\n * @param {string} eventType 监听的事件类型 Types of events monitored\n */\nexport const disconnectPO = (eventType: string) => {\n  if (performanceObserverInstance[eventType]) {\n    performanceObserverInstance[eventType]?.disconnect()\n  }\n  delete performanceObserverInstance[eventType]\n}\n\n/**\n * PerformanceObserver initialization\n * PerformanceObserver初始化\n * paint: fp、fcp、largest-contentful-paint\n * longtask\n * first-input\n */\nexport const initPerformanceObserver = (): void => {\n  performanceObserverInstance[\"paint\"] = asyncSubscripePO(\n    \"paint\",\n    initFirstPaint(\n      () => performanceObserverInstance[\"longtask\"] = asyncSubscripePO(\"longtask\", initLongtask)\n    )\n  )\n\n  performanceObserverInstance[\"first-input\"] = asyncSubscripePO(\n    \"first-input\",\n    initFirstInput\n  )\n\n  performanceObserverInstance[\"largest-contentful-paint\"] = asyncSubscripePO(\n    \"largest-contentful-paint\",\n    initLargestContentfulPaint\n  )\n\n  // Collect page performance data\n  // 收集页面性能数据\n  if (config.isObserverResourceTiming) {\n    asyncSubscripePO(\"resource\", initResouceTiming)\n  }\n\n  performanceObserverInstance[\"layout-shift\"] = asyncSubscripePO(\n    \"layout-shift\",\n    initLayoutShift\n  )\n\n  if (config.isObserverElementTiming) {\n    asyncSubscripePO(\"element\", initElementTiming)\n  }\n}\n\n\nexport const disconnectPerformanceObserver = (): void => {\n  if (performanceObserverInstance[\"largest-contentful-paint\"]) {\n    logMetric(\"lcpFinal\", lcp.value)\n    disconnectPO(\"largest-contentful-paint\")\n  }\n\n  if (performanceObserverInstance[\"layout-shift\"]) {\n    // Force any pending records to be dispatched\n    // 强制分派所有待处理的记录\n    if (typeof performanceObserverInstance[\"layout-shift\"].takeRecords === \"function\") {\n      performanceObserverInstance[\"layout-shift\"].takeRecords()\n    }\n    logMetric(\"clsFinal\", cls.value)\n    disconnectPO(\"layout-shift\")\n  }\n\n  if (performanceObserverInstance[\"longtask\"]) {\n    logMetric(\"btFinal\", tbt.value)\n    disconnectPO(\"longtask\")\n  }\n}","import ErrorTrace from \"./error-trace\"\nimport ReportData from \"./utils/ReportData\"\nimport { recordingStorage } from \"./performance/record-storage\"\nimport { version } from \"../package.json\"\nimport { config } from \"./config/config\"\nimport { recordClientNavigator } from \"./performance/record-client-navigator\"\nimport { recordTiming } from \"./performance/record-timing\"\nimport { isPerformanceSupported } from \"./utils/helper\"\nimport { AskLevel, PerformanceMonitoringOptions } from \"./types/types\"\nimport { disconnectPerformanceObserver, initPerformanceObserver } from \"./performance/performance-observer\"\nimport { D } from \"./constants\"\nimport { log } from \"./utils/console\"\n\n/**\n * A performance monitoring platform SDK\n * Features include error capture, error recording, performance monitoring\n * 功能包括错误捕获、错误录制、性能监控\n * 一款性能监控平台SDK\n * @packageDocumentation\n */\nexport default class PerformanceMonitoring {\n  constructor(options: PerformanceMonitoringOptions) {\n    const {\n      isObserverElementTiming,\n      isObserverResourceTiming,\n      maxTime,\n      captureError,\n      fetchDomain,\n      errLogRoute,\n      errEventRoute,\n      logRoute,\n      analyticsTracker,\n      recordOptions,\n    } = options || {}\n\n    config.isObserverElementTiming = !!isObserverElementTiming\n    config.isObserverResourceTiming = !!isObserverResourceTiming\n    config.maxTime = maxTime || config.maxTime\n    config.captureError = captureError || config.captureError\n    config.fetchDomain = fetchDomain\n    config.errLogRoute = errLogRoute\n    config.errEventRoute = errEventRoute\n    config.logRoute = logRoute\n    config.reportData = new ReportData()\n    config.analyticsTracker = analyticsTracker || config.analyticsTracker\n    config.recordOptions = recordOptions || config.recordOptions\n\n    log(version)\n\n    if (captureError && fetchDomain) {\n      ErrorTrace.getInstance()\n    }\n\n    if (isPerformanceSupported()) {\n\n      if (D.visibilityState === \"hidden\") {\n        D.addEventListener(\n          \"visibilitychange\",\n          disconnectPerformanceObserver\n        )\n      }\n\n      if (fetchDomain && logRoute) {\n        Promise.all([\n          recordTiming(),\n          recordClientNavigator(),\n          recordingStorage()\n        ]).then(res => {\n          config.reportData?.fetch(\n            AskLevel.IDLE,\n            JSON.stringify(res),\n            logRoute\n          )\n        })\n      }\n\n      initPerformanceObserver()\n    }\n  }\n}","import PerformanceMonitoring from \"../src/index\"\n\nnew PerformanceMonitoring({\n  captureError: true,\n  fetchDomain: \"http://performance-monitoring.zhourengui.top/performance-monitoring\",\n  errEventRoute: \"/err-events\",\n  errLogRoute: \"/err-traceback\",\n  logRoute: \"/performance-log\",\n  isObserverResourceTiming: true,\n  isObserverElementTiming: true\n})","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}